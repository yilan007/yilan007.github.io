var duckdb=(()=>{var Nh=Object.create;var ti=Object.defineProperty,kh=Object.defineProperties,Lh=Object.getOwnPropertyDescriptor,Ch=Object.getOwnPropertyDescriptors,Ph=Object.getOwnPropertyNames,Ic=Object.getOwnPropertySymbols,Vh=Object.getPrototypeOf,Fc=Object.prototype.hasOwnProperty,Hh=Object.prototype.propertyIsEnumerable;var Bc=(r,t,e)=>t in r?ti(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,xr=(r,t)=>{for(var e in t||(t={}))Fc.call(t,e)&&Bc(r,e,t[e]);if(Ic)for(var e of Ic(t))Hh.call(t,e)&&Bc(r,e,t[e]);return r},ei=(r,t)=>kh(r,Ch(t)),Ac=r=>ti(r,"__esModule",{value:!0});var zh=(r=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(r,{get:(t,e)=>(typeof require!="undefined"?require:t)[e]}):r)(function(r){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+r+'" is not supported')});var Xi=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports),nn=(r,t)=>{for(var e in t)ti(r,e,{get:t[e],enumerable:!0})},xc=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Ph(t))!Fc.call(r,i)&&(e||i!=="default")&&ti(r,i,{get:()=>t[i],enumerable:!(n=Lh(t,i))||n.enumerable});return r},Tc=(r,t)=>xc(Ac(ti(r!=null?Nh(Vh(r)):{},"default",!t&&r&&r.__esModule?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r),jh=(r=>(t,e)=>r&&r.get(t)||(e=xc(Ac({}),t,1),r&&r.set(t,e),e))(typeof WeakMap!="undefined"?new WeakMap:0);var Kc=Xi((Ly,Ji)=>{var Dc,Ec,Oc,Mc,Rc,Uc,Nc,kc,Lc,Gi,Ao,Cc,Pc,Vc,bn,Hc,zc,jc,Wc,Yc,$c,Xc,Gc,Ki;(function(r){var t=typeof global=="object"?global:typeof self=="object"?self:typeof this=="object"?this:{};typeof define=="function"&&define.amd?define("tslib",["exports"],function(n){r(e(t,e(n)))}):typeof Ji=="object"&&typeof Ji.exports=="object"?r(e(t,e(Ji.exports))):r(e(t));function e(n,i){return n!==t&&(typeof Object.create=="function"?Object.defineProperty(n,"__esModule",{value:!0}):n.__esModule=!0),function(s,o){return n[s]=i?i(s,o):o}}})(function(r){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])};Dc=function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function s(){this.constructor=n}n.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)},Ec=Object.assign||function(n){for(var i,s=1,o=arguments.length;s<o;s++){i=arguments[s];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])}return n},Oc=function(n,i){var s={};for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&i.indexOf(o)<0&&(s[o]=n[o]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,o=Object.getOwnPropertySymbols(n);a<o.length;a++)i.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(n,o[a])&&(s[o[a]]=n[o[a]]);return s},Mc=function(n,i,s,o){var a=arguments.length,c=a<3?i:o===null?o=Object.getOwnPropertyDescriptor(i,s):o,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(n,i,s,o);else for(var p=n.length-1;p>=0;p--)(d=n[p])&&(c=(a<3?d(c):a>3?d(i,s,c):d(i,s))||c);return a>3&&c&&Object.defineProperty(i,s,c),c},Rc=function(n,i){return function(s,o){i(s,o,n)}},Uc=function(n,i){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,i)},Nc=function(n,i,s,o){function a(c){return c instanceof s?c:new s(function(d){d(c)})}return new(s||(s=Promise))(function(c,d){function p(w){try{g(o.next(w))}catch(q){d(q)}}function _(w){try{g(o.throw(w))}catch(q){d(q)}}function g(w){w.done?c(w.value):a(w.value).then(p,_)}g((o=o.apply(n,i||[])).next())})},kc=function(n,i){var s={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},o,a,c,d;return d={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function p(g){return function(w){return _([g,w])}}function _(g){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,a&&(c=g[0]&2?a.return:g[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,g[1])).done)return c;switch(a=0,c&&(g=[g[0]&2,c.value]),g[0]){case 0:case 1:c=g;break;case 4:return s.label++,{value:g[1],done:!1};case 5:s.label++,a=g[1],g=[0];continue;case 7:g=s.ops.pop(),s.trys.pop();continue;default:if(c=s.trys,!(c=c.length>0&&c[c.length-1])&&(g[0]===6||g[0]===2)){s=0;continue}if(g[0]===3&&(!c||g[1]>c[0]&&g[1]<c[3])){s.label=g[1];break}if(g[0]===6&&s.label<c[1]){s.label=c[1],c=g;break}if(c&&s.label<c[2]){s.label=c[2],s.ops.push(g);break}c[2]&&s.ops.pop(),s.trys.pop();continue}g=i.call(n,s)}catch(w){g=[6,w],a=0}finally{o=c=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}},Lc=function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&Ki(i,n,s)},Ki=Object.create?function(n,i,s,o){o===void 0&&(o=s),Object.defineProperty(n,o,{enumerable:!0,get:function(){return i[s]}})}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]},Gi=function(n){var i=typeof Symbol=="function"&&Symbol.iterator,s=i&&n[i],o=0;if(s)return s.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&o>=n.length&&(n=void 0),{value:n&&n[o++],done:!n}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")},Ao=function(n,i){var s=typeof Symbol=="function"&&n[Symbol.iterator];if(!s)return n;var o=s.call(n),a,c=[],d;try{for(;(i===void 0||i-- >0)&&!(a=o.next()).done;)c.push(a.value)}catch(p){d={error:p}}finally{try{a&&!a.done&&(s=o.return)&&s.call(o)}finally{if(d)throw d.error}}return c},Cc=function(){for(var n=[],i=0;i<arguments.length;i++)n=n.concat(Ao(arguments[i]));return n},Pc=function(){for(var n=0,i=0,s=arguments.length;i<s;i++)n+=arguments[i].length;for(var o=Array(n),a=0,i=0;i<s;i++)for(var c=arguments[i],d=0,p=c.length;d<p;d++,a++)o[a]=c[d];return o},Vc=function(n,i,s){if(s||arguments.length===2)for(var o=0,a=i.length,c;o<a;o++)(c||!(o in i))&&(c||(c=Array.prototype.slice.call(i,0,o)),c[o]=i[o]);return n.concat(c||Array.prototype.slice.call(i))},bn=function(n){return this instanceof bn?(this.v=n,this):new bn(n)},Hc=function(n,i,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o=s.apply(n,i||[]),a,c=[];return a={},d("next"),d("throw"),d("return"),a[Symbol.asyncIterator]=function(){return this},a;function d(G){o[G]&&(a[G]=function(yt){return new Promise(function(lt,Zt){c.push([G,yt,lt,Zt])>1||p(G,yt)})})}function p(G,yt){try{_(o[G](yt))}catch(lt){q(c[0][3],lt)}}function _(G){G.value instanceof bn?Promise.resolve(G.value.v).then(g,w):q(c[0][2],G)}function g(G){p("next",G)}function w(G){p("throw",G)}function q(G,yt){G(yt),c.shift(),c.length&&p(c[0][0],c[0][1])}},zc=function(n){var i,s;return i={},o("next"),o("throw",function(a){throw a}),o("return"),i[Symbol.iterator]=function(){return this},i;function o(a,c){i[a]=n[a]?function(d){return(s=!s)?{value:bn(n[a](d)),done:a==="return"}:c?c(d):d}:c}},jc=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n[Symbol.asyncIterator],s;return i?i.call(n):(n=typeof Gi=="function"?Gi(n):n[Symbol.iterator](),s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s);function o(c){s[c]=n[c]&&function(d){return new Promise(function(p,_){d=n[c](d),a(p,_,d.done,d.value)})}}function a(c,d,p,_){Promise.resolve(_).then(function(g){c({value:g,done:p})},d)}},Wc=function(n,i){return Object.defineProperty?Object.defineProperty(n,"raw",{value:i}):n.raw=i,n};var e=Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i};Yc=function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var s in n)s!=="default"&&Object.prototype.hasOwnProperty.call(n,s)&&Ki(i,n,s);return e(i,n),i},$c=function(n){return n&&n.__esModule?n:{default:n}},Xc=function(n,i,s,o){if(s==="a"&&!o)throw new TypeError("Private accessor was defined without a getter");if(typeof i=="function"?n!==i||!o:!i.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return s==="m"?o:s==="a"?o.call(n):o?o.value:i.get(n)},Gc=function(n,i,s,o,a){if(o==="m")throw new TypeError("Private method is not writable");if(o==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof i=="function"?n!==i||!a:!i.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return o==="a"?a.call(n,s):a?a.value=s:i.set(n,s),s},r("__extends",Dc),r("__assign",Ec),r("__rest",Oc),r("__decorate",Mc),r("__param",Rc),r("__metadata",Uc),r("__awaiter",Nc),r("__generator",kc),r("__exportStar",Lc),r("__createBinding",Ki),r("__values",Gi),r("__read",Ao),r("__spread",Cc),r("__spreadArrays",Pc),r("__spreadArray",Vc),r("__await",bn),r("__asyncGenerator",Hc),r("__asyncDelegator",zc),r("__asyncValues",jc),r("__makeTemplateObject",Wc),r("__importStar",Yc),r("__importDefault",$c),r("__classPrivateFieldGet",Xc),r("__classPrivateFieldSet",Gc)})});var Xa=Xi(()=>{});var Gu=Xi(()=>{});var nd=Xi((exports,module)=>{(function(){"use strict";var ERROR="input is invalid type",WINDOW=typeof window=="object",root=WINDOW?window:{};root.JS_SHA256_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&typeof self=="object",NODE_JS=!root.JS_SHA256_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;NODE_JS?root=global:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_SHA256_NO_COMMON_JS&&typeof module=="object"&&module.exports,AMD=typeof define=="function"&&define.amd,ARRAY_BUFFER=!root.JS_SHA256_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[];(root.JS_SHA256_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(r){return Object.prototype.toString.call(r)==="[object Array]"}),ARRAY_BUFFER&&(root.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(r){return typeof r=="object"&&r.buffer&&r.buffer.constructor===ArrayBuffer});var createOutputMethod=function(r,t){return function(e){return new Sha256(t,!0).update(e)[r]()}},createMethod=function(r){var t=createOutputMethod("hex",r);NODE_JS&&(t=nodeWrap(t,r)),t.create=function(){return new Sha256(r)},t.update=function(i){return t.create().update(i)};for(var e=0;e<OUTPUT_TYPES.length;++e){var n=OUTPUT_TYPES[e];t[n]=createOutputMethod(n,r)}return t},nodeWrap=function(method,is224){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),algorithm=is224?"sha224":"sha256",nodeMethod=function(r){if(typeof r=="string")return crypto.createHash(algorithm).update(r,"utf8").digest("hex");if(r==null)throw new Error(ERROR);return r.constructor===ArrayBuffer&&(r=new Uint8Array(r)),Array.isArray(r)||ArrayBuffer.isView(r)||r.constructor===Buffer?crypto.createHash(algorithm).update(new Buffer(r)).digest("hex"):method(r)};return nodeMethod},createHmacOutputMethod=function(r,t){return function(e,n){return new HmacSha256(e,t,!0).update(n)[r]()}},createHmacMethod=function(r){var t=createHmacOutputMethod("hex",r);t.create=function(i){return new HmacSha256(i,r)},t.update=function(i,s){return t.create(i).update(s)};for(var e=0;e<OUTPUT_TYPES.length;++e){var n=OUTPUT_TYPES[e];t[n]=createHmacOutputMethod(n,r)}return t};function Sha256(r,t){t?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=r}Sha256.prototype.update=function(r){if(!this.finalized){var t,e=typeof r;if(e!=="string"){if(e==="object"){if(r===null)throw new Error(ERROR);if(ARRAY_BUFFER&&r.constructor===ArrayBuffer)r=new Uint8Array(r);else if(!Array.isArray(r)&&(!ARRAY_BUFFER||!ArrayBuffer.isView(r)))throw new Error(ERROR)}else throw new Error(ERROR);t=!0}for(var n,i=0,s,o=r.length,a=this.blocks;i<o;){if(this.hashed&&(this.hashed=!1,a[0]=this.block,a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0),t)for(s=this.start;i<o&&s<64;++i)a[s>>2]|=r[i]<<SHIFT[s++&3];else for(s=this.start;i<o&&s<64;++i)n=r.charCodeAt(i),n<128?a[s>>2]|=n<<SHIFT[s++&3]:n<2048?(a[s>>2]|=(192|n>>6)<<SHIFT[s++&3],a[s>>2]|=(128|n&63)<<SHIFT[s++&3]):n<55296||n>=57344?(a[s>>2]|=(224|n>>12)<<SHIFT[s++&3],a[s>>2]|=(128|n>>6&63)<<SHIFT[s++&3],a[s>>2]|=(128|n&63)<<SHIFT[s++&3]):(n=65536+((n&1023)<<10|r.charCodeAt(++i)&1023),a[s>>2]|=(240|n>>18)<<SHIFT[s++&3],a[s>>2]|=(128|n>>12&63)<<SHIFT[s++&3],a[s>>2]|=(128|n>>6&63)<<SHIFT[s++&3],a[s>>2]|=(128|n&63)<<SHIFT[s++&3]);this.lastByteIndex=s,this.bytes+=s-this.start,s>=64?(this.block=a[16],this.start=s-64,this.hash(),this.hashed=!0):this.start=s}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Sha256.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var r=this.blocks,t=this.lastByteIndex;r[16]=this.block,r[t>>2]|=EXTRA[t&3],this.block=r[16],t>=56&&(this.hashed||this.hash(),r[0]=this.block,r[16]=r[1]=r[2]=r[3]=r[4]=r[5]=r[6]=r[7]=r[8]=r[9]=r[10]=r[11]=r[12]=r[13]=r[14]=r[15]=0),r[14]=this.hBytes<<3|this.bytes>>>29,r[15]=this.bytes<<3,this.hash()}},Sha256.prototype.hash=function(){var r=this.h0,t=this.h1,e=this.h2,n=this.h3,i=this.h4,s=this.h5,o=this.h6,a=this.h7,c=this.blocks,d,p,_,g,w,q,G,yt,lt,Zt,We;for(d=16;d<64;++d)w=c[d-15],p=(w>>>7|w<<25)^(w>>>18|w<<14)^w>>>3,w=c[d-2],_=(w>>>17|w<<15)^(w>>>19|w<<13)^w>>>10,c[d]=c[d-16]+p+c[d-7]+_<<0;for(We=t&e,d=0;d<64;d+=4)this.first?(this.is224?(yt=300032,w=c[0]-1413257819,a=w-150054599<<0,n=w+24177077<<0):(yt=704751109,w=c[0]-210244248,a=w-1521486534<<0,n=w+143694565<<0),this.first=!1):(p=(r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10),_=(i>>>6|i<<26)^(i>>>11|i<<21)^(i>>>25|i<<7),yt=r&t,g=yt^r&e^We,G=i&s^~i&o,w=a+_+G+K[d]+c[d],q=p+g,a=n+w<<0,n=w+q<<0),p=(n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10),_=(a>>>6|a<<26)^(a>>>11|a<<21)^(a>>>25|a<<7),lt=n&r,g=lt^n&t^yt,G=a&i^~a&s,w=o+_+G+K[d+1]+c[d+1],q=p+g,o=e+w<<0,e=w+q<<0,p=(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10),_=(o>>>6|o<<26)^(o>>>11|o<<21)^(o>>>25|o<<7),Zt=e&n,g=Zt^e&r^lt,G=o&a^~o&i,w=s+_+G+K[d+2]+c[d+2],q=p+g,s=t+w<<0,t=w+q<<0,p=(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10),_=(s>>>6|s<<26)^(s>>>11|s<<21)^(s>>>25|s<<7),We=t&e,g=We^t&n^Zt,G=s&o^~s&a,w=i+_+G+K[d+3]+c[d+3],q=p+g,i=r+w<<0,r=w+q<<0;this.h0=this.h0+r<<0,this.h1=this.h1+t<<0,this.h2=this.h2+e<<0,this.h3=this.h3+n<<0,this.h4=this.h4+i<<0,this.h5=this.h5+s<<0,this.h6=this.h6+o<<0,this.h7=this.h7+a<<0},Sha256.prototype.hex=function(){this.finalize();var r=this.h0,t=this.h1,e=this.h2,n=this.h3,i=this.h4,s=this.h5,o=this.h6,a=this.h7,c=HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[r&15]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[t&15]+HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[e&15]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[n&15]+HEX_CHARS[i>>28&15]+HEX_CHARS[i>>24&15]+HEX_CHARS[i>>20&15]+HEX_CHARS[i>>16&15]+HEX_CHARS[i>>12&15]+HEX_CHARS[i>>8&15]+HEX_CHARS[i>>4&15]+HEX_CHARS[i&15]+HEX_CHARS[s>>28&15]+HEX_CHARS[s>>24&15]+HEX_CHARS[s>>20&15]+HEX_CHARS[s>>16&15]+HEX_CHARS[s>>12&15]+HEX_CHARS[s>>8&15]+HEX_CHARS[s>>4&15]+HEX_CHARS[s&15]+HEX_CHARS[o>>28&15]+HEX_CHARS[o>>24&15]+HEX_CHARS[o>>20&15]+HEX_CHARS[o>>16&15]+HEX_CHARS[o>>12&15]+HEX_CHARS[o>>8&15]+HEX_CHARS[o>>4&15]+HEX_CHARS[o&15];return this.is224||(c+=HEX_CHARS[a>>28&15]+HEX_CHARS[a>>24&15]+HEX_CHARS[a>>20&15]+HEX_CHARS[a>>16&15]+HEX_CHARS[a>>12&15]+HEX_CHARS[a>>8&15]+HEX_CHARS[a>>4&15]+HEX_CHARS[a&15]),c},Sha256.prototype.toString=Sha256.prototype.hex,Sha256.prototype.digest=function(){this.finalize();var r=this.h0,t=this.h1,e=this.h2,n=this.h3,i=this.h4,s=this.h5,o=this.h6,a=this.h7,c=[r>>24&255,r>>16&255,r>>8&255,r&255,t>>24&255,t>>16&255,t>>8&255,t&255,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24&255,n>>16&255,n>>8&255,n&255,i>>24&255,i>>16&255,i>>8&255,i&255,s>>24&255,s>>16&255,s>>8&255,s&255,o>>24&255,o>>16&255,o>>8&255,o&255];return this.is224||c.push(a>>24&255,a>>16&255,a>>8&255,a&255),c},Sha256.prototype.array=Sha256.prototype.digest,Sha256.prototype.arrayBuffer=function(){this.finalize();var r=new ArrayBuffer(this.is224?28:32),t=new DataView(r);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),t.setUint32(20,this.h5),t.setUint32(24,this.h6),this.is224||t.setUint32(28,this.h7),r};function HmacSha256(r,t,e){var n,i=typeof r;if(i==="string"){var s=[],o=r.length,a=0,c;for(n=0;n<o;++n)c=r.charCodeAt(n),c<128?s[a++]=c:c<2048?(s[a++]=192|c>>6,s[a++]=128|c&63):c<55296||c>=57344?(s[a++]=224|c>>12,s[a++]=128|c>>6&63,s[a++]=128|c&63):(c=65536+((c&1023)<<10|r.charCodeAt(++n)&1023),s[a++]=240|c>>18,s[a++]=128|c>>12&63,s[a++]=128|c>>6&63,s[a++]=128|c&63);r=s}else if(i==="object"){if(r===null)throw new Error(ERROR);if(ARRAY_BUFFER&&r.constructor===ArrayBuffer)r=new Uint8Array(r);else if(!Array.isArray(r)&&(!ARRAY_BUFFER||!ArrayBuffer.isView(r)))throw new Error(ERROR)}else throw new Error(ERROR);r.length>64&&(r=new Sha256(t,!0).update(r).array());var d=[],p=[];for(n=0;n<64;++n){var _=r[n]||0;d[n]=92^_,p[n]=54^_}Sha256.call(this,t,e),this.update(p),this.oKeyPad=d,this.inner=!0,this.sharedMemory=e}HmacSha256.prototype=new Sha256,HmacSha256.prototype.finalize=function(){if(Sha256.prototype.finalize.call(this),this.inner){this.inner=!1;var r=this.array();Sha256.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(r),Sha256.prototype.finalize.call(this)}};var exports=createMethod();exports.sha256=exports,exports.sha224=createMethod(!0),exports.sha256.hmac=createHmacMethod(),exports.sha224.hmac=createHmacMethod(!0),COMMON_JS?module.exports=exports:(root.sha256=exports.sha256,root.sha224=exports.sha224,AMD&&define(function(){return exports}))})()});var Ry={};nn(Ry,{registerWorker:()=>ad});var Jc=Tc(Kc(),1),{__extends:Cy,__assign:Py,__rest:qc,__decorate:Vy,__param:Hy,__metadata:zy,__awaiter:I,__generator:jy,__exportStar:Wy,__createBinding:Yy,__values:$y,__read:Xy,__spread:Gy,__spreadArrays:Ky,__spreadArray:Jy,__await:j,__asyncGenerator:te,__asyncDelegator:gn,__asyncValues:Se,__makeTemplateObject:qy,__importStar:Zy,__importDefault:Qy,__classPrivateFieldGet:t_,__classPrivateFieldSet:e_}=Jc.default;var Mo={};nn(Mo,{compareArrayLike:()=>Oo,joinUint8Arrays:()=>se,memcpy:()=>wn,rebaseValueOffsets:()=>oi,toArrayBufferView:()=>W,toArrayBufferViewAsyncIterator:()=>Ne,toArrayBufferViewIterator:()=>Ge,toBigInt64Array:()=>Jh,toBigUint64Array:()=>Qh,toFloat32Array:()=>tp,toFloat32ArrayAsyncIterator:()=>yp,toFloat32ArrayIterator:()=>cp,toFloat64Array:()=>ep,toFloat64ArrayAsyncIterator:()=>_p,toFloat64ArrayIterator:()=>lp,toInt16Array:()=>Kh,toInt16ArrayAsyncIterator:()=>fp,toInt16ArrayIterator:()=>ip,toInt32Array:()=>sn,toInt32ArrayAsyncIterator:()=>hp,toInt32ArrayIterator:()=>sp,toInt8Array:()=>Gh,toInt8ArrayAsyncIterator:()=>dp,toInt8ArrayIterator:()=>np,toUint16Array:()=>qh,toUint16ArrayAsyncIterator:()=>pp,toUint16ArrayIterator:()=>op,toUint32Array:()=>Zh,toUint32ArrayAsyncIterator:()=>mp,toUint32ArrayIterator:()=>ap,toUint8Array:()=>O,toUint8ArrayAsyncIterator:()=>Eo,toUint8ArrayIterator:()=>Do,toUint8ClampedArray:()=>rp,toUint8ClampedArrayAsyncIterator:()=>bp,toUint8ClampedArrayIterator:()=>up});var Wh=new TextDecoder("utf-8"),ri=r=>Wh.decode(r),Yh=new TextEncoder,Tr=r=>Yh.encode(r);var[i_,qi]=(()=>{let r=()=>{throw new Error("BigInt is not available in this environment")};function t(){throw r()}return t.asIntN=()=>{throw r()},t.asUintN=()=>{throw r()},typeof BigInt<"u"?[BigInt,!0]:[t,!1]})(),[ni,s_]=(()=>{let r=()=>{throw new Error("BigInt64Array is not available in this environment")};class t{static get BYTES_PER_ELEMENT(){return 8}static of(){throw r()}static from(){throw r()}constructor(){throw r()}}return typeof BigInt64Array<"u"?[BigInt64Array,!0]:[t,!1]})(),[ii,o_]=(()=>{let r=()=>{throw new Error("BigUint64Array is not available in this environment")};class t{static get BYTES_PER_ELEMENT(){return 8}static of(){throw r()}static from(){throw r()}constructor(){throw r()}}return typeof BigUint64Array<"u"?[BigUint64Array,!0]:[t,!1]})();var $h=r=>typeof r=="number",Zc=r=>typeof r=="boolean",Et=r=>typeof r=="function",$t=r=>r!=null&&Object(r)===r,Re=r=>$t(r)&&Et(r.then);var Ue=r=>$t(r)&&Et(r[Symbol.iterator]),Ie=r=>$t(r)&&Et(r[Symbol.asyncIterator]),Zi=r=>$t(r)&&$t(r.schema);var Qi=r=>$t(r)&&"done"in r&&"value"in r;var ts=r=>$t(r)&&Et(r.stat)&&$h(r.fd);var es=r=>$t(r)&&si(r.body),rs=r=>"_getDOMStream"in r&&"_getNodeStream"in r,Qc=r=>$t(r)&&Et(r.abort)&&Et(r.getWriter)&&!rs(r),si=r=>$t(r)&&Et(r.cancel)&&Et(r.getReader)&&!rs(r),tl=r=>$t(r)&&Et(r.end)&&Et(r.write)&&Zc(r.writable)&&!rs(r),ns=r=>$t(r)&&Et(r.read)&&Et(r.pipe)&&Zc(r.readable)&&!rs(r),el=r=>$t(r)&&Et(r.clear)&&Et(r.bytes)&&Et(r.position)&&Et(r.setPosition)&&Et(r.capacity)&&Et(r.getBufferIdentifier)&&Et(r.createLong);var To=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:ArrayBuffer;function Xh(r){let t=r[0]?[r[0]]:[],e,n,i,s;for(let o,a,c=0,d=0,p=r.length;++c<p;){if(o=t[d],a=r[c],!o||!a||o.buffer!==a.buffer||a.byteOffset<o.byteOffset){a&&(t[++d]=a);continue}if({byteOffset:e,byteLength:i}=o,{byteOffset:n,byteLength:s}=a,e+i<n||n+s<e){a&&(t[++d]=a);continue}t[d]=new Uint8Array(o.buffer,e,n-e+s)}return t}function wn(r,t,e=0,n=t.byteLength){let i=r.byteLength,s=new Uint8Array(r.buffer,r.byteOffset,i),o=new Uint8Array(t.buffer,t.byteOffset,Math.min(n,i));return s.set(o,e),r}function se(r,t){let e=Xh(r),n=e.reduce((p,_)=>p+_.byteLength,0),i,s,o,a=0,c=-1,d=Math.min(t||Number.POSITIVE_INFINITY,n);for(let p=e.length;++c<p;){if(i=e[c],s=i.subarray(0,Math.min(i.length,d-a)),d<=a+s.length){s.length<i.length?e[c]=i.subarray(s.length):s.length===i.length&&c++,o?wn(o,s,a):o=s;break}wn(o||(o=new Uint8Array(d)),s,a),a+=s.length}return[o||new Uint8Array(0),e.slice(c),n-(o?o.byteLength:0)]}function W(r,t){let e=Qi(t)?t.value:t;return e instanceof r?r===Uint8Array?new r(e.buffer,e.byteOffset,e.byteLength):e:e?(typeof e=="string"&&(e=Tr(e)),e instanceof ArrayBuffer?new r(e):e instanceof To?new r(e):el(e)?W(r,e.bytes()):ArrayBuffer.isView(e)?e.byteLength<=0?new r(0):new r(e.buffer,e.byteOffset,e.byteLength/r.BYTES_PER_ELEMENT):r.from(e)):new r(0)}var Gh=r=>W(Int8Array,r),Kh=r=>W(Int16Array,r),sn=r=>W(Int32Array,r),Jh=r=>W(ni,r),O=r=>W(Uint8Array,r),qh=r=>W(Uint16Array,r),Zh=r=>W(Uint32Array,r),Qh=r=>W(ii,r),tp=r=>W(Float32Array,r),ep=r=>W(Float64Array,r),rp=r=>W(Uint8ClampedArray,r),xo=r=>(r.next(),r);function*Ge(r,t){let e=function*(i){yield i},n=typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof To?e(t):Ue(t)?t:e(t);return yield*xo(function*(i){let s=null;do s=i.next(yield W(r,s));while(!s.done)}(n[Symbol.iterator]())),new r}var np=r=>Ge(Int8Array,r),ip=r=>Ge(Int16Array,r),sp=r=>Ge(Int32Array,r),Do=r=>Ge(Uint8Array,r),op=r=>Ge(Uint16Array,r),ap=r=>Ge(Uint32Array,r),cp=r=>Ge(Float32Array,r),lp=r=>Ge(Float64Array,r),up=r=>Ge(Uint8ClampedArray,r);function Ne(r,t){return te(this,arguments,function*(){if(Re(t))return yield j(yield j(yield*gn(Se(Ne(r,yield j(t))))));let n=function(o){return te(this,arguments,function*(){yield yield j(yield j(o))})},i=function(o){return te(this,arguments,function*(){yield j(yield*gn(Se(xo(function*(a){let c=null;do c=a.next(yield c==null?void 0:c.value);while(!c.done)}(o[Symbol.iterator]())))))})},s=typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof To?n(t):Ue(t)?i(t):Ie(t)?t:n(t);return yield j(yield*gn(Se(xo(function(o){return te(this,arguments,function*(){let a=null;do a=yield j(o.next(yield yield j(W(r,a))));while(!a.done)})}(s[Symbol.asyncIterator]()))))),yield j(new r)})}var dp=r=>Ne(Int8Array,r),fp=r=>Ne(Int16Array,r),hp=r=>Ne(Int32Array,r),Eo=r=>Ne(Uint8Array,r),pp=r=>Ne(Uint16Array,r),mp=r=>Ne(Uint32Array,r),yp=r=>Ne(Float32Array,r),_p=r=>Ne(Float64Array,r),bp=r=>Ne(Uint8ClampedArray,r);function oi(r,t,e){if(r!==0){e=e.slice(0,t+1);for(let n=-1;++n<=t;)e[n]+=r}return e}function Oo(r,t){let e=0,n=r.length;if(n!==t.length)return!1;if(n>0)do if(r[e]!==t[e])return!1;while(++e<n);return!0}var Lt={fromIterable(r){return is(gp(r))},fromAsyncIterable(r){return is(wp(r))},fromDOMStream(r){return is(vp(r))},fromNodeStream(r){return is(Sp(r))},toDOMStream(r,t){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(r,t){throw new Error('"toNodeStream" not available in this environment')}},is=r=>(r.next(),r);function*gp(r){let t,e=!1,n=[],i,s,o,a=0;function c(){return s==="peek"?se(n,o)[0]:([i,n,a]=se(n,o),i)}({cmd:s,size:o}=yield null);let d=Do(r)[Symbol.iterator]();try{do if({done:t,value:i}=Number.isNaN(o-a)?d.next():d.next(o-a),!t&&i.byteLength>0&&(n.push(i),a+=i.byteLength),t||o<=a)do({cmd:s,size:o}=yield c());while(o<a);while(!t)}catch(p){(e=!0)&&typeof d.throw=="function"&&d.throw(p)}finally{e===!1&&typeof d.return=="function"&&d.return(null)}return null}function wp(r){return te(this,arguments,function*(){let e,n=!1,i=[],s,o,a,c=0;function d(){return o==="peek"?se(i,a)[0]:([s,i,c]=se(i,a),s)}({cmd:o,size:a}=yield yield j(null));let p=Eo(r)[Symbol.asyncIterator]();try{do if({done:e,value:s}=Number.isNaN(a-c)?yield j(p.next()):yield j(p.next(a-c)),!e&&s.byteLength>0&&(i.push(s),c+=s.byteLength),e||a<=c)do({cmd:o,size:a}=yield yield j(d()));while(a<c);while(!e)}catch(_){(n=!0)&&typeof p.throw=="function"&&(yield j(p.throw(_)))}finally{n===!1&&typeof p.return=="function"&&(yield j(p.return(new Uint8Array(0))))}return yield j(null)})}function vp(r){return te(this,arguments,function*(){let e=!1,n=!1,i=[],s,o,a,c=0;function d(){return o==="peek"?se(i,a)[0]:([s,i,c]=se(i,a),s)}({cmd:o,size:a}=yield yield j(null));let p=new rl(r);try{do if({done:e,value:s}=Number.isNaN(a-c)?yield j(p.read()):yield j(p.read(a-c)),!e&&s.byteLength>0&&(i.push(O(s)),c+=s.byteLength),e||a<=c)do({cmd:o,size:a}=yield yield j(d()));while(a<c);while(!e)}catch(_){(n=!0)&&(yield j(p.cancel(_)))}finally{n===!1?yield j(p.cancel()):r.locked&&p.releaseLock()}return yield j(null)})}var rl=class{constructor(t){this.source=t,this.reader=null,this.reader=this.source.getReader(),this.reader.closed.catch(()=>{})}get closed(){return this.reader?this.reader.closed.catch(()=>{}):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=null}cancel(t){return I(this,void 0,void 0,function*(){let{reader:e,source:n}=this;e&&(yield e.cancel(t).catch(()=>{})),n&&n.locked&&this.releaseLock()})}read(t){return I(this,void 0,void 0,function*(){if(t===0)return{done:this.reader==null,value:new Uint8Array(0)};let e=yield this.reader.read();return!e.done&&(e.value=O(e)),e})}},Ro=(r,t)=>{let e=i=>n([t,i]),n;return[t,e,new Promise(i=>(n=i)&&r.once(t,e))]};function Sp(r){return te(this,arguments,function*(){let e=[],n="error",i=!1,s=null,o,a,c=0,d=[],p;function _(){return o==="peek"?se(d,a)[0]:([p,d,c]=se(d,a),p)}if({cmd:o,size:a}=yield yield j(null),r.isTTY)return yield yield j(new Uint8Array(0)),yield j(null);try{e[0]=Ro(r,"end"),e[1]=Ro(r,"error");do{if(e[2]=Ro(r,"readable"),[n,s]=yield j(Promise.race(e.map(w=>w[2]))),n==="error")break;if((i=n==="end")||(Number.isFinite(a-c)?(p=O(r.read(a-c)),p.byteLength<a-c&&(p=O(r.read()))):p=O(r.read()),p.byteLength>0&&(d.push(p),c+=p.byteLength)),i||a<=c)do({cmd:o,size:a}=yield yield j(_()));while(a<c)}while(!i)}finally{yield j(g(e,n==="error"?s:null))}return yield j(null);function g(w,q){return p=d=null,new Promise((G,yt)=>{for(let[lt,Zt]of w)r.off(lt,Zt);try{let lt=r.destroy;lt&&lt.call(r,q),q=void 0}catch(lt){q=lt||q}finally{q!=null?yt(q):G()}})}})}var kt;(function(r){r[r.V1=0]="V1",r[r.V2=1]="V2",r[r.V3=2]="V3",r[r.V4=3]="V4",r[r.V5=4]="V5"})(kt||(kt={}));var bt;(function(r){r[r.Sparse=0]="Sparse",r[r.Dense=1]="Dense"})(bt||(bt={}));var dt;(function(r){r[r.HALF=0]="HALF",r[r.SINGLE=1]="SINGLE",r[r.DOUBLE=2]="DOUBLE"})(dt||(dt={}));var Ct;(function(r){r[r.DAY=0]="DAY",r[r.MILLISECOND=1]="MILLISECOND"})(Ct||(Ct={}));var X;(function(r){r[r.SECOND=0]="SECOND",r[r.MILLISECOND=1]="MILLISECOND",r[r.MICROSECOND=2]="MICROSECOND",r[r.NANOSECOND=3]="NANOSECOND"})(X||(X={}));var Xt;(function(r){r[r.YEAR_MONTH=0]="YEAR_MONTH",r[r.DAY_TIME=1]="DAY_TIME",r[r.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"})(Xt||(Xt={}));var Z;(function(r){r[r.NONE=0]="NONE",r[r.Schema=1]="Schema",r[r.DictionaryBatch=2]="DictionaryBatch",r[r.RecordBatch=3]="RecordBatch",r[r.Tensor=4]="Tensor",r[r.SparseTensor=5]="SparseTensor"})(Z||(Z={}));var h;(function(r){r[r.NONE=0]="NONE",r[r.Null=1]="Null",r[r.Int=2]="Int",r[r.Float=3]="Float",r[r.Binary=4]="Binary",r[r.Utf8=5]="Utf8",r[r.Bool=6]="Bool",r[r.Decimal=7]="Decimal",r[r.Date=8]="Date",r[r.Time=9]="Time",r[r.Timestamp=10]="Timestamp",r[r.Interval=11]="Interval",r[r.List=12]="List",r[r.Struct=13]="Struct",r[r.Union=14]="Union",r[r.FixedSizeBinary=15]="FixedSizeBinary",r[r.FixedSizeList=16]="FixedSizeList",r[r.Map=17]="Map",r[r.Dictionary=-1]="Dictionary",r[r.Int8=-2]="Int8",r[r.Int16=-3]="Int16",r[r.Int32=-4]="Int32",r[r.Int64=-5]="Int64",r[r.Uint8=-6]="Uint8",r[r.Uint16=-7]="Uint16",r[r.Uint32=-8]="Uint32",r[r.Uint64=-9]="Uint64",r[r.Float16=-10]="Float16",r[r.Float32=-11]="Float32",r[r.Float64=-12]="Float64",r[r.DateDay=-13]="DateDay",r[r.DateMillisecond=-14]="DateMillisecond",r[r.TimestampSecond=-15]="TimestampSecond",r[r.TimestampMillisecond=-16]="TimestampMillisecond",r[r.TimestampMicrosecond=-17]="TimestampMicrosecond",r[r.TimestampNanosecond=-18]="TimestampNanosecond",r[r.TimeSecond=-19]="TimeSecond",r[r.TimeMillisecond=-20]="TimeMillisecond",r[r.TimeMicrosecond=-21]="TimeMicrosecond",r[r.TimeNanosecond=-22]="TimeNanosecond",r[r.DenseUnion=-23]="DenseUnion",r[r.SparseUnion=-24]="SparseUnion",r[r.IntervalDayTime=-25]="IntervalDayTime",r[r.IntervalYearMonth=-26]="IntervalYearMonth"})(h||(h={}));var Be;(function(r){r[r.OFFSET=0]="OFFSET",r[r.DATA=1]="DATA",r[r.VALIDITY=2]="VALIDITY",r[r.TYPE=3]="TYPE"})(Be||(Be={}));var ra={};nn(ra,{clampIndex:()=>fm,clampRange:()=>li,createElementComparator:()=>Pr});function ke(r){if(r===null)return"null";if(r===void 0)return"undefined";switch(typeof r){case"number":return`${r}`;case"bigint":return`${r}`;case"string":return`"${r}"`}return typeof r[Symbol.toPrimitive]=="function"?r[Symbol.toPrimitive]("string"):ArrayBuffer.isView(r)?r instanceof BigInt64Array||r instanceof BigUint64Array?`[${[...r].map(t=>ke(t))}]`:`[${r}]`:ArrayBuffer.isView(r)?`[${r}]`:JSON.stringify(r,(t,e)=>typeof e=="bigint"?`${e}`:e)}var No={};nn(No,{BN:()=>In,bignumToBigInt:()=>ss,bignumToString:()=>Dr,isArrowBigNumSymbol:()=>nl});var nl=Symbol.for("isArrowBigNum");function Le(r,...t){return t.length===0?Object.setPrototypeOf(W(this.TypedArray,r),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(r,...t),this.constructor.prototype)}Le.prototype[nl]=!0;Le.prototype.toJSON=function(){return`"${Dr(this)}"`};Le.prototype.valueOf=function(){return il(this)};Le.prototype.toString=function(){return Dr(this)};Le.prototype[Symbol.toPrimitive]=function(r="default"){switch(r){case"number":return il(this);case"string":return Dr(this);case"default":return ss(this)}return Dr(this)};function vn(...r){return Le.apply(this,r)}function Sn(...r){return Le.apply(this,r)}function ai(...r){return Le.apply(this,r)}Object.setPrototypeOf(vn.prototype,Object.create(Int32Array.prototype));Object.setPrototypeOf(Sn.prototype,Object.create(Uint32Array.prototype));Object.setPrototypeOf(ai.prototype,Object.create(Uint32Array.prototype));Object.assign(vn.prototype,Le.prototype,{constructor:vn,signed:!0,TypedArray:Int32Array,BigIntArray:ni});Object.assign(Sn.prototype,Le.prototype,{constructor:Sn,signed:!1,TypedArray:Uint32Array,BigIntArray:ii});Object.assign(ai.prototype,Le.prototype,{constructor:ai,signed:!0,TypedArray:Uint32Array,BigIntArray:ii});function il(r){let{buffer:t,byteOffset:e,length:n,signed:i}=r,s=new Int32Array(t,e,n),o=0,a=0,c=s.length,d,p;for(;a<c;)p=s[a++],d=s[a++],i||(d=d>>>0),o+=(p>>>0)+d*Math.pow(a,32);return o}var Dr,ss;qi?(ss=r=>r.byteLength===8?new r.BigIntArray(r.buffer,r.byteOffset,1)[0]:Uo(r),Dr=r=>r.byteLength===8?`${new r.BigIntArray(r.buffer,r.byteOffset,1)[0]}`:Uo(r)):(Dr=Uo,ss=Dr);function Uo(r){let t="",e=new Uint32Array(2),n=new Uint16Array(r.buffer,r.byteOffset,r.byteLength/2),i=new Uint32Array((n=new Uint16Array(n).reverse()).buffer),s=-1,o=n.length-1;do{for(e[0]=n[s=0];s<o;)n[s++]=e[1]=e[0]/10,e[0]=(e[0]-e[1]*10<<16)+n[s];n[s]=e[1]=e[0]/10,e[0]=e[0]-e[1]*10,t=`${e[0]}${t}`}while(i[0]||i[1]||i[2]||i[3]);return t||"0"}var In=class{static new(t,e){switch(e){case!0:return new vn(t);case!1:return new Sn(t)}switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:case ni:return new vn(t)}return t.byteLength===16?new ai(t):new Sn(t)}static signed(t){return new vn(t)}static unsigned(t){return new Sn(t)}static decimal(t){return new ai(t)}constructor(t,e){return In.new(t,e)}};var sl,ol,al,cl,ll,ul,dl,fl,hl,pl,ml,yl,_l,bl,gl,wl,vl,Sl,Il,A=class{static isNull(t){return(t==null?void 0:t.typeId)===h.Null}static isInt(t){return(t==null?void 0:t.typeId)===h.Int}static isFloat(t){return(t==null?void 0:t.typeId)===h.Float}static isBinary(t){return(t==null?void 0:t.typeId)===h.Binary}static isUtf8(t){return(t==null?void 0:t.typeId)===h.Utf8}static isBool(t){return(t==null?void 0:t.typeId)===h.Bool}static isDecimal(t){return(t==null?void 0:t.typeId)===h.Decimal}static isDate(t){return(t==null?void 0:t.typeId)===h.Date}static isTime(t){return(t==null?void 0:t.typeId)===h.Time}static isTimestamp(t){return(t==null?void 0:t.typeId)===h.Timestamp}static isInterval(t){return(t==null?void 0:t.typeId)===h.Interval}static isList(t){return(t==null?void 0:t.typeId)===h.List}static isStruct(t){return(t==null?void 0:t.typeId)===h.Struct}static isUnion(t){return(t==null?void 0:t.typeId)===h.Union}static isFixedSizeBinary(t){return(t==null?void 0:t.typeId)===h.FixedSizeBinary}static isFixedSizeList(t){return(t==null?void 0:t.typeId)===h.FixedSizeList}static isMap(t){return(t==null?void 0:t.typeId)===h.Map}static isDictionary(t){return(t==null?void 0:t.typeId)===h.Dictionary}static isDenseUnion(t){return A.isUnion(t)&&t.mode===bt.Dense}static isSparseUnion(t){return A.isUnion(t)&&t.mode===bt.Sparse}get typeId(){return h.NONE}};sl=Symbol.toStringTag;A[sl]=(r=>(r.children=null,r.ArrayType=Array,r[Symbol.toStringTag]="DataType"))(A.prototype);var ee=class extends A{toString(){return"Null"}get typeId(){return h.Null}};ol=Symbol.toStringTag;ee[ol]=(r=>r[Symbol.toStringTag]="Null")(ee.prototype);var Ft=class extends A{constructor(t,e){super();this.isSigned=t,this.bitWidth=e}get typeId(){return h.Int}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?BigInt64Array:BigUint64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}};al=Symbol.toStringTag;Ft[al]=(r=>(r.isSigned=null,r.bitWidth=null,r[Symbol.toStringTag]="Int"))(Ft.prototype);var ko=class extends Ft{constructor(){super(!0,8)}get ArrayType(){return Int8Array}},Lo=class extends Ft{constructor(){super(!0,16)}get ArrayType(){return Int16Array}},ar=class extends Ft{constructor(){super(!0,32)}get ArrayType(){return Int32Array}},Co=class extends Ft{constructor(){super(!0,64)}get ArrayType(){return BigInt64Array}},Po=class extends Ft{constructor(){super(!1,8)}get ArrayType(){return Uint8Array}},Vo=class extends Ft{constructor(){super(!1,16)}get ArrayType(){return Uint16Array}},Ho=class extends Ft{constructor(){super(!1,32)}get ArrayType(){return Uint32Array}},zo=class extends Ft{constructor(){super(!1,64)}get ArrayType(){return BigUint64Array}};Object.defineProperty(ko.prototype,"ArrayType",{value:Int8Array});Object.defineProperty(Lo.prototype,"ArrayType",{value:Int16Array});Object.defineProperty(ar.prototype,"ArrayType",{value:Int32Array});Object.defineProperty(Co.prototype,"ArrayType",{value:BigInt64Array});Object.defineProperty(Po.prototype,"ArrayType",{value:Uint8Array});Object.defineProperty(Vo.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(Ho.prototype,"ArrayType",{value:Uint32Array});Object.defineProperty(zo.prototype,"ArrayType",{value:BigUint64Array});var oe=class extends A{constructor(t){super();this.precision=t}get typeId(){return h.Float}get ArrayType(){switch(this.precision){case dt.HALF:return Uint16Array;case dt.SINGLE:return Float32Array;case dt.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}};cl=Symbol.toStringTag;oe[cl]=(r=>(r.precision=null,r[Symbol.toStringTag]="Float"))(oe.prototype);var jo=class extends oe{constructor(){super(dt.HALF)}},Wo=class extends oe{constructor(){super(dt.SINGLE)}},Yo=class extends oe{constructor(){super(dt.DOUBLE)}};Object.defineProperty(jo.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(Wo.prototype,"ArrayType",{value:Float32Array});Object.defineProperty(Yo.prototype,"ArrayType",{value:Float64Array});var Er=class extends A{constructor(){super()}get typeId(){return h.Binary}toString(){return"Binary"}};ll=Symbol.toStringTag;Er[ll]=(r=>(r.ArrayType=Uint8Array,r[Symbol.toStringTag]="Binary"))(Er.prototype);var Or=class extends A{constructor(){super()}get typeId(){return h.Utf8}toString(){return"Utf8"}};ul=Symbol.toStringTag;Or[ul]=(r=>(r.ArrayType=Uint8Array,r[Symbol.toStringTag]="Utf8"))(Or.prototype);var Mr=class extends A{constructor(){super()}get typeId(){return h.Bool}toString(){return"Bool"}};dl=Symbol.toStringTag;Mr[dl]=(r=>(r.ArrayType=Uint8Array,r[Symbol.toStringTag]="Bool"))(Mr.prototype);var Rr=class extends A{constructor(t,e,n=128){super();this.scale=t,this.precision=e,this.bitWidth=n}get typeId(){return h.Decimal}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}};fl=Symbol.toStringTag;Rr[fl]=(r=>(r.scale=null,r.precision=null,r.ArrayType=Uint32Array,r[Symbol.toStringTag]="Decimal"))(Rr.prototype);var Ur=class extends A{constructor(t){super();this.unit=t}get typeId(){return h.Date}toString(){return`Date${(this.unit+1)*32}<${Ct[this.unit]}>`}};hl=Symbol.toStringTag;Ur[hl]=(r=>(r.unit=null,r.ArrayType=Int32Array,r[Symbol.toStringTag]="Date"))(Ur.prototype);var Ke=class extends A{constructor(t,e){super();this.unit=t,this.bitWidth=e}get typeId(){return h.Time}toString(){return`Time${this.bitWidth}<${X[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return BigInt64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}};pl=Symbol.toStringTag;Ke[pl]=(r=>(r.unit=null,r.bitWidth=null,r[Symbol.toStringTag]="Time"))(Ke.prototype);var Nr=class extends A{constructor(t,e){super();this.unit=t,this.timezone=e}get typeId(){return h.Timestamp}toString(){return`Timestamp<${X[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}};ml=Symbol.toStringTag;Nr[ml]=(r=>(r.unit=null,r.timezone=null,r.ArrayType=Int32Array,r[Symbol.toStringTag]="Timestamp"))(Nr.prototype);var kr=class extends A{constructor(t){super();this.unit=t}get typeId(){return h.Interval}toString(){return`Interval<${Xt[this.unit]}>`}};yl=Symbol.toStringTag;kr[yl]=(r=>(r.unit=null,r.ArrayType=Int32Array,r[Symbol.toStringTag]="Interval"))(kr.prototype);var Je=class extends A{constructor(t){super();this.children=[t]}get typeId(){return h.List}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}};_l=Symbol.toStringTag;Je[_l]=(r=>(r.children=null,r[Symbol.toStringTag]="List"))(Je.prototype);var ft=class extends A{constructor(t){super();this.children=t}get typeId(){return h.Struct}toString(){return`Struct<{${this.children.map(t=>`${t.name}:${t.type}`).join(", ")}}>`}};bl=Symbol.toStringTag;ft[bl]=(r=>(r.children=null,r[Symbol.toStringTag]="Struct"))(ft.prototype);var qe=class extends A{constructor(t,e,n){super();this.mode=t,this.children=n,this.typeIds=e=Int32Array.from(e),this.typeIdToChildIndex=e.reduce((i,s,o)=>(i[s]=o)&&i||i,Object.create(null))}get typeId(){return h.Union}toString(){return`${this[Symbol.toStringTag]}<${this.children.map(t=>`${t.type}`).join(" | ")}>`}};gl=Symbol.toStringTag;qe[gl]=(r=>(r.mode=null,r.typeIds=null,r.children=null,r.typeIdToChildIndex=null,r.ArrayType=Int8Array,r[Symbol.toStringTag]="Union"))(qe.prototype);var Lr=class extends A{constructor(t){super();this.byteWidth=t}get typeId(){return h.FixedSizeBinary}toString(){return`FixedSizeBinary[${this.byteWidth}]`}};wl=Symbol.toStringTag;Lr[wl]=(r=>(r.byteWidth=null,r.ArrayType=Uint8Array,r[Symbol.toStringTag]="FixedSizeBinary"))(Lr.prototype);var Ze=class extends A{constructor(t,e){super();this.listSize=t,this.children=[e]}get typeId(){return h.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}};vl=Symbol.toStringTag;Ze[vl]=(r=>(r.children=null,r.listSize=null,r[Symbol.toStringTag]="FixedSizeList"))(Ze.prototype);var Qe=class extends A{constructor(t,e=!1){super();this.children=[t],this.keysSorted=e}get typeId(){return h.Map}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map(t=>`${t.name}:${t.type}`).join(", ")}}>`}};Sl=Symbol.toStringTag;Qe[Sl]=(r=>(r.children=null,r.keysSorted=null,r[Symbol.toStringTag]="Map_"))(Qe.prototype);var Ip=(r=>()=>++r)(-1),Fe=class extends A{constructor(t,e,n,i){super();this.indices=e,this.dictionary=t,this.isOrdered=i||!1,this.id=n==null?Ip():typeof n=="number"?n:n.low}get typeId(){return h.Dictionary}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}};Il=Symbol.toStringTag;Fe[Il]=(r=>(r.id=null,r.indices=null,r.isOrdered=null,r.dictionary=null,r[Symbol.toStringTag]="Dictionary"))(Fe.prototype);function ae(r){let t=r;switch(r.typeId){case h.Decimal:return r.bitWidth/32;case h.Timestamp:return 2;case h.Date:return 1+t.unit;case h.Interval:return 1+t.unit;case h.FixedSizeList:return t.listSize;case h.FixedSizeBinary:return t.byteWidth;default:return 1}}var E=class{visitMany(t,...e){return t.map((n,i)=>this.visit(n,...e.map(s=>s[i])))}visit(...t){return this.getVisitFn(t[0],!1).apply(this,t)}getVisitFn(t,e=!0){return Bp(this,t,e)}getVisitFnByTypeId(t,e=!0){return Bn(this,t,e)}visitNull(t,...e){return null}visitBool(t,...e){return null}visitInt(t,...e){return null}visitFloat(t,...e){return null}visitUtf8(t,...e){return null}visitBinary(t,...e){return null}visitFixedSizeBinary(t,...e){return null}visitDate(t,...e){return null}visitTimestamp(t,...e){return null}visitTime(t,...e){return null}visitDecimal(t,...e){return null}visitList(t,...e){return null}visitStruct(t,...e){return null}visitUnion(t,...e){return null}visitDictionary(t,...e){return null}visitInterval(t,...e){return null}visitFixedSizeList(t,...e){return null}visitMap(t,...e){return null}};function Bp(r,t,e=!0){return typeof t=="number"?Bn(r,t,e):typeof t=="string"&&t in h?Bn(r,h[t],e):t&&t instanceof A?Bn(r,Bl(t),e):(t==null?void 0:t.type)&&t.type instanceof A?Bn(r,Bl(t.type),e):Bn(r,h.NONE,e)}function Bn(r,t,e=!0){let n=null;switch(t){case h.Null:n=r.visitNull;break;case h.Bool:n=r.visitBool;break;case h.Int:n=r.visitInt;break;case h.Int8:n=r.visitInt8||r.visitInt;break;case h.Int16:n=r.visitInt16||r.visitInt;break;case h.Int32:n=r.visitInt32||r.visitInt;break;case h.Int64:n=r.visitInt64||r.visitInt;break;case h.Uint8:n=r.visitUint8||r.visitInt;break;case h.Uint16:n=r.visitUint16||r.visitInt;break;case h.Uint32:n=r.visitUint32||r.visitInt;break;case h.Uint64:n=r.visitUint64||r.visitInt;break;case h.Float:n=r.visitFloat;break;case h.Float16:n=r.visitFloat16||r.visitFloat;break;case h.Float32:n=r.visitFloat32||r.visitFloat;break;case h.Float64:n=r.visitFloat64||r.visitFloat;break;case h.Utf8:n=r.visitUtf8;break;case h.Binary:n=r.visitBinary;break;case h.FixedSizeBinary:n=r.visitFixedSizeBinary;break;case h.Date:n=r.visitDate;break;case h.DateDay:n=r.visitDateDay||r.visitDate;break;case h.DateMillisecond:n=r.visitDateMillisecond||r.visitDate;break;case h.Timestamp:n=r.visitTimestamp;break;case h.TimestampSecond:n=r.visitTimestampSecond||r.visitTimestamp;break;case h.TimestampMillisecond:n=r.visitTimestampMillisecond||r.visitTimestamp;break;case h.TimestampMicrosecond:n=r.visitTimestampMicrosecond||r.visitTimestamp;break;case h.TimestampNanosecond:n=r.visitTimestampNanosecond||r.visitTimestamp;break;case h.Time:n=r.visitTime;break;case h.TimeSecond:n=r.visitTimeSecond||r.visitTime;break;case h.TimeMillisecond:n=r.visitTimeMillisecond||r.visitTime;break;case h.TimeMicrosecond:n=r.visitTimeMicrosecond||r.visitTime;break;case h.TimeNanosecond:n=r.visitTimeNanosecond||r.visitTime;break;case h.Decimal:n=r.visitDecimal;break;case h.List:n=r.visitList;break;case h.Struct:n=r.visitStruct;break;case h.Union:n=r.visitUnion;break;case h.DenseUnion:n=r.visitDenseUnion||r.visitUnion;break;case h.SparseUnion:n=r.visitSparseUnion||r.visitUnion;break;case h.Dictionary:n=r.visitDictionary;break;case h.Interval:n=r.visitInterval;break;case h.IntervalDayTime:n=r.visitIntervalDayTime||r.visitInterval;break;case h.IntervalYearMonth:n=r.visitIntervalYearMonth||r.visitInterval;break;case h.FixedSizeList:n=r.visitFixedSizeList;break;case h.Map:n=r.visitMap;break}if(typeof n=="function")return n;if(!e)return()=>null;throw new Error(`Unrecognized type '${h[t]}'`)}function Bl(r){switch(r.typeId){case h.Null:return h.Null;case h.Int:{let{bitWidth:t,isSigned:e}=r;switch(t){case 8:return e?h.Int8:h.Uint8;case 16:return e?h.Int16:h.Uint16;case 32:return e?h.Int32:h.Uint32;case 64:return e?h.Int64:h.Uint64}return h.Int}case h.Float:switch(r.precision){case dt.HALF:return h.Float16;case dt.SINGLE:return h.Float32;case dt.DOUBLE:return h.Float64}return h.Float;case h.Binary:return h.Binary;case h.Utf8:return h.Utf8;case h.Bool:return h.Bool;case h.Decimal:return h.Decimal;case h.Time:switch(r.unit){case X.SECOND:return h.TimeSecond;case X.MILLISECOND:return h.TimeMillisecond;case X.MICROSECOND:return h.TimeMicrosecond;case X.NANOSECOND:return h.TimeNanosecond}return h.Time;case h.Timestamp:switch(r.unit){case X.SECOND:return h.TimestampSecond;case X.MILLISECOND:return h.TimestampMillisecond;case X.MICROSECOND:return h.TimestampMicrosecond;case X.NANOSECOND:return h.TimestampNanosecond}return h.Timestamp;case h.Date:switch(r.unit){case Ct.DAY:return h.DateDay;case Ct.MILLISECOND:return h.DateMillisecond}return h.Date;case h.Interval:switch(r.unit){case Xt.DAY_TIME:return h.IntervalDayTime;case Xt.YEAR_MONTH:return h.IntervalYearMonth}return h.Interval;case h.Map:return h.Map;case h.List:return h.List;case h.Struct:return h.Struct;case h.Union:switch(r.mode){case bt.Dense:return h.DenseUnion;case bt.Sparse:return h.SparseUnion}return h.Union;case h.FixedSizeBinary:return h.FixedSizeBinary;case h.FixedSizeList:return h.FixedSizeList;case h.Dictionary:return h.Dictionary}throw new Error(`Unrecognized type '${h[r.typeId]}'`)}E.prototype.visitInt8=null;E.prototype.visitInt16=null;E.prototype.visitInt32=null;E.prototype.visitInt64=null;E.prototype.visitUint8=null;E.prototype.visitUint16=null;E.prototype.visitUint32=null;E.prototype.visitUint64=null;E.prototype.visitFloat16=null;E.prototype.visitFloat32=null;E.prototype.visitFloat64=null;E.prototype.visitDateDay=null;E.prototype.visitDateMillisecond=null;E.prototype.visitTimestampSecond=null;E.prototype.visitTimestampMillisecond=null;E.prototype.visitTimestampMicrosecond=null;E.prototype.visitTimestampNanosecond=null;E.prototype.visitTimeSecond=null;E.prototype.visitTimeMillisecond=null;E.prototype.visitTimeMicrosecond=null;E.prototype.visitTimeNanosecond=null;E.prototype.visitDenseUnion=null;E.prototype.visitSparseUnion=null;E.prototype.visitIntervalDayTime=null;E.prototype.visitIntervalYearMonth=null;var $o={};nn($o,{float64ToUint16:()=>ci,uint16ToFloat64:()=>os});var Fl=new Float64Array(1),Fn=new Uint32Array(Fl.buffer);function os(r){let t=(r&31744)>>10,e=(r&1023)/1024,n=Math.pow(-1,(r&32768)>>15);switch(t){case 31:return n*(e?Number.NaN:1/0);case 0:return n*(e?6103515625e-14*e:0)}return n*Math.pow(2,t-15)*(1+e)}function ci(r){if(r!==r)return 32256;Fl[0]=r;let t=(Fn[1]&2147483648)>>16&65535,e=Fn[1]&2146435072,n=0;return e>=1089470464?Fn[0]>0?e=31744:(e=(e&2080374784)>>16,n=(Fn[1]&1048575)>>10):e<=1056964608?(n=1048576+(Fn[1]&1048575),n=1048576+(n<<(e>>20)-998)>>21,e=0):(e=e-1056964608>>10,n=(Fn[1]&1048575)+512>>10),t|e|n&65535}var k=class extends E{};function H(r){return(t,e,n)=>{if(t.setValid(e,n!=null))return r(t,e,n)}}var Fp=(r,t,e)=>{r[t]=Math.trunc(e/864e5)},Xo=(r,t,e)=>{r[t]=Math.trunc(e%4294967296),r[t+1]=Math.trunc(e/4294967296)},Ap=(r,t,e)=>{r[t]=Math.trunc(e*1e3%4294967296),r[t+1]=Math.trunc(e*1e3/4294967296)},xp=(r,t,e)=>{r[t]=Math.trunc(e*1e6%4294967296),r[t+1]=Math.trunc(e*1e6/4294967296)},Al=(r,t,e,n)=>{let{[e]:i,[e+1]:s}=t;i!=null&&s!=null&&r.set(n.subarray(0,s-i),i)},Tp=({offset:r,values:t},e,n)=>{let i=r+e;n?t[i>>3]|=1<<i%8:t[i>>3]&=~(1<<i%8)},cr=({values:r},t,e)=>{r[t]=e},Go=({values:r},t,e)=>{r[t]=e},xl=({values:r},t,e)=>{r[t]=ci(e)},Dp=(r,t,e)=>{switch(r.type.precision){case dt.HALF:return xl(r,t,e);case dt.SINGLE:case dt.DOUBLE:default:return Go(r,t,e)}},as=({values:r},t,e)=>{Fp(r,t,e.valueOf())},cs=({values:r},t,e)=>{Xo(r,t*2,e.valueOf())},Ko=({stride:r,values:t},e,n)=>{t.set(n.subarray(0,r),r*e)},Ep=({values:r,valueOffsets:t},e,n)=>Al(r,t,e,n),Op=({values:r,valueOffsets:t},e,n)=>{Al(r,t,e,Tr(n))},Jo=(r,t,e)=>{r.type.unit===Ct.DAY?as(r,t,e):cs(r,t,e)},ls=({values:r},t,e)=>Xo(r,t*2,e/1e3),us=({values:r},t,e)=>Xo(r,t*2,e),ds=({values:r},t,e)=>Ap(r,t*2,e),fs=({values:r},t,e)=>xp(r,t*2,e),qo=(r,t,e)=>{switch(r.type.unit){case X.SECOND:return ls(r,t,e);case X.MILLISECOND:return us(r,t,e);case X.MICROSECOND:return ds(r,t,e);case X.NANOSECOND:return fs(r,t,e)}},hs=({values:r},t,e)=>{r[t]=e},ps=({values:r},t,e)=>{r[t]=e},ms=({values:r},t,e)=>{r[t]=e},ys=({values:r},t,e)=>{r[t]=e},Zo=(r,t,e)=>{switch(r.type.unit){case X.SECOND:return hs(r,t,e);case X.MILLISECOND:return ps(r,t,e);case X.MICROSECOND:return ms(r,t,e);case X.NANOSECOND:return ys(r,t,e)}},Qo=({values:r,stride:t},e,n)=>{r.set(n.subarray(0,t),t*e)},Mp=(r,t,e)=>{let n=r.children[0],i=r.valueOffsets,s=Pt.getVisitFn(n);if(Array.isArray(e))for(let o=-1,a=i[t],c=i[t+1];a<c;)s(n,a++,e[++o]);else for(let o=-1,a=i[t],c=i[t+1];a<c;)s(n,a++,e.get(++o))},Rp=(r,t,e)=>{let n=r.children[0],i=r.valueOffsets,s=Pt.getVisitFn(n),{[t]:o,[t+1]:a}=i,c=e instanceof Map?e.entries():Object.entries(e);for(let d of c)if(s(n,o,d),++o>=a)break},Up=(r,t)=>(e,n,i,s)=>n&&e(n,r,t[s]),Np=(r,t)=>(e,n,i,s)=>n&&e(n,r,t.get(s)),kp=(r,t)=>(e,n,i,s)=>n&&e(n,r,t.get(i.name)),Lp=(r,t)=>(e,n,i,s)=>n&&e(n,r,t[i.name]),Cp=(r,t,e)=>{let n=r.type.children.map(s=>Pt.getVisitFn(s.type)),i=e instanceof Map?kp(t,e):e instanceof L?Np(t,e):Array.isArray(e)?Up(t,e):Lp(t,e);r.type.children.forEach((s,o)=>i(n[o],r.children[o],s,o))},Pp=(r,t,e)=>{r.type.mode===bt.Dense?Tl(r,t,e):Dl(r,t,e)},Tl=(r,t,e)=>{let n=r.type.typeIdToChildIndex[r.typeIds[t]],i=r.children[n];Pt.visit(i,r.valueOffsets[t],e)},Dl=(r,t,e)=>{let n=r.type.typeIdToChildIndex[r.typeIds[t]],i=r.children[n];Pt.visit(i,t,e)},Vp=(r,t,e)=>{var n;(n=r.dictionary)===null||n===void 0||n.set(r.values[t],e)},ta=(r,t,e)=>{r.type.unit===Xt.DAY_TIME?_s(r,t,e):bs(r,t,e)},_s=({values:r},t,e)=>{r.set(e.subarray(0,2),2*t)},bs=({values:r},t,e)=>{r[t]=e[0]*12+e[1]%12},Hp=(r,t,e)=>{let{stride:n}=r,i=r.children[0],s=Pt.getVisitFn(i);if(Array.isArray(e))for(let o=-1,a=t*n;++o<n;)s(i,a+o,e[o]);else for(let o=-1,a=t*n;++o<n;)s(i,a+o,e.get(o))};k.prototype.visitBool=H(Tp);k.prototype.visitInt=H(cr);k.prototype.visitInt8=H(cr);k.prototype.visitInt16=H(cr);k.prototype.visitInt32=H(cr);k.prototype.visitInt64=H(cr);k.prototype.visitUint8=H(cr);k.prototype.visitUint16=H(cr);k.prototype.visitUint32=H(cr);k.prototype.visitUint64=H(cr);k.prototype.visitFloat=H(Dp);k.prototype.visitFloat16=H(xl);k.prototype.visitFloat32=H(Go);k.prototype.visitFloat64=H(Go);k.prototype.visitUtf8=H(Op);k.prototype.visitBinary=H(Ep);k.prototype.visitFixedSizeBinary=H(Ko);k.prototype.visitDate=H(Jo);k.prototype.visitDateDay=H(as);k.prototype.visitDateMillisecond=H(cs);k.prototype.visitTimestamp=H(qo);k.prototype.visitTimestampSecond=H(ls);k.prototype.visitTimestampMillisecond=H(us);k.prototype.visitTimestampMicrosecond=H(ds);k.prototype.visitTimestampNanosecond=H(fs);k.prototype.visitTime=H(Zo);k.prototype.visitTimeSecond=H(hs);k.prototype.visitTimeMillisecond=H(ps);k.prototype.visitTimeMicrosecond=H(ms);k.prototype.visitTimeNanosecond=H(ys);k.prototype.visitDecimal=H(Qo);k.prototype.visitList=H(Mp);k.prototype.visitStruct=H(Cp);k.prototype.visitUnion=H(Pp);k.prototype.visitDenseUnion=H(Tl);k.prototype.visitSparseUnion=H(Dl);k.prototype.visitDictionary=H(Vp);k.prototype.visitInterval=H(ta);k.prototype.visitIntervalDayTime=H(_s);k.prototype.visitIntervalYearMonth=H(bs);k.prototype.visitFixedSizeList=H(Hp);k.prototype.visitMap=H(Rp);var Pt=new k;var Ce=Symbol.for("parent"),An=Symbol.for("rowIndex"),on=class{constructor(t,e){return this[Ce]=t,this[An]=e,new Proxy(this,new Ol)}toArray(){return Object.values(this.toJSON())}toJSON(){let t=this[An],e=this[Ce],n=e.type.children,i={};for(let s=-1,o=n.length;++s<o;)i[n[s].name]=At.visit(e.children[s],t);return i}toString(){return`{${[...this].map(([t,e])=>`${ke(t)}: ${ke(e)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new El(this[Ce],this[An])}},El=class{constructor(t,e){this.childIndex=0,this.children=t.children,this.rowIndex=e,this.childFields=t.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){let t=this.childIndex;return t<this.numChildren?(this.childIndex=t+1,{done:!1,value:[this.childFields[t].name,At.visit(this.children[t],this.rowIndex)]}):{done:!0,value:null}}};Object.defineProperties(on.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[Ce]:{writable:!0,enumerable:!1,configurable:!1,value:null},[An]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});var Ol=class{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[Ce].type.children.map(e=>e.name)}has(t,e){return t[Ce].type.children.findIndex(n=>n.name===e)!==-1}getOwnPropertyDescriptor(t,e){if(t[Ce].type.children.findIndex(n=>n.name===e)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(t,e){if(Reflect.has(t,e))return t[e];let n=t[Ce].type.children.findIndex(i=>i.name===e);if(n!==-1){let i=At.visit(t[Ce].children[n],t[An]);return Reflect.set(t,e,i),i}}set(t,e,n){let i=t[Ce].type.children.findIndex(s=>s.name===e);return i!==-1?(Pt.visit(t[Ce].children[i],t[An],n),Reflect.set(t,e,n)):Reflect.has(t,e)?Reflect.set(t,e,n):!1}};var M=class extends E{};function P(r){return(t,e)=>t.getValid(e)?r(t,e):null}var zp=(r,t)=>864e5*r[t],ea=(r,t)=>4294967296*r[t+1]+(r[t]>>>0),jp=(r,t)=>4294967296*(r[t+1]/1e3)+(r[t]>>>0)/1e3,Wp=(r,t)=>4294967296*(r[t+1]/1e6)+(r[t]>>>0)/1e6,Ml=r=>new Date(r),Yp=(r,t)=>Ml(zp(r,t)),$p=(r,t)=>Ml(ea(r,t)),Xp=(r,t)=>null,Rl=(r,t,e)=>{let{[e]:n,[e+1]:i}=t;return n!=null&&i!=null?r.subarray(n,i):null},Gp=({offset:r,values:t},e)=>{let n=r+e;return(t[n>>3]&1<<n%8)!==0},Ul=({values:r},t)=>Yp(r,t),Nl=({values:r},t)=>$p(r,t*2),Cr=({stride:r,values:t},e)=>t[r*e],Kp=({stride:r,values:t},e)=>os(t[r*e]),kl=({values:r},t)=>r[t],Jp=({stride:r,values:t},e)=>t.subarray(r*e,r*(e+1)),qp=({values:r,valueOffsets:t},e)=>Rl(r,t,e),Zp=({values:r,valueOffsets:t},e)=>{let n=Rl(r,t,e);return n!==null?ri(n):null},Qp=({values:r},t)=>r[t],tm=({type:r,values:t},e)=>r.precision!==dt.HALF?t[e]:os(t[e]),em=(r,t)=>r.type.unit===Ct.DAY?Ul(r,t):Nl(r,t),Ll=({values:r},t)=>1e3*ea(r,t*2),Cl=({values:r},t)=>ea(r,t*2),Pl=({values:r},t)=>jp(r,t*2),Vl=({values:r},t)=>Wp(r,t*2),rm=(r,t)=>{switch(r.type.unit){case X.SECOND:return Ll(r,t);case X.MILLISECOND:return Cl(r,t);case X.MICROSECOND:return Pl(r,t);case X.NANOSECOND:return Vl(r,t)}},Hl=({values:r},t)=>r[t],zl=({values:r},t)=>r[t],jl=({values:r},t)=>r[t],Wl=({values:r},t)=>r[t],nm=(r,t)=>{switch(r.type.unit){case X.SECOND:return Hl(r,t);case X.MILLISECOND:return zl(r,t);case X.MICROSECOND:return jl(r,t);case X.NANOSECOND:return Wl(r,t)}},im=({values:r,stride:t},e)=>In.decimal(r.subarray(t*e,t*(e+1))),sm=(r,t)=>{let{valueOffsets:e,stride:n}=r,{[t*n]:i}=e,{[t*n+1]:s}=e,a=r.children[0].slice(i,s-i);return new L([a])},om=(r,t)=>{let{valueOffsets:e}=r,{[t]:n}=e,{[t+1]:i}=e,s=r.children[0];return new lr(s.slice(n,i-n))},am=(r,t)=>new on(r,t),cm=(r,t)=>r.type.mode===bt.Dense?Yl(r,t):$l(r,t),Yl=(r,t)=>{let e=r.type.typeIdToChildIndex[r.typeIds[t]],n=r.children[e];return At.visit(n,r.valueOffsets[t])},$l=(r,t)=>{let e=r.type.typeIdToChildIndex[r.typeIds[t]],n=r.children[e];return At.visit(n,t)},lm=(r,t)=>{var e;return(e=r.dictionary)===null||e===void 0?void 0:e.get(r.values[t])},um=(r,t)=>r.type.unit===Xt.DAY_TIME?Xl(r,t):Gl(r,t),Xl=({values:r},t)=>r.subarray(2*t,2*(t+1)),Gl=({values:r},t)=>{let e=r[t],n=new Int32Array(2);return n[0]=Math.trunc(e/12),n[1]=Math.trunc(e%12),n},dm=(r,t)=>{let{stride:e}=r,i=r.children[0].slice(t*e,e);return new L([i])};M.prototype.visitNull=P(Xp);M.prototype.visitBool=P(Gp);M.prototype.visitInt=P(Qp);M.prototype.visitInt8=P(Cr);M.prototype.visitInt16=P(Cr);M.prototype.visitInt32=P(Cr);M.prototype.visitInt64=P(kl);M.prototype.visitUint8=P(Cr);M.prototype.visitUint16=P(Cr);M.prototype.visitUint32=P(Cr);M.prototype.visitUint64=P(kl);M.prototype.visitFloat=P(tm);M.prototype.visitFloat16=P(Kp);M.prototype.visitFloat32=P(Cr);M.prototype.visitFloat64=P(Cr);M.prototype.visitUtf8=P(Zp);M.prototype.visitBinary=P(qp);M.prototype.visitFixedSizeBinary=P(Jp);M.prototype.visitDate=P(em);M.prototype.visitDateDay=P(Ul);M.prototype.visitDateMillisecond=P(Nl);M.prototype.visitTimestamp=P(rm);M.prototype.visitTimestampSecond=P(Ll);M.prototype.visitTimestampMillisecond=P(Cl);M.prototype.visitTimestampMicrosecond=P(Pl);M.prototype.visitTimestampNanosecond=P(Vl);M.prototype.visitTime=P(nm);M.prototype.visitTimeSecond=P(Hl);M.prototype.visitTimeMillisecond=P(zl);M.prototype.visitTimeMicrosecond=P(jl);M.prototype.visitTimeNanosecond=P(Wl);M.prototype.visitDecimal=P(im);M.prototype.visitList=P(sm);M.prototype.visitStruct=P(am);M.prototype.visitUnion=P(cm);M.prototype.visitDenseUnion=P(Yl);M.prototype.visitSparseUnion=P($l);M.prototype.visitDictionary=P(lm);M.prototype.visitInterval=P(um);M.prototype.visitIntervalDayTime=P(Xl);M.prototype.visitIntervalYearMonth=P(Gl);M.prototype.visitFixedSizeList=P(dm);M.prototype.visitMap=P(om);var At=new M;var Ae=Symbol.for("keys"),xn=Symbol.for("vals"),lr=class{constructor(t){return this[Ae]=new L([t.children[0]]).memoize(),this[xn]=t.children[1],new Proxy(this,new Jl)}[Symbol.iterator](){return new Kl(this[Ae],this[xn])}get size(){return this[Ae].length}toArray(){return Object.values(this.toJSON())}toJSON(){let t=this[Ae],e=this[xn],n={};for(let i=-1,s=t.length;++i<s;)n[t.get(i)]=At.visit(e,i);return n}toString(){return`{${[...this].map(([t,e])=>`${ke(t)}: ${ke(e)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}},Kl=class{constructor(t,e){this.keys=t,this.vals=e,this.keyIndex=0,this.numKeys=t.length}[Symbol.iterator](){return this}next(){let t=this.keyIndex;return t===this.numKeys?{done:!0,value:null}:(this.keyIndex++,{done:!1,value:[this.keys.get(t),At.visit(this.vals,t)]})}},Jl=class{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[Ae].toArray().map(String)}has(t,e){return t[Ae].includes(e)}getOwnPropertyDescriptor(t,e){if(t[Ae].indexOf(e)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(t,e){if(Reflect.has(t,e))return t[e];let n=t[Ae].indexOf(e);if(n!==-1){let i=At.visit(Reflect.get(t,xn),n);return Reflect.set(t,e,i),i}}set(t,e,n){let i=t[Ae].indexOf(e);return i!==-1?(Pt.visit(Reflect.get(t,xn),i,n),Reflect.set(t,e,n)):Reflect.has(t,e)?Reflect.set(t,e,n):!1}};Object.defineProperties(lr.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[Ae]:{writable:!0,enumerable:!1,configurable:!1,value:null},[xn]:{writable:!0,enumerable:!1,configurable:!1,value:null}});function fm(r,t,e){let n=r.length,i=t>-1?t:n+t%n;return e?e(r,i):i}var ql;function li(r,t,e,n){let{length:i=0}=r,s=typeof t!="number"?0:t,o=typeof e!="number"?i:e;return s<0&&(s=(s%i+i)%i),o<0&&(o=(o%i+i)%i),o<s&&(ql=s,s=o,o=ql),o>i&&(o=i),n?n(r,s,o):[s,o]}var Zl=r=>r!==r;function Pr(r){if(typeof r!=="object"||r===null)return Zl(r)?Zl:e=>e===r;if(r instanceof Date){let e=r.valueOf();return n=>n instanceof Date?n.valueOf()===e:!1}return ArrayBuffer.isView(r)?e=>e?Oo(r,e):!1:r instanceof Map?pm(r):Array.isArray(r)?hm(r):r instanceof L?mm(r):ym(r,!0)}function hm(r){let t=[];for(let e=-1,n=r.length;++e<n;)t[e]=Pr(r[e]);return gs(t)}function pm(r){let t=-1,e=[];for(let n of r.values())e[++t]=Pr(n);return gs(e)}function mm(r){let t=[];for(let e=-1,n=r.length;++e<n;)t[e]=Pr(r.get(e));return gs(t)}function ym(r,t=!1){let e=Object.keys(r);if(!t&&e.length===0)return()=>!1;let n=[];for(let i=-1,s=e.length;++i<s;)n[i]=Pr(r[e[i]]);return gs(n,e)}function gs(r,t){return e=>{if(!e||typeof e!="object")return!1;switch(e.constructor){case Array:return _m(r,e);case Map:return Ql(r,e,e.keys());case lr:case on:case Object:case void 0:return Ql(r,e,t||Object.keys(e))}return e instanceof L?bm(r,e):!1}}function _m(r,t){let e=r.length;if(t.length!==e)return!1;for(let n=-1;++n<e;)if(!r[n](t[n]))return!1;return!0}function bm(r,t){let e=r.length;if(t.length!==e)return!1;for(let n=-1;++n<e;)if(!r[n](t.get(n)))return!1;return!0}function Ql(r,t,e){let n=e[Symbol.iterator](),i=t instanceof Map?t.keys():Object.keys(t)[Symbol.iterator](),s=t instanceof Map?t.values():Object.values(t)[Symbol.iterator](),o=0,a=r.length,c=s.next(),d=n.next(),p=i.next();for(;o<a&&!d.done&&!p.done&&!c.done&&!(d.value!==p.value||!r[o](c.value));++o,d=n.next(),p=i.next(),c=s.next());return o===a&&d.done&&p.done&&c.done?!0:(n.return&&n.return(),i.return&&i.return(),s.return&&s.return(),!1)}var na={};nn(na,{BitIterator:()=>Dn,getBit:()=>tu,getBool:()=>vs,packBools:()=>an,popcnt_array:()=>eu,popcnt_bit_range:()=>ui,popcnt_uint32:()=>ws,setBool:()=>gm,truncateBitmap:()=>Tn});function vs(r,t,e,n){return(e&1<<n)!==0}function tu(r,t,e,n){return(e&1<<n)>>n}function gm(r,t,e){return e?!!(r[t>>3]|=1<<t%8)||!0:!(r[t>>3]&=~(1<<t%8))&&!1}function Tn(r,t,e){let n=e.byteLength+7&-8;if(r>0||e.byteLength<n){let i=new Uint8Array(n);return i.set(r%8===0?e.subarray(r>>3):an(new Dn(e,r,t,null,vs)).subarray(0,n)),i}return e}function an(r){let t=[],e=0,n=0,i=0;for(let o of r)o&&(i|=1<<n),++n===8&&(t[e++]=i,i=n=0);(e===0||n>0)&&(t[e++]=i);let s=new Uint8Array(t.length+7&-8);return s.set(t),s}var Dn=class{constructor(t,e,n,i,s){this.bytes=t,this.length=n,this.context=i,this.get=s,this.bit=e%8,this.byteIndex=e>>3,this.byte=t[this.byteIndex++],this.index=0}next(){return this.index<this.length?(this.bit===8&&(this.bit=0,this.byte=this.bytes[this.byteIndex++]),{value:this.get(this.context,this.index++,this.byte,this.bit++)}):{done:!0,value:null}}[Symbol.iterator](){return this}};function ui(r,t,e){if(e-t<=0)return 0;if(e-t<8){let s=0;for(let o of new Dn(r,t,e-t,r,tu))s+=o;return s}let n=e>>3<<3,i=t+(t%8===0?0:8-t%8);return ui(r,t,i)+ui(r,n,e)+eu(r,i>>3,n-i>>3)}function eu(r,t,e){let n=0,i=Math.trunc(t),s=new DataView(r.buffer,r.byteOffset,r.byteLength),o=e===void 0?r.byteLength:i+e;for(;o-i>=4;)n+=ws(s.getUint32(i)),i+=4;for(;o-i>=2;)n+=ws(s.getUint16(i)),i+=2;for(;o-i>=1;)n+=ws(s.getUint8(i)),i+=1;return n}function ws(r){let t=Math.trunc(r);return t=t-(t>>>1&1431655765),t=(t&858993459)+(t>>>2&858993459),(t+(t>>>4)&252645135)*16843009>>>24}var wm=-1,Q=class{constructor(t,e,n,i,s,o=[],a){this.type=t,this.children=o,this.dictionary=a,this.offset=Math.floor(Math.max(e||0,0)),this.length=Math.floor(Math.max(n||0,0)),this._nullCount=Math.floor(Math.max(i||0,-1));let c;s instanceof Q?(this.stride=s.stride,this.values=s.values,this.typeIds=s.typeIds,this.nullBitmap=s.nullBitmap,this.valueOffsets=s.valueOffsets):(this.stride=ae(t),s&&((c=s[0])&&(this.valueOffsets=c),(c=s[1])&&(this.values=c),(c=s[2])&&(this.nullBitmap=c),(c=s[3])&&(this.typeIds=c))),this.nullable=this._nullCount!==0&&this.nullBitmap&&this.nullBitmap.byteLength>0}get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get byteLength(){let t=0,{valueOffsets:e,values:n,nullBitmap:i,typeIds:s}=this;return e&&(t+=e.byteLength),n&&(t+=n.byteLength),i&&(t+=i.byteLength),s&&(t+=s.byteLength),this.children.reduce((o,a)=>o+a.byteLength,t)}get nullCount(){let t=this._nullCount,e;return t<=wm&&(e=this.nullBitmap)&&(this._nullCount=t=this.length-ui(e,this.offset,this.offset+this.length)),t}getValid(t){if(this.nullable&&this.nullCount>0){let e=this.offset+t;return(this.nullBitmap[e>>3]&1<<e%8)!==0}return!0}setValid(t,e){if(!this.nullable)return e;if(!this.nullBitmap||this.nullBitmap.byteLength<=t>>3){let{nullBitmap:c}=this._changeLengthAndBackfillNullBitmap(this.length);Object.assign(this,{nullBitmap:c,_nullCount:0})}let{nullBitmap:n,offset:i}=this,s=i+t>>3,o=(i+t)%8,a=n[s]>>o&1;return e?a===0&&(n[s]|=1<<o,this._nullCount=this.nullCount+1):a===1&&(n[s]&=~(1<<o),this._nullCount=this.nullCount-1),e}clone(t=this.type,e=this.offset,n=this.length,i=this._nullCount,s=this,o=this.children){return new Q(t,e,n,i,s,o,this.dictionary)}slice(t,e){let{stride:n,typeId:i,children:s}=this,o=+(this._nullCount===0)-1,a=i===16?n:1,c=this._sliceBuffers(t,e,n,i);return this.clone(this.type,this.offset+t,e,o,c,s.length===0||this.valueOffsets?s:this._sliceChildren(s,a*t,a*e))}_changeLengthAndBackfillNullBitmap(t){if(this.typeId===h.Null)return this.clone(this.type,0,t,0);let{length:e,nullCount:n}=this,i=new Uint8Array((t+63&-64)>>3).fill(255,0,e>>3);i[e>>3]=(1<<e-(e&-8))-1,n>0&&i.set(Tn(this.offset,e,this.nullBitmap),0);let s=this.buffers;return s[Be.VALIDITY]=i,this.clone(this.type,0,t,n+(t-e),s)}_sliceBuffers(t,e,n,i){let s,{buffers:o}=this;return(s=o[Be.TYPE])&&(o[Be.TYPE]=s.subarray(t,t+e)),(s=o[Be.OFFSET])&&(o[Be.OFFSET]=s.subarray(t,t+e+1))||(s=o[Be.DATA])&&(o[Be.DATA]=i===6?s:s.subarray(n*t,n*(t+e))),o}_sliceChildren(t,e,n){return t.map(i=>i.slice(e,n))}};Q.prototype.children=Object.freeze([]);var En=class extends E{visit(t){return this.getVisitFn(t.type).call(this,t)}visitNull(t){let{["type"]:e,["offset"]:n=0,["length"]:i=0}=t;return new Q(e,n,i,0)}visitBool(t){let{["type"]:e,["offset"]:n=0}=t,i=O(t.nullBitmap),s=W(e.ArrayType,t.data),{["length"]:o=s.length>>3,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Q(e,n,o,a,[void 0,s,i])}visitInt(t){let{["type"]:e,["offset"]:n=0}=t,i=O(t.nullBitmap),s=W(e.ArrayType,t.data),{["length"]:o=s.length,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Q(e,n,o,a,[void 0,s,i])}visitFloat(t){let{["type"]:e,["offset"]:n=0}=t,i=O(t.nullBitmap),s=W(e.ArrayType,t.data),{["length"]:o=s.length,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Q(e,n,o,a,[void 0,s,i])}visitUtf8(t){let{["type"]:e,["offset"]:n=0}=t,i=O(t.data),s=O(t.nullBitmap),o=sn(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new Q(e,n,a,c,[o,i,s])}visitBinary(t){let{["type"]:e,["offset"]:n=0}=t,i=O(t.data),s=O(t.nullBitmap),o=sn(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new Q(e,n,a,c,[o,i,s])}visitFixedSizeBinary(t){let{["type"]:e,["offset"]:n=0}=t,i=O(t.nullBitmap),s=W(e.ArrayType,t.data),{["length"]:o=s.length/ae(e),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Q(e,n,o,a,[void 0,s,i])}visitDate(t){let{["type"]:e,["offset"]:n=0}=t,i=O(t.nullBitmap),s=W(e.ArrayType,t.data),{["length"]:o=s.length/ae(e),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Q(e,n,o,a,[void 0,s,i])}visitTimestamp(t){let{["type"]:e,["offset"]:n=0}=t,i=O(t.nullBitmap),s=W(e.ArrayType,t.data),{["length"]:o=s.length/ae(e),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Q(e,n,o,a,[void 0,s,i])}visitTime(t){let{["type"]:e,["offset"]:n=0}=t,i=O(t.nullBitmap),s=W(e.ArrayType,t.data),{["length"]:o=s.length/ae(e),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Q(e,n,o,a,[void 0,s,i])}visitDecimal(t){let{["type"]:e,["offset"]:n=0}=t,i=O(t.nullBitmap),s=W(e.ArrayType,t.data),{["length"]:o=s.length/ae(e),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Q(e,n,o,a,[void 0,s,i])}visitList(t){let{["type"]:e,["offset"]:n=0,["child"]:i}=t,s=O(t.nullBitmap),o=sn(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new Q(e,n,a,c,[o,void 0,s],[i])}visitStruct(t){let{["type"]:e,["offset"]:n=0,["children"]:i=[]}=t,s=O(t.nullBitmap),{length:o=i.reduce((c,{length:d})=>Math.max(c,d),0),nullCount:a=t.nullBitmap?-1:0}=t;return new Q(e,n,o,a,[void 0,void 0,s],i)}visitUnion(t){let{["type"]:e,["offset"]:n=0,["children"]:i=[]}=t,s=O(t.nullBitmap),o=W(e.ArrayType,t.typeIds),{["length"]:a=o.length,["nullCount"]:c=t.nullBitmap?-1:0}=t;if(A.isSparseUnion(e))return new Q(e,n,a,c,[void 0,void 0,s,o],i);let d=sn(t.valueOffsets);return new Q(e,n,a,c,[d,void 0,s,o],i)}visitDictionary(t){let{["type"]:e,["offset"]:n=0}=t,i=O(t.nullBitmap),s=W(e.indices.ArrayType,t.data),{["dictionary"]:o=new L([new En().visit({type:e.dictionary})])}=t,{["length"]:a=s.length,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new Q(e,n,a,c,[void 0,s,i],[],o)}visitInterval(t){let{["type"]:e,["offset"]:n=0}=t,i=O(t.nullBitmap),s=W(e.ArrayType,t.data),{["length"]:o=s.length/ae(e),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Q(e,n,o,a,[void 0,s,i])}visitFixedSizeList(t){let{["type"]:e,["offset"]:n=0,["child"]:i=new En().visit({type:e.valueType})}=t,s=O(t.nullBitmap),{["length"]:o=i.length/ae(e),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Q(e,n,o,a,[void 0,void 0,s],[i])}visitMap(t){let{["type"]:e,["offset"]:n=0,["child"]:i=new En().visit({type:e.childType})}=t,s=O(t.nullBitmap),o=sn(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new Q(e,n,a,c,[o,void 0,s],[i])}};function C(r){return new En().visit(r)}var Ss=class{constructor(t=0,e){this.numChunks=t,this.getChunkIterator=e,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){for(;this.chunkIndex<this.numChunks;){let t=this.chunkIterator.next();if(!t.done)return t;++this.chunkIndex<this.numChunks&&(this.chunkIterator=this.getChunkIterator(this.chunkIndex))}return{done:!0,value:null}}[Symbol.iterator](){return this}};function Is(r){return r.reduce((t,e)=>t+e.nullCount,0)}function Bs(r){return r.reduce((t,e,n)=>(t[n+1]=t[n]+e.length,t),new Uint32Array(r.length+1))}function Fs(r,t,e,n){let i=[];for(let s=-1,o=r.length;++s<o;){let a=r[s],c=t[s],{length:d}=a;if(c>=n)break;if(e>=c+d)continue;if(c>=e&&c+d<=n){i.push(a);continue}let p=Math.max(0,e-c),_=Math.min(n-c,d);i.push(a.slice(p,_-p))}return i.length===0&&i.push(r[0].slice(0,0)),i}function ia(r,t,e,n){let i=0,s=0,o=t.length-1;do{if(i>=o-1)return e<t[o]?n(r,i,e-t[i]):null;s=i+Math.trunc((o-i)*.5),e<t[s]?o=s:i=s}while(i<o)}function di(r,t){return r.getValid(t)}function Vr(r){function t(e,n,i){return r(e[n],i)}return function(e){let n=this.data;return ia(n,this._offsets,e,t)}}function As(r){let t;function e(n,i,s){return r(n[i],s,t)}return function(n,i){let s=this.data;t=i;let o=ia(s,this._offsets,n,e);return t=void 0,o}}function xs(r){let t;function e(n,i,s){let o=s,a=0,c=0;for(let d=i-1,p=n.length;++d<p;){let _=n[d];if(~(a=r(_,t,o)))return c+a;o=0,c+=_.length}return-1}return function(n,i){t=n;let s=this.data,o=typeof i!="number"?e(s,0,0):ia(s,this._offsets,i,e);return t=void 0,o}}var R=class extends E{};function vm(r,t){return t===null&&r.length>0?0:-1}function Sm(r,t){let{nullBitmap:e}=r;if(!e||r.nullCount<=0)return-1;let n=0;for(let i of new Dn(e,r.offset+(t||0),r.length,e,vs)){if(!i)return n;++n}return-1}function Y(r,t,e){if(t===void 0)return-1;if(t===null)return Sm(r,e);let n=At.getVisitFn(r),i=Pr(t);for(let s=(e||0)-1,o=r.length;++s<o;)if(i(n(r,s)))return s;return-1}function ru(r,t,e){let n=At.getVisitFn(r),i=Pr(t);for(let s=(e||0)-1,o=r.length;++s<o;)if(i(n(r,s)))return s;return-1}R.prototype.visitNull=vm;R.prototype.visitBool=Y;R.prototype.visitInt=Y;R.prototype.visitInt8=Y;R.prototype.visitInt16=Y;R.prototype.visitInt32=Y;R.prototype.visitInt64=Y;R.prototype.visitUint8=Y;R.prototype.visitUint16=Y;R.prototype.visitUint32=Y;R.prototype.visitUint64=Y;R.prototype.visitFloat=Y;R.prototype.visitFloat16=Y;R.prototype.visitFloat32=Y;R.prototype.visitFloat64=Y;R.prototype.visitUtf8=Y;R.prototype.visitBinary=Y;R.prototype.visitFixedSizeBinary=Y;R.prototype.visitDate=Y;R.prototype.visitDateDay=Y;R.prototype.visitDateMillisecond=Y;R.prototype.visitTimestamp=Y;R.prototype.visitTimestampSecond=Y;R.prototype.visitTimestampMillisecond=Y;R.prototype.visitTimestampMicrosecond=Y;R.prototype.visitTimestampNanosecond=Y;R.prototype.visitTime=Y;R.prototype.visitTimeSecond=Y;R.prototype.visitTimeMillisecond=Y;R.prototype.visitTimeMicrosecond=Y;R.prototype.visitTimeNanosecond=Y;R.prototype.visitDecimal=Y;R.prototype.visitList=Y;R.prototype.visitStruct=Y;R.prototype.visitUnion=Y;R.prototype.visitDenseUnion=ru;R.prototype.visitSparseUnion=ru;R.prototype.visitDictionary=Y;R.prototype.visitInterval=Y;R.prototype.visitIntervalDayTime=Y;R.prototype.visitIntervalYearMonth=Y;R.prototype.visitFixedSizeList=Y;R.prototype.visitMap=Y;var cn=new R;var U=class extends E{};function V(r){let{type:t}=r;if(r.nullCount===0&&r.stride===1&&(t.typeId===h.Timestamp||t instanceof Ft&&t.bitWidth!==64||t instanceof Ke&&t.bitWidth!==64||t instanceof oe&&t.precision!==dt.HALF))return new Ss(r.data.length,n=>{let i=r.data[n];return i.values.subarray(0,i.length)[Symbol.iterator]()});let e=0;return new Ss(r.data.length,n=>{let s=r.data[n].length,o=r.slice(e,e+s);return e+=s,new nu(o)})}var nu=class{constructor(t){this.vector=t,this.index=0}next(){return this.index<this.vector.length?{value:this.vector.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}};U.prototype.visitNull=V;U.prototype.visitBool=V;U.prototype.visitInt=V;U.prototype.visitInt8=V;U.prototype.visitInt16=V;U.prototype.visitInt32=V;U.prototype.visitInt64=V;U.prototype.visitUint8=V;U.prototype.visitUint16=V;U.prototype.visitUint32=V;U.prototype.visitUint64=V;U.prototype.visitFloat=V;U.prototype.visitFloat16=V;U.prototype.visitFloat32=V;U.prototype.visitFloat64=V;U.prototype.visitUtf8=V;U.prototype.visitBinary=V;U.prototype.visitFixedSizeBinary=V;U.prototype.visitDate=V;U.prototype.visitDateDay=V;U.prototype.visitDateMillisecond=V;U.prototype.visitTimestamp=V;U.prototype.visitTimestampSecond=V;U.prototype.visitTimestampMillisecond=V;U.prototype.visitTimestampMicrosecond=V;U.prototype.visitTimestampNanosecond=V;U.prototype.visitTime=V;U.prototype.visitTimeSecond=V;U.prototype.visitTimeMillisecond=V;U.prototype.visitTimeMicrosecond=V;U.prototype.visitTimeNanosecond=V;U.prototype.visitDecimal=V;U.prototype.visitList=V;U.prototype.visitStruct=V;U.prototype.visitUnion=V;U.prototype.visitDenseUnion=V;U.prototype.visitSparseUnion=V;U.prototype.visitDictionary=V;U.prototype.visitInterval=V;U.prototype.visitIntervalDayTime=V;U.prototype.visitIntervalYearMonth=V;U.prototype.visitFixedSizeList=V;U.prototype.visitMap=V;var On=new U;var sa=(r,t)=>r+t,ur=class extends E{visitNull(t,e){return 0}visitInt(t,e){return t.type.bitWidth/8}visitFloat(t,e){return t.type.ArrayType.BYTES_PER_ELEMENT}visitBool(t,e){return 1/8}visitDecimal(t,e){return 16}visitDate(t,e){return(t.type.unit+1)*4}visitTime(t,e){return t.type.bitWidth/8}visitTimestamp(t,e){return t.type.unit===X.SECOND?4:8}visitInterval(t,e){return(t.type.unit+1)*4}visitStruct(t,e){return this.visitMany(t.children,t.children.map(()=>e)).reduce(sa,0)}visitFixedSizeBinary(t,e){return t.type.byteWidth}visitMap(t,e){return this.visitMany(t.children,t.children.map(()=>e)).reduce(sa,0)}visitDictionary(t,e){var n;return t.type.indices.bitWidth/8+(((n=t.dictionary)===null||n===void 0?void 0:n.getByteLength(t.values[e]))||0)}},Im=({valueOffsets:r},t)=>8+(r[t+1]-r[t]),Bm=({valueOffsets:r},t)=>8+(r[t+1]-r[t]),Fm=({valueOffsets:r,stride:t,children:e},n)=>{let i=e[0],{[n*t]:s}=r,{[n*t+1]:o}=r,a=Pe.getVisitFn(i.type),c=i.slice(s,o-s),d=8;for(let p=-1,_=o-s;++p<_;)d+=a(c,p);return d},Am=({stride:r,children:t},e)=>{let n=t[0],i=n.slice(e*r,r),s=Pe.getVisitFn(n.type),o=0;for(let a=-1,c=i.length;++a<c;)o+=s(i,a);return o},xm=(r,t)=>r.type.mode===bt.Dense?iu(r,t):su(r,t),iu=({type:r,children:t,typeIds:e,valueOffsets:n},i)=>{let s=r.typeIdToChildIndex[e[i]];return 8+Pe.visit(t[s],n[i])},su=({children:r},t)=>4+Pe.visitMany(r,r.map(()=>t)).reduce(sa,0);ur.prototype.visitUtf8=Im;ur.prototype.visitBinary=Bm;ur.prototype.visitList=Fm;ur.prototype.visitFixedSizeList=Am;ur.prototype.visitUnion=xm;ur.prototype.visitDenseUnion=iu;ur.prototype.visitSparseUnion=su;var Pe=new ur;var ou,au={},cu={},L=class{constructor(t){var e,n,i;let s=t[0]instanceof L?t.flatMap(a=>a.data):t;if(s.some(a=>!(a instanceof Q)))throw new TypeError("Vector constructor expects an Array of Data instances.");let o=(e=s[0])===null||e===void 0?void 0:e.type;switch(s.length){case 0:this._offsets=[0];break;case 1:{let{get:a,set:c,indexOf:d,byteLength:p}=au[o.typeId],_=s[0];this.isValid=g=>di(_,g),this.get=g=>a(_,g),this.set=(g,w)=>c(_,g,w),this.indexOf=g=>d(_,g),this.getByteLength=g=>p(_,g),this._offsets=[0,_.length];break}default:Object.setPrototypeOf(this,cu[o.typeId]),this._offsets=Bs(s);break}this.data=s,this.type=o,this.stride=ae(o),this.numChildren=(i=(n=o.children)===null||n===void 0?void 0:n.length)!==null&&i!==void 0?i:0,this.length=this._offsets[this._offsets.length-1]}get byteLength(){return this._byteLength===-1&&(this._byteLength=this.data.reduce((t,e)=>t+e.byteLength,0)),this._byteLength}get nullCount(){return this._nullCount===-1&&(this._nullCount=Is(this.data)),this._nullCount}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${h[this.type.typeId]}Vector`}isValid(t){return!1}get(t){return null}set(t,e){}indexOf(t,e){return-1}includes(t,e){return this.indexOf(t,e)>0}getByteLength(t){return 0}[Symbol.iterator](){return On.visit(this)}concat(...t){return new L(this.data.concat(t.flatMap(e=>e.data).flat(Number.POSITIVE_INFINITY)))}slice(t,e){return new L(li(this,t,e,({data:n,_offsets:i},s,o)=>Fs(n,i,s,o)))}toJSON(){return[...this]}toArray(){let{type:t,data:e,length:n,stride:i,ArrayType:s}=this;switch(t.typeId){case h.Int:case h.Float:case h.Decimal:case h.Time:case h.Timestamp:switch(e.length){case 0:return new s;case 1:return e[0].values.subarray(0,n*i);default:return e.reduce((o,{values:a})=>(o.array.set(a,o.offset),o.offset+=a.length,o),{array:new s(n*i),offset:0}).array}}return[...this]}toString(){return`[${[...this].join(",")}]`}getChild(t){var e;return this.getChildAt((e=this.type.children)===null||e===void 0?void 0:e.findIndex(n=>n.name===t))}getChildAt(t){return t>-1&&t<this.numChildren?new L(this.data.map(({children:e})=>e[t])):null}get isMemoized(){return A.isDictionary(this.type)?this.data[0].dictionary.isMemoized:!1}memoize(){if(A.isDictionary(this.type)){let t=new fi(this.data[0].dictionary),e=this.data.map(n=>{let i=n.clone();return i.dictionary=t,i});return new L(e)}return new fi(this)}unmemoize(){if(A.isDictionary(this.type)&&this.isMemoized){let t=this.data[0].dictionary.unmemoize(),e=this.data.map(n=>{let i=n.clone();return i.dictionary=t,i});return new L(e)}return this}};ou=Symbol.toStringTag;L[ou]=(r=>{r.type=A.prototype,r.data=[],r.length=0,r.stride=1,r.numChildren=0,r._nullCount=-1,r._byteLength=-1,r._offsets=new Uint32Array([0]),r[Symbol.isConcatSpreadable]=!0;let t=Object.keys(h).map(e=>h[e]).filter(e=>typeof e=="number"&&e!==h.NONE);for(let e of t){let n=At.getVisitFnByTypeId(e),i=Pt.getVisitFnByTypeId(e),s=cn.getVisitFnByTypeId(e),o=Pe.getVisitFnByTypeId(e);au[e]={get:n,set:i,indexOf:s,byteLength:o},cu[e]=Object.create(r,{isValid:{value:Vr(di)},get:{value:Vr(At.getVisitFnByTypeId(e))},set:{value:As(Pt.getVisitFnByTypeId(e))},indexOf:{value:xs(cn.getVisitFnByTypeId(e))},getByteLength:{value:Vr(Pe.getVisitFnByTypeId(e))}})}return"Vector"})(L.prototype);var fi=class extends L{constructor(t){super(t.data);let e=this.get,n=this.set,i=this.slice,s=new Array(this.length);Object.defineProperty(this,"get",{value(o){let a=s[o];if(a!==void 0)return a;let c=e.call(this,o);return s[o]=c,c}}),Object.defineProperty(this,"set",{value(o,a){n.call(this,o,a),s[o]=a}}),Object.defineProperty(this,"slice",{value:(o,a)=>new fi(i.call(this,o,a))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new L(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}};function lu(r){if(!r||r.length<=0)return function(i){return!0};let t="",e=r.filter(n=>n===n);return e.length>0&&(t=`
    switch (x) {${e.map(n=>`
        case ${Tm(n)}:`).join("")}
            return false;
    }`),r.length!==e.length&&(t=`if (x !== x) return false;
${t}`),new Function("x",`${t}
return true;`)}function Tm(r){return typeof r!="bigint"?ke(r):qi?`${ke(r)}n`:`"${ke(r)}"`}var oa=(r,t)=>(r*t+63&-64||64)/t,Dm=(r,t=0)=>r.length>=t?r.subarray(0,t):wn(new r.constructor(t),r,0),ln=class{constructor(t,e=1){this.buffer=t,this.stride=e,this.BYTES_PER_ELEMENT=t.BYTES_PER_ELEMENT,this.ArrayType=t.constructor,this._resize(this.length=Math.trunc(t.length/e))}get byteLength(){return Math.trunc(this.length*this.stride*this.BYTES_PER_ELEMENT)}get reservedLength(){return this.buffer.length/this.stride}get reservedByteLength(){return this.buffer.byteLength}set(t,e){return this}append(t){return this.set(this.length,t)}reserve(t){if(t>0){this.length+=t;let e=this.stride,n=this.length*e,i=this.buffer.length;n>=i&&this._resize(i===0?oa(n*1,this.BYTES_PER_ELEMENT):oa(n*2,this.BYTES_PER_ELEMENT))}return this}flush(t=this.length){t=oa(t*this.stride,this.BYTES_PER_ELEMENT);let e=Dm(this.buffer,t);return this.clear(),e}clear(){return this.length=0,this._resize(0),this}_resize(t){return this.buffer=wn(new this.ArrayType(t),this.buffer)}};ln.prototype.offset=0;var Hr=class extends ln{last(){return this.get(this.length-1)}get(t){return this.buffer[t]}set(t,e){return this.reserve(t-this.length+1),this.buffer[t*this.stride]=e,this}},hi=class extends Hr{constructor(t=new Uint8Array(0)){super(t,1/8);this.numValid=0}get numInvalid(){return this.length-this.numValid}get(t){return this.buffer[t>>3]>>t%8&1}set(t,e){let{buffer:n}=this.reserve(t-this.length+1),i=t>>3,s=t%8,o=n[i]>>s&1;return e?o===0&&(n[i]|=1<<s,++this.numValid):o===1&&(n[i]&=~(1<<s),--this.numValid),this}clear(){return this.numValid=0,super.clear()}},pi=class extends Hr{constructor(t=new Int32Array(1)){super(t,1)}append(t){return this.set(this.length-1,t)}set(t,e){let n=this.length-1,i=this.reserve(t-n+1).buffer;return n<t++&&i.fill(i[n],n,t),i[t]=i[t-1]+e,this}flush(t=this.length-1){return t>this.length&&this.set(t-1,0),super.flush(t+1)}};var _t=class{constructor({type:t,nullValues:e}){this.length=0,this.finished=!1,this.type=t,this.children=[],this.nullValues=e,this.stride=ae(t),this._nulls=new hi,e&&e.length>0&&(this._isValid=lu(e))}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t){throw new Error('"throughDOM" not available in this environment')}toVector(){return new L([this.flush()])}get ArrayType(){return this.type.ArrayType}get nullCount(){return this._nulls.numInvalid}get numChildren(){return this.children.length}get byteLength(){let t=0,{_offsets:e,_values:n,_nulls:i,_typeIds:s,children:o}=this;return e&&(t+=e.byteLength),n&&(t+=n.byteLength),i&&(t+=i.byteLength),s&&(t+=s.byteLength),o.reduce((a,c)=>a+c.byteLength,t)}get reservedLength(){return this._nulls.reservedLength}get reservedByteLength(){let t=0;return this._offsets&&(t+=this._offsets.reservedByteLength),this._values&&(t+=this._values.reservedByteLength),this._nulls&&(t+=this._nulls.reservedByteLength),this._typeIds&&(t+=this._typeIds.reservedByteLength),this.children.reduce((e,n)=>e+n.reservedByteLength,t)}get valueOffsets(){return this._offsets?this._offsets.buffer:null}get values(){return this._values?this._values.buffer:null}get nullBitmap(){return this._nulls?this._nulls.buffer:null}get typeIds(){return this._typeIds?this._typeIds.buffer:null}append(t){return this.set(this.length,t)}isValid(t){return this._isValid(t)}set(t,e){return this.setValid(t,this.isValid(e))&&this.setValue(t,e),this}setValue(t,e){this._setValue(this,t,e)}setValid(t,e){return this.length=this._nulls.set(t,+e).length,e}addChild(t,e=`${this.numChildren}`){throw new Error(`Cannot append children to non-nested type "${this.type}"`)}getChildAt(t){return this.children[t]||null}flush(){let t,e,n,i,{type:s,length:o,nullCount:a,_typeIds:c,_offsets:d,_values:p,_nulls:_}=this;(e=c==null?void 0:c.flush(o))?i=d==null?void 0:d.flush(o):(i=d==null?void 0:d.flush(o))?t=p==null?void 0:p.flush(d.last()):t=p==null?void 0:p.flush(o),a>0&&(n=_==null?void 0:_.flush(o));let g=this.children.map(w=>w.flush());return this.clear(),C({type:s,length:o,nullCount:a,children:g,child:g[0],data:t,typeIds:e,nullBitmap:n,valueOffsets:i})}finish(){this.finished=!0;for(let t of this.children)t.finish();return this}clear(){var t,e,n,i;this.length=0,(t=this._nulls)===null||t===void 0||t.clear(),(e=this._values)===null||e===void 0||e.clear(),(n=this._offsets)===null||n===void 0||n.clear(),(i=this._typeIds)===null||i===void 0||i.clear();for(let s of this.children)s.clear();return this}};_t.prototype.length=1;_t.prototype.stride=1;_t.prototype.children=null;_t.prototype.finished=!1;_t.prototype.nullValues=null;_t.prototype._isValid=()=>!0;var Vt=class extends _t{constructor(t){super(t);this._values=new Hr(new this.ArrayType(0),this.stride)}setValue(t,e){let n=this._values;return n.reserve(t-n.length+1),super.setValue(t,e)}},dr=class extends _t{constructor(t){super(t);this._pendingLength=0,this._offsets=new pi}setValue(t,e){let n=this._pending||(this._pending=new Map),i=n.get(t);i&&(this._pendingLength-=i.length),this._pendingLength+=e instanceof lr?e[Ae].length:e.length,n.set(t,e)}setValid(t,e){return super.setValid(t,e)?!0:((this._pending||(this._pending=new Map)).set(t,void 0),!1)}clear(){return this._pendingLength=0,this._pending=void 0,super.clear()}flush(){return this._flush(),super.flush()}finish(){return this._flush(),super.finish()}_flush(){let t=this._pending,e=this._pendingLength;return this._pendingLength=0,this._pending=void 0,t&&t.size>0&&this._flushPending(t,e),this}};var Mn=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static sizeOf(){return 24}static createBlock(t,e,n,i){return t.prep(8,24),t.writeInt64(i),t.pad(4),t.writeInt32(n),t.writeInt64(e),t.offset()}};var tr=new Int32Array(2),Ts=new Float32Array(tr.buffer),Ds=new Float64Array(tr.buffer),Rn=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;var Ot=class{constructor(t,e){this.low=t|0,this.high=e|0}static create(t,e){return t==0&&e==0?Ot.ZERO:new Ot(t,e)}toFloat64(){return(this.low>>>0)+this.high*4294967296}equals(t){return this.low==t.low&&this.high==t.high}};Ot.ZERO=new Ot(0,0);var mi;(function(r){r[r.UTF8_BYTES=1]="UTF8_BYTES",r[r.UTF16_STRING=2]="UTF16_STRING"})(mi||(mi={}));var re=class{constructor(t){this.bytes_=t,this.position_=0}static allocate(t){return new re(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return new Ot(this.readInt32(t),this.readInt32(t+4))}readUint64(t){return new Ot(this.readUint32(t),this.readUint32(t+4))}readFloat32(t){return tr[0]=this.readInt32(t),Ts[0]}readFloat64(t){return tr[Rn?0:1]=this.readInt32(t),tr[Rn?1:0]=this.readInt32(t+4),Ds[0]}writeInt8(t,e){this.bytes_[t]=e}writeUint8(t,e){this.bytes_[t]=e}writeInt16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeUint16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeInt32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeUint32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeInt64(t,e){this.writeInt32(t,e.low),this.writeInt32(t+4,e.high)}writeUint64(t,e){this.writeUint32(t,e.low),this.writeUint32(t+4,e.high)}writeFloat32(t,e){Ts[0]=e,this.writeInt32(t,tr[0])}writeFloat64(t,e){Ds[0]=e,this.writeInt32(t,tr[Rn?0:1]),this.writeInt32(t+4,tr[Rn?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+4+4)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let t="";for(let e=0;e<4;e++)t+=String.fromCharCode(this.readInt8(this.position_+4+e));return t}__offset(t,e){let n=t-this.readInt32(t);return e<this.readInt16(n)?this.readInt16(n+e):0}__union(t,e){return t.bb_pos=e+this.readInt32(e),t.bb=this,t}__string(t,e){t+=this.readInt32(t);let n=this.readInt32(t),i="",s=0;if(t+=4,e===mi.UTF8_BYTES)return this.bytes_.subarray(t,t+n);for(;s<n;){let o,a=this.readUint8(t+s++);if(a<192)o=a;else{let c=this.readUint8(t+s++);if(a<224)o=(a&31)<<6|c&63;else{let d=this.readUint8(t+s++);if(a<240)o=(a&15)<<12|(c&63)<<6|d&63;else{let p=this.readUint8(t+s++);o=(a&7)<<18|(c&63)<<12|(d&63)<<6|p&63}}}o<65536?i+=String.fromCharCode(o):(o-=65536,i+=String.fromCharCode((o>>10)+55296,(o&(1<<10)-1)+56320))}return i}__union_with_string(t,e){return typeof t=="string"?this.__string(e):this.__union(t,e)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+4}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(t.length!=4)throw new Error("FlatBuffers: file identifier must be length "+4);for(let e=0;e<4;e++)if(t.charCodeAt(e)!=this.readInt8(this.position()+4+e))return!1;return!0}createLong(t,e){return Ot.create(t,e)}createScalarList(t,e){let n=[];for(let i=0;i<e;++i)t(i)!==null&&n.push(t(i));return n}createObjList(t,e){let n=[];for(let i=0;i<e;++i){let s=t(i);s!==null&&n.push(s.unpack())}return n}};var zr=class{constructor(t){this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null;let e;t?e=t:e=1024,this.bb=re.allocate(e),this.space=e}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(t){this.force_defaults=t}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(t,e){t>this.minalign&&(this.minalign=t);let n=~(this.bb.capacity()-this.space+e)+1&t-1;for(;this.space<n+t+e;){let i=this.bb.capacity();this.bb=zr.growByteBuffer(this.bb),this.space+=this.bb.capacity()-i}this.pad(n)}pad(t){for(let e=0;e<t;e++)this.bb.writeInt8(--this.space,0)}writeInt8(t){this.bb.writeInt8(this.space-=1,t)}writeInt16(t){this.bb.writeInt16(this.space-=2,t)}writeInt32(t){this.bb.writeInt32(this.space-=4,t)}writeInt64(t){this.bb.writeInt64(this.space-=8,t)}writeFloat32(t){this.bb.writeFloat32(this.space-=4,t)}writeFloat64(t){this.bb.writeFloat64(this.space-=8,t)}addInt8(t){this.prep(1,0),this.writeInt8(t)}addInt16(t){this.prep(2,0),this.writeInt16(t)}addInt32(t){this.prep(4,0),this.writeInt32(t)}addInt64(t){this.prep(8,0),this.writeInt64(t)}addFloat32(t){this.prep(4,0),this.writeFloat32(t)}addFloat64(t){this.prep(8,0),this.writeFloat64(t)}addFieldInt8(t,e,n){(this.force_defaults||e!=n)&&(this.addInt8(e),this.slot(t))}addFieldInt16(t,e,n){(this.force_defaults||e!=n)&&(this.addInt16(e),this.slot(t))}addFieldInt32(t,e,n){(this.force_defaults||e!=n)&&(this.addInt32(e),this.slot(t))}addFieldInt64(t,e,n){(this.force_defaults||!e.equals(n))&&(this.addInt64(e),this.slot(t))}addFieldFloat32(t,e,n){(this.force_defaults||e!=n)&&(this.addFloat32(e),this.slot(t))}addFieldFloat64(t,e,n){(this.force_defaults||e!=n)&&(this.addFloat64(e),this.slot(t))}addFieldOffset(t,e,n){(this.force_defaults||e!=n)&&(this.addOffset(e),this.slot(t))}addFieldStruct(t,e,n){e!=n&&(this.nested(e),this.slot(t))}nested(t){if(t!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")}slot(t){this.vtable!==null&&(this.vtable[t]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(t){let e=t.capacity();if(e&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");let n=e<<1,i=re.allocate(n);return i.setPosition(n-e),i.bytes().set(t.bytes(),n-e),i}addOffset(t){this.prep(4,0),this.writeInt32(this.offset()-t+4)}startObject(t){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=t;for(let e=0;e<t;e++)this.vtable[e]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);let t=this.offset(),e=this.vtable_in_use-1;for(;e>=0&&this.vtable[e]==0;e--);let n=e+1;for(;e>=0;e--)this.addInt16(this.vtable[e]!=0?t-this.vtable[e]:0);let i=2;this.addInt16(t-this.object_start);let s=(n+i)*2;this.addInt16(s);let o=0,a=this.space;t:for(e=0;e<this.vtables.length;e++){let c=this.bb.capacity()-this.vtables[e];if(s==this.bb.readInt16(c)){for(let d=2;d<s;d+=2)if(this.bb.readInt16(a+d)!=this.bb.readInt16(c+d))continue t;o=this.vtables[e];break}}return o?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,o-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t}finish(t,e,n){let i=n?4:0;if(e){let s=e;if(this.prep(this.minalign,4+4+i),s.length!=4)throw new Error("FlatBuffers: file identifier must be length "+4);for(let o=4-1;o>=0;o--)this.writeInt8(s.charCodeAt(o))}this.prep(this.minalign,4+i),this.addOffset(t),i&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(t,e){this.finish(t,e,!0)}requiredField(t,e){let n=this.bb.capacity()-t,i=n-this.bb.readInt32(n);if(!(this.bb.readInt16(i+e)!=0))throw new Error("FlatBuffers: field "+e+" must be set")}startVector(t,e,n){this.notNested(),this.vector_num_elems=e,this.prep(4,t*e),this.prep(n,t*e)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(t){if(!t)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(t))return this.string_maps.get(t);let e=this.createString(t);return this.string_maps.set(t,e),e}createString(t){if(!t)return 0;let e;if(t instanceof Uint8Array)e=t;else{e=[];let n=0;for(;n<t.length;){let i,s=t.charCodeAt(n++);if(s<55296||s>=56320)i=s;else{let o=t.charCodeAt(n++);i=(s<<10)+o+(65536-(55296<<10)-56320)}i<128?e.push(i):(i<2048?e.push(i>>6&31|192):(i<65536?e.push(i>>12&15|224):e.push(i>>18&7|240,i>>12&63|128),e.push(i>>6&63|128)),e.push(i&63|128))}}this.addInt8(0),this.startVector(1,e.length,1),this.bb.setPosition(this.space-=e.length);for(let n=0,i=this.space,s=this.bb.bytes();n<e.length;n++)s[i++]=e[n];return this.endVector()}createLong(t,e){return Ot.create(t,e)}createObjectOffset(t){return t===null?0:typeof t=="string"?this.createString(t):t.pack(this)}createObjectOffsetList(t){let e=[];for(let n=0;n<t.length;++n){let i=t[n];if(i!==null)e.push(this.createObjectOffset(i));else throw new Error("FlatBuffers: Argument for createObjectOffsetList cannot contain null.")}return e}createStructOffsetList(t,e){return e(this,t.length),this.createObjectOffsetList(t),this.endVector()}};var ht=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsKeyValue(t,e){return(e||new ht).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsKeyValue(t,e){return t.setPosition(t.position()+4),(e||new ht).__init(t.readInt32(t.position())+t.position(),t)}key(t){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}value(t){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}static startKeyValue(t){t.startObject(2)}static addKey(t,e){t.addFieldOffset(0,e,0)}static addValue(t,e){t.addFieldOffset(1,e,0)}static endKeyValue(t){return t.endObject()}static createKeyValue(t,e,n){return ht.startKeyValue(t),ht.addKey(t,e),ht.addValue(t,n),ht.endKeyValue(t)}};var jr;(function(r){r[r.V1=0]="V1",r[r.V2=1]="V2",r[r.V3=2]="V3",r[r.V4=3]="V4",r[r.V5=4]="V5"})(jr||(jr={}));var Wr;(function(r){r[r.Little=0]="Little",r[r.Big=1]="Big"})(Wr||(Wr={}));var yi;(function(r){r[r.DenseArray=0]="DenseArray"})(yi||(yi={}));var Ht=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsInt(t,e){return(e||new Ht).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInt(t,e){return t.setPosition(t.position()+4),(e||new Ht).__init(t.readInt32(t.position())+t.position(),t)}bitWidth(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}isSigned(){let t=this.bb.__offset(this.bb_pos,6);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startInt(t){t.startObject(2)}static addBitWidth(t,e){t.addFieldInt32(0,e,0)}static addIsSigned(t,e){t.addFieldInt8(1,+e,0)}static endInt(t){return t.endObject()}static createInt(t,e,n){return Ht.startInt(t),Ht.addBitWidth(t,e),Ht.addIsSigned(t,n),Ht.endInt(t)}};var Te=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDictionaryEncoding(t,e){return(e||new Te).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryEncoding(t,e){return t.setPosition(t.position()+4),(e||new Te).__init(t.readInt32(t.position())+t.position(),t)}id(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}indexType(t){let e=this.bb.__offset(this.bb_pos,6);return e?(t||new Ht).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}isOrdered(){let t=this.bb.__offset(this.bb_pos,8);return t?!!this.bb.readInt8(this.bb_pos+t):!1}dictionaryKind(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt16(this.bb_pos+t):yi.DenseArray}static startDictionaryEncoding(t){t.startObject(4)}static addId(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addIndexType(t,e){t.addFieldOffset(1,e,0)}static addIsOrdered(t,e){t.addFieldInt8(2,+e,0)}static addDictionaryKind(t,e){t.addFieldInt16(3,e,yi.DenseArray)}static endDictionaryEncoding(t){return t.endObject()}};var fr=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBinary(t,e){return(e||new fr).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBinary(t,e){return t.setPosition(t.position()+4),(e||new fr).__init(t.readInt32(t.position())+t.position(),t)}static startBinary(t){t.startObject(0)}static endBinary(t){return t.endObject()}static createBinary(t){return fr.startBinary(t),fr.endBinary(t)}};var hr=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBool(t,e){return(e||new hr).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBool(t,e){return t.setPosition(t.position()+4),(e||new hr).__init(t.readInt32(t.position())+t.position(),t)}static startBool(t){t.startObject(0)}static endBool(t){return t.endObject()}static createBool(t){return hr.startBool(t),hr.endBool(t)}};var _i;(function(r){r[r.DAY=0]="DAY",r[r.MILLISECOND=1]="MILLISECOND"})(_i||(_i={}));var ce=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDate(t,e){return(e||new ce).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDate(t,e){return t.setPosition(t.position()+4),(e||new ce).__init(t.readInt32(t.position())+t.position(),t)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):_i.MILLISECOND}static startDate(t){t.startObject(1)}static addUnit(t,e){t.addFieldInt16(0,e,_i.MILLISECOND)}static endDate(t){return t.endObject()}static createDate(t,e){return ce.startDate(t),ce.addUnit(t,e),ce.endDate(t)}};var zt=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDecimal(t,e){return(e||new zt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDecimal(t,e){return t.setPosition(t.position()+4),(e||new zt).__init(t.readInt32(t.position())+t.position(),t)}precision(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}scale(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):0}bitWidth(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt32(this.bb_pos+t):128}static startDecimal(t){t.startObject(3)}static addPrecision(t,e){t.addFieldInt32(0,e,0)}static addScale(t,e){t.addFieldInt32(1,e,0)}static addBitWidth(t,e){t.addFieldInt32(2,e,128)}static endDecimal(t){return t.endObject()}static createDecimal(t,e,n,i){return zt.startDecimal(t),zt.addPrecision(t,e),zt.addScale(t,n),zt.addBitWidth(t,i),zt.endDecimal(t)}};var Yr;(function(r){r[r.SECOND=0]="SECOND",r[r.MILLISECOND=1]="MILLISECOND",r[r.MICROSECOND=2]="MICROSECOND",r[r.NANOSECOND=3]="NANOSECOND"})(Yr||(Yr={}));var le=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFixedSizeBinary(t,e){return(e||new le).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeBinary(t,e){return t.setPosition(t.position()+4),(e||new le).__init(t.readInt32(t.position())+t.position(),t)}byteWidth(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeBinary(t){t.startObject(1)}static addByteWidth(t,e){t.addFieldInt32(0,e,0)}static endFixedSizeBinary(t){return t.endObject()}static createFixedSizeBinary(t,e){return le.startFixedSizeBinary(t),le.addByteWidth(t,e),le.endFixedSizeBinary(t)}};var ue=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFixedSizeList(t,e){return(e||new ue).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeList(t,e){return t.setPosition(t.position()+4),(e||new ue).__init(t.readInt32(t.position())+t.position(),t)}listSize(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeList(t){t.startObject(1)}static addListSize(t,e){t.addFieldInt32(0,e,0)}static endFixedSizeList(t){return t.endObject()}static createFixedSizeList(t,e){return ue.startFixedSizeList(t),ue.addListSize(t,e),ue.endFixedSizeList(t)}};var bi;(function(r){r[r.HALF=0]="HALF",r[r.SINGLE=1]="SINGLE",r[r.DOUBLE=2]="DOUBLE"})(bi||(bi={}));var de=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFloatingPoint(t,e){return(e||new de).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFloatingPoint(t,e){return t.setPosition(t.position()+4),(e||new de).__init(t.readInt32(t.position())+t.position(),t)}precision(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):bi.HALF}static startFloatingPoint(t){t.startObject(1)}static addPrecision(t,e){t.addFieldInt16(0,e,bi.HALF)}static endFloatingPoint(t){return t.endObject()}static createFloatingPoint(t,e){return de.startFloatingPoint(t),de.addPrecision(t,e),de.endFloatingPoint(t)}};var gi;(function(r){r[r.YEAR_MONTH=0]="YEAR_MONTH",r[r.DAY_TIME=1]="DAY_TIME",r[r.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"})(gi||(gi={}));var fe=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsInterval(t,e){return(e||new fe).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInterval(t,e){return t.setPosition(t.position()+4),(e||new fe).__init(t.readInt32(t.position())+t.position(),t)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):gi.YEAR_MONTH}static startInterval(t){t.startObject(1)}static addUnit(t,e){t.addFieldInt16(0,e,gi.YEAR_MONTH)}static endInterval(t){return t.endObject()}static createInterval(t,e){return fe.startInterval(t),fe.addUnit(t,e),fe.endInterval(t)}};var pr=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsList(t,e){return(e||new pr).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsList(t,e){return t.setPosition(t.position()+4),(e||new pr).__init(t.readInt32(t.position())+t.position(),t)}static startList(t){t.startObject(0)}static endList(t){return t.endObject()}static createList(t){return pr.startList(t),pr.endList(t)}};var he=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsMap(t,e){return(e||new he).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMap(t,e){return t.setPosition(t.position()+4),(e||new he).__init(t.readInt32(t.position())+t.position(),t)}keysSorted(){let t=this.bb.__offset(this.bb_pos,4);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startMap(t){t.startObject(1)}static addKeysSorted(t,e){t.addFieldInt8(0,+e,0)}static endMap(t){return t.endObject()}static createMap(t,e){return he.startMap(t),he.addKeysSorted(t,e),he.endMap(t)}};var mr=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsNull(t,e){return(e||new mr).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsNull(t,e){return t.setPosition(t.position()+4),(e||new mr).__init(t.readInt32(t.position())+t.position(),t)}static startNull(t){t.startObject(0)}static endNull(t){return t.endObject()}static createNull(t){return mr.startNull(t),mr.endNull(t)}};var yr=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsStruct_(t,e){return(e||new yr).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsStruct_(t,e){return t.setPosition(t.position()+4),(e||new yr).__init(t.readInt32(t.position())+t.position(),t)}static startStruct_(t){t.startObject(0)}static endStruct_(t){return t.endObject()}static createStruct_(t){return yr.startStruct_(t),yr.endStruct_(t)}};var Gt=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsTime(t,e){return(e||new Gt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTime(t,e){return t.setPosition(t.position()+4),(e||new Gt).__init(t.readInt32(t.position())+t.position(),t)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Yr.MILLISECOND}bitWidth(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):32}static startTime(t){t.startObject(2)}static addUnit(t,e){t.addFieldInt16(0,e,Yr.MILLISECOND)}static addBitWidth(t,e){t.addFieldInt32(1,e,32)}static endTime(t){return t.endObject()}static createTime(t,e,n){return Gt.startTime(t),Gt.addUnit(t,e),Gt.addBitWidth(t,n),Gt.endTime(t)}};var Kt=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsTimestamp(t,e){return(e||new Kt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTimestamp(t,e){return t.setPosition(t.position()+4),(e||new Kt).__init(t.readInt32(t.position())+t.position(),t)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Yr.SECOND}timezone(t){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}static startTimestamp(t){t.startObject(2)}static addUnit(t,e){t.addFieldInt16(0,e,Yr.SECOND)}static addTimezone(t,e){t.addFieldOffset(1,e,0)}static endTimestamp(t){return t.endObject()}static createTimestamp(t,e,n){return Kt.startTimestamp(t),Kt.addUnit(t,e),Kt.addTimezone(t,n),Kt.endTimestamp(t)}};var wi;(function(r){r[r.Sparse=0]="Sparse",r[r.Dense=1]="Dense"})(wi||(wi={}));var jt=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsUnion(t,e){return(e||new jt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUnion(t,e){return t.setPosition(t.position()+4),(e||new jt).__init(t.readInt32(t.position())+t.position(),t)}mode(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):wi.Sparse}typeIds(t){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt32(this.bb.__vector(this.bb_pos+e)+t*4):0}typeIdsLength(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}typeIdsArray(){let t=this.bb.__offset(this.bb_pos,6);return t?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startUnion(t){t.startObject(2)}static addMode(t,e){t.addFieldInt16(0,e,wi.Sparse)}static addTypeIds(t,e){t.addFieldOffset(1,e,0)}static createTypeIdsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addInt32(e[n]);return t.endVector()}static startTypeIdsVector(t,e){t.startVector(4,e,4)}static endUnion(t){return t.endObject()}static createUnion(t,e,n){return jt.startUnion(t),jt.addMode(t,e),jt.addTypeIds(t,n),jt.endUnion(t)}};var _r=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsUtf8(t,e){return(e||new _r).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUtf8(t,e){return t.setPosition(t.position()+4),(e||new _r).__init(t.readInt32(t.position())+t.position(),t)}static startUtf8(t){t.startObject(0)}static endUtf8(t){return t.endObject()}static createUtf8(t){return _r.startUtf8(t),_r.endUtf8(t)}};var pt;(function(r){r[r.NONE=0]="NONE",r[r.Null=1]="Null",r[r.Int=2]="Int",r[r.FloatingPoint=3]="FloatingPoint",r[r.Binary=4]="Binary",r[r.Utf8=5]="Utf8",r[r.Bool=6]="Bool",r[r.Decimal=7]="Decimal",r[r.Date=8]="Date",r[r.Time=9]="Time",r[r.Timestamp=10]="Timestamp",r[r.Interval=11]="Interval",r[r.List=12]="List",r[r.Struct_=13]="Struct_",r[r.Union=14]="Union",r[r.FixedSizeBinary=15]="FixedSizeBinary",r[r.FixedSizeList=16]="FixedSizeList",r[r.Map=17]="Map",r[r.Duration=18]="Duration",r[r.LargeBinary=19]="LargeBinary",r[r.LargeUtf8=20]="LargeUtf8",r[r.LargeList=21]="LargeList"})(pt||(pt={}));var Mt=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsField(t,e){return(e||new Mt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsField(t,e){return t.setPosition(t.position()+4),(e||new Mt).__init(t.readInt32(t.position())+t.position(),t)}name(t){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}nullable(){let t=this.bb.__offset(this.bb_pos,6);return t?!!this.bb.readInt8(this.bb_pos+t):!1}typeType(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint8(this.bb_pos+t):pt.NONE}type(t){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__union(t,this.bb_pos+e):null}dictionary(t){let e=this.bb.__offset(this.bb_pos,12);return e?(t||new Te).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}children(t,e){let n=this.bb.__offset(this.bb_pos,14);return n?(e||new Mt).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}childrenLength(){let t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){let n=this.bb.__offset(this.bb_pos,16);return n?(e||new ht).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}customMetadataLength(){let t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__vector_len(this.bb_pos+t):0}static startField(t){t.startObject(7)}static addName(t,e){t.addFieldOffset(0,e,0)}static addNullable(t,e){t.addFieldInt8(1,+e,0)}static addTypeType(t,e){t.addFieldInt8(2,e,pt.NONE)}static addType(t,e){t.addFieldOffset(3,e,0)}static addDictionary(t,e){t.addFieldOffset(4,e,0)}static addChildren(t,e){t.addFieldOffset(5,e,0)}static createChildrenVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startChildrenVector(t,e){t.startVector(4,e,4)}static addCustomMetadata(t,e){t.addFieldOffset(6,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endField(t){return t.endObject()}};var wt=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsSchema(t,e){return(e||new wt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsSchema(t,e){return t.setPosition(t.position()+4),(e||new wt).__init(t.readInt32(t.position())+t.position(),t)}endianness(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Wr.Little}fields(t,e){let n=this.bb.__offset(this.bb_pos,6);return n?(e||new Mt).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}fieldsLength(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){let n=this.bb.__offset(this.bb_pos,8);return n?(e||new ht).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}customMetadataLength(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}features(t){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt64(this.bb.__vector(this.bb_pos+e)+t*8):this.bb.createLong(0,0)}featuresLength(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}static startSchema(t){t.startObject(4)}static addEndianness(t,e){t.addFieldInt16(0,e,Wr.Little)}static addFields(t,e){t.addFieldOffset(1,e,0)}static createFieldsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startFieldsVector(t,e){t.startVector(4,e,4)}static addCustomMetadata(t,e){t.addFieldOffset(2,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static addFeatures(t,e){t.addFieldOffset(3,e,0)}static createFeaturesVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addInt64(e[n]);return t.endVector()}static startFeaturesVector(t,e){t.startVector(8,e,8)}static endSchema(t){return t.endObject()}static finishSchemaBuffer(t,e){t.finish(e)}static finishSizePrefixedSchemaBuffer(t,e){t.finish(e,void 0,!0)}static createSchema(t,e,n,i,s){return wt.startSchema(t),wt.addEndianness(t,e),wt.addFields(t,n),wt.addCustomMetadata(t,i),wt.addFeatures(t,s),wt.endSchema(t)}};var Jt=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFooter(t,e){return(e||new Jt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFooter(t,e){return t.setPosition(t.position()+4),(e||new Jt).__init(t.readInt32(t.position())+t.position(),t)}version(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):jr.V1}schema(t){let e=this.bb.__offset(this.bb_pos,6);return e?(t||new wt).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}dictionaries(t,e){let n=this.bb.__offset(this.bb_pos,8);return n?(e||new Mn).__init(this.bb.__vector(this.bb_pos+n)+t*24,this.bb):null}dictionariesLength(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}recordBatches(t,e){let n=this.bb.__offset(this.bb_pos,10);return n?(e||new Mn).__init(this.bb.__vector(this.bb_pos+n)+t*24,this.bb):null}recordBatchesLength(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){let n=this.bb.__offset(this.bb_pos,12);return n?(e||new ht).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}customMetadataLength(){let t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startFooter(t){t.startObject(5)}static addVersion(t,e){t.addFieldInt16(0,e,jr.V1)}static addSchema(t,e){t.addFieldOffset(1,e,0)}static addDictionaries(t,e){t.addFieldOffset(2,e,0)}static startDictionariesVector(t,e){t.startVector(24,e,8)}static addRecordBatches(t,e){t.addFieldOffset(3,e,0)}static startRecordBatchesVector(t,e){t.startVector(24,e,8)}static addCustomMetadata(t,e){t.addFieldOffset(4,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endFooter(t){return t.endObject()}static finishFooterBuffer(t,e){t.finish(e)}static finishSizePrefixedFooterBuffer(t,e){t.finish(e,void 0,!0)}};var J=class{constructor(t=[],e,n){this.fields=t||[],this.metadata=e||new Map,n||(n=aa(t)),this.dictionaries=n}get[Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map(t=>t.name)}toString(){return`Schema<{ ${this.fields.map((t,e)=>`${e}: ${t}`).join(", ")} }>`}select(t){let e=new Set(t),n=this.fields.filter(i=>e.has(i.name));return new J(n,this.metadata)}selectAt(t){let e=t.map(n=>this.fields[n]).filter(Boolean);return new J(e,this.metadata)}assign(...t){let e=t[0]instanceof J?t[0]:Array.isArray(t[0])?new J(t[0]):new J(t),n=[...this.fields],i=Os(Os(new Map,this.metadata),e.metadata),s=e.fields.filter(a=>{let c=n.findIndex(d=>d.name===a.name);return~c?(n[c]=a.clone({metadata:Os(Os(new Map,n[c].metadata),a.metadata)}))&&!1:!0}),o=aa(s,new Map);return new J([...n,...s],i,new Map([...this.dictionaries,...o]))}};J.prototype.fields=null;J.prototype.metadata=null;J.prototype.dictionaries=null;var z=class{constructor(t,e,n=!1,i){this.name=t,this.type=e,this.nullable=n,this.metadata=i||new Map}static new(...t){let[e,n,i,s]=t;return t[0]&&typeof t[0]=="object"&&({name:e}=t[0],n===void 0&&(n=t[0].type),i===void 0&&(i=t[0].nullable),s===void 0&&(s=t[0].metadata)),new z(`${e}`,n,i,s)}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...t){let[e,n,i,s]=t;return!t[0]||typeof t[0]!="object"?[e=this.name,n=this.type,i=this.nullable,s=this.metadata]=t:{name:e=this.name,type:n=this.type,nullable:i=this.nullable,metadata:s=this.metadata}=t[0],z.new(e,n,i,s)}};z.prototype.type=null;z.prototype.name=null;z.prototype.nullable=null;z.prototype.metadata=null;function Os(r,t){return new Map([...r||new Map,...t||new Map])}function aa(r,t=new Map){for(let e=-1,n=r.length;++e<n;){let s=r[e].type;if(A.isDictionary(s)){if(!t.has(s.id))t.set(s.id,s.dictionary);else if(t.get(s.id)!==s.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}s.children&&s.children.length>0&&aa(s.children,t)}return t}var uu=Ot,Em=zr,Om=re,$r=class{constructor(t,e=kt.V4,n,i){this.schema=t,this.version=e,n&&(this._recordBatches=n),i&&(this._dictionaryBatches=i)}static decode(t){t=new Om(O(t));let e=Jt.getRootAsFooter(t),n=J.decode(e.schema());return new du(n,e)}static encode(t){let e=new Em,n=J.encode(e,t.schema);Jt.startRecordBatchesVector(e,t.numRecordBatches);for(let o of[...t.recordBatches()].slice().reverse())er.encode(e,o);let i=e.endVector();Jt.startDictionariesVector(e,t.numDictionaries);for(let o of[...t.dictionaryBatches()].slice().reverse())er.encode(e,o);let s=e.endVector();return Jt.startFooter(e),Jt.addSchema(e,n),Jt.addVersion(e,kt.V4),Jt.addRecordBatches(e,i),Jt.addDictionaries(e,s),Jt.finishFooterBuffer(e,Jt.endFooter(e)),e.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}*recordBatches(){for(let t,e=-1,n=this.numRecordBatches;++e<n;)(t=this.getRecordBatch(e))&&(yield t)}*dictionaryBatches(){for(let t,e=-1,n=this.numDictionaries;++e<n;)(t=this.getDictionaryBatch(e))&&(yield t)}getRecordBatch(t){return t>=0&&t<this.numRecordBatches&&this._recordBatches[t]||null}getDictionaryBatch(t){return t>=0&&t<this.numDictionaries&&this._dictionaryBatches[t]||null}};var du=class extends $r{constructor(t,e){super(t,e.version());this._footer=e}get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}getRecordBatch(t){if(t>=0&&t<this.numRecordBatches){let e=this._footer.recordBatches(t);if(e)return er.decode(e)}return null}getDictionaryBatch(t){if(t>=0&&t<this.numDictionaries){let e=this._footer.dictionaries(t);if(e)return er.decode(e)}return null}},er=class{constructor(t,e,n){this.metaDataLength=t,this.offset=typeof n=="number"?n:n.low,this.bodyLength=typeof e=="number"?e:e.low}static decode(t){return new er(t.metaDataLength(),t.bodyLength(),t.offset())}static encode(t,e){let{metaDataLength:n}=e,i=new uu(e.offset,0),s=new uu(e.bodyLength,0);return Mn.createBlock(t,i,n,s)}};var at=Object.freeze({done:!0,value:void 0}),Ms=class{constructor(t){this._json=t}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}},Un=class{tee(){return this._getDOMStream().tee()}pipe(t,e){return this._getNodeStream().pipe(t,e)}pipeTo(t,e){return this._getDOMStream().pipeTo(t,e)}pipeThrough(t,e){return this._getDOMStream().pipeThrough(t,e)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}},ca=class extends Un{constructor(){super();this._values=[],this.resolvers=[],this._closedPromise=new Promise(t=>this._closedPromiseResolve=t)}get closed(){return this._closedPromise}cancel(t){return I(this,void 0,void 0,function*(){yield this.return(t)})}write(t){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(t):this.resolvers.shift().resolve({done:!1,value:t}))}abort(t){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:t}:this.resolvers.shift().reject({done:!0,value:t}))}close(){if(this._closedPromiseResolve){let{resolvers:t}=this;for(;t.length>0;)t.shift().resolve(at);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(t){return Lt.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,t)}toNodeStream(t){return Lt.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,t)}throw(t){return I(this,void 0,void 0,function*(){return yield this.abort(t),at})}return(t){return I(this,void 0,void 0,function*(){return yield this.close(),at})}read(t){return I(this,void 0,void 0,function*(){return(yield this.next(t,"read")).value})}peek(t){return I(this,void 0,void 0,function*(){return(yield this.next(t,"peek")).value})}next(...t){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise((e,n)=>{this.resolvers.push({resolve:e,reject:n})}):Promise.resolve(at)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error("AsyncQueue is closed")}};var br=class extends ca{write(t){if((t=O(t)).byteLength>0)return super.write(t)}toString(t=!1){return t?ri(this.toUint8Array(!0)):this.toUint8Array(!1).then(ri)}toUint8Array(t=!1){return t?se(this._values)[0]:(()=>I(this,void 0,void 0,function*(){var e,n;let i=[],s=0;try{for(var o=Se(this),a;a=yield o.next(),!a.done;){let c=a.value;i.push(c),s+=c.byteLength}}catch(c){e={error:c}}finally{try{a&&!a.done&&(n=o.return)&&(yield n.call(o))}finally{if(e)throw e.error}}return se(i,s)[0]}))()}},gr=class{constructor(t){t&&(this.source=new fu(Lt.fromIterable(t)))}[Symbol.iterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}},pe=class{constructor(t){t instanceof pe?this.source=t.source:t instanceof br?this.source=new Xr(Lt.fromAsyncIterable(t)):ns(t)?this.source=new Xr(Lt.fromNodeStream(t)):si(t)?this.source=new Xr(Lt.fromDOMStream(t)):es(t)?this.source=new Xr(Lt.fromDOMStream(t.body)):Ue(t)?this.source=new Xr(Lt.fromIterable(t)):Re(t)?this.source=new Xr(Lt.fromAsyncIterable(t)):Ie(t)&&(this.source=new Xr(Lt.fromAsyncIterable(t)))}[Symbol.asyncIterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}get closed(){return this.source.closed}cancel(t){return this.source.cancel(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}},fu=class{constructor(t){this.source=t}cancel(t){this.return(t)}peek(t){return this.next(t,"peek").value}read(t){return this.next(t,"read").value}next(t,e="read"){return this.source.next({cmd:e,size:t})}throw(t){return Object.create(this.source.throw&&this.source.throw(t)||at)}return(t){return Object.create(this.source.return&&this.source.return(t)||at)}},Xr=class{constructor(t){this.source=t,this._closedPromise=new Promise(e=>this._closedPromiseResolve=e)}cancel(t){return I(this,void 0,void 0,function*(){yield this.return(t)})}get closed(){return this._closedPromise}read(t){return I(this,void 0,void 0,function*(){return(yield this.next(t,"read")).value})}peek(t){return I(this,void 0,void 0,function*(){return(yield this.next(t,"peek")).value})}next(t,e="read"){return I(this,void 0,void 0,function*(){return yield this.source.next({cmd:e,size:t})})}throw(t){return I(this,void 0,void 0,function*(){let e=this.source.throw&&(yield this.source.throw(t))||at;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(e)})}return(t){return I(this,void 0,void 0,function*(){let e=this.source.return&&(yield this.source.return(t))||at;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(e)})}};var Rs=class extends gr{constructor(t,e){super();this.position=0,this.buffer=O(t),this.size=typeof e>"u"?this.buffer.byteLength:e}readInt32(t){let{buffer:e,byteOffset:n}=this.readAt(t,4);return new DataView(e,n).getInt32(0,!0)}seek(t){return this.position=Math.min(t,this.size),t<this.size}read(t){let{buffer:e,size:n,position:i}=this;return e&&i<n?(typeof t!="number"&&(t=Number.POSITIVE_INFINITY),this.position=Math.min(n,i+Math.min(n-i,t)),e.subarray(i,this.position)):null}readAt(t,e){let n=this.buffer,i=Math.min(this.size,t+e);return n?n.subarray(t,i):new Uint8Array(e)}close(){this.buffer&&(this.buffer=null)}throw(t){return this.close(),{done:!0,value:t}}return(t){return this.close(),{done:!0,value:t}}},un=class extends pe{constructor(t,e){super();this.position=0,this._handle=t,typeof e=="number"?this.size=e:this._pending=(()=>I(this,void 0,void 0,function*(){this.size=(yield t.stat()).size,delete this._pending}))()}readInt32(t){return I(this,void 0,void 0,function*(){let{buffer:e,byteOffset:n}=yield this.readAt(t,4);return new DataView(e,n).getInt32(0,!0)})}seek(t){return I(this,void 0,void 0,function*(){return this._pending&&(yield this._pending),this.position=Math.min(t,this.size),t<this.size})}read(t){return I(this,void 0,void 0,function*(){this._pending&&(yield this._pending);let{_handle:e,size:n,position:i}=this;if(e&&i<n){typeof t!="number"&&(t=Number.POSITIVE_INFINITY);let s=i,o=0,a=0,c=Math.min(n,s+Math.min(n-s,t)),d=new Uint8Array(Math.max(0,(this.position=c)-s));for(;(s+=a)<c&&(o+=a)<d.byteLength;)({bytesRead:a}=yield e.read(d,o,d.byteLength-o,s));return d}return null})}readAt(t,e){return I(this,void 0,void 0,function*(){this._pending&&(yield this._pending);let{_handle:n,size:i}=this;if(n&&t+e<i){let s=Math.min(i,t+e),o=new Uint8Array(s-t);return(yield n.read(o,0,e,t)).buffer}return new Uint8Array(e)})}close(){return I(this,void 0,void 0,function*(){let t=this._handle;this._handle=null,t&&(yield t.close())})}throw(t){return I(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:t}})}return(t){return I(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:t}})}};var ua={};nn(ua,{BaseInt64:()=>Us,Int128:()=>me,Int64:()=>Wt,Uint64:()=>tt});function Nn(r){return r<0&&(r=4294967295+r+1),`0x${r.toString(16)}`}var kn=8,la=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8],Us=class{constructor(t){this.buffer=t}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(t){let e=new Uint32Array([this.buffer[1]>>>16,this.buffer[1]&65535,this.buffer[0]>>>16,this.buffer[0]&65535]),n=new Uint32Array([t.buffer[1]>>>16,t.buffer[1]&65535,t.buffer[0]>>>16,t.buffer[0]&65535]),i=e[3]*n[3];this.buffer[0]=i&65535;let s=i>>>16;return i=e[2]*n[3],s+=i,i=e[3]*n[2]>>>0,s+=i,this.buffer[0]+=s<<16,this.buffer[1]=s>>>0<i?65536:0,this.buffer[1]+=s>>>16,this.buffer[1]+=e[1]*n[3]+e[2]*n[2]+e[3]*n[1],this.buffer[1]+=e[0]*n[3]+e[1]*n[2]+e[2]*n[1]+e[3]*n[0]<<16,this}_plus(t){let e=this.buffer[0]+t.buffer[0]>>>0;this.buffer[1]+=t.buffer[1],e<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=e}lessThan(t){return this.buffer[1]<t.buffer[1]||this.buffer[1]===t.buffer[1]&&this.buffer[0]<t.buffer[0]}equals(t){return this.buffer[1]===t.buffer[1]&&this.buffer[0]==t.buffer[0]}greaterThan(t){return t.lessThan(this)}hex(){return`${Nn(this.buffer[1])} ${Nn(this.buffer[0])}`}},tt=class extends Us{times(t){return this._times(t),this}plus(t){return this._plus(t),this}static from(t,e=new Uint32Array(2)){return tt.fromString(typeof t=="string"?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(2)){return tt.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(2)){let n=t.length,i=new tt(e);for(let s=0;s<n;){let o=kn<n-s?kn:n-s,a=new tt(new Uint32Array([Number.parseInt(t.slice(s,s+o),10),0])),c=new tt(new Uint32Array([la[o],0]));i.times(c),i.plus(a),s+=o}return i}static convertArray(t){let e=new Uint32Array(t.length*2);for(let n=-1,i=t.length;++n<i;)tt.from(t[n],new Uint32Array(e.buffer,e.byteOffset+2*n*4,2));return e}static multiply(t,e){return new tt(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new tt(new Uint32Array(t.buffer)).plus(e)}},Wt=class extends Us{negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[0]==0&&++this.buffer[1],this}times(t){return this._times(t),this}plus(t){return this._plus(t),this}lessThan(t){let e=this.buffer[1]<<0,n=t.buffer[1]<<0;return e<n||e===n&&this.buffer[0]<t.buffer[0]}static from(t,e=new Uint32Array(2)){return Wt.fromString(typeof t=="string"?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(2)){return Wt.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(2)){let n=t.startsWith("-"),i=t.length,s=new Wt(e);for(let o=n?1:0;o<i;){let a=kn<i-o?kn:i-o,c=new Wt(new Uint32Array([Number.parseInt(t.slice(o,o+a),10),0])),d=new Wt(new Uint32Array([la[a],0]));s.times(d),s.plus(c),o+=a}return n?s.negate():s}static convertArray(t){let e=new Uint32Array(t.length*2);for(let n=-1,i=t.length;++n<i;)Wt.from(t[n],new Uint32Array(e.buffer,e.byteOffset+2*n*4,2));return e}static multiply(t,e){return new Wt(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new Wt(new Uint32Array(t.buffer)).plus(e)}},me=class{constructor(t){this.buffer=t}high(){return new Wt(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new Wt(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],this.buffer[0]==0&&++this.buffer[1],this.buffer[1]==0&&++this.buffer[2],this.buffer[2]==0&&++this.buffer[3],this}times(t){let e=new tt(new Uint32Array([this.buffer[3],0])),n=new tt(new Uint32Array([this.buffer[2],0])),i=new tt(new Uint32Array([this.buffer[1],0])),s=new tt(new Uint32Array([this.buffer[0],0])),o=new tt(new Uint32Array([t.buffer[3],0])),a=new tt(new Uint32Array([t.buffer[2],0])),c=new tt(new Uint32Array([t.buffer[1],0])),d=new tt(new Uint32Array([t.buffer[0],0])),p=tt.multiply(s,d);this.buffer[0]=p.low();let _=new tt(new Uint32Array([p.high(),0]));return p=tt.multiply(i,d),_.plus(p),p=tt.multiply(s,c),_.plus(p),this.buffer[1]=_.low(),this.buffer[3]=_.lessThan(p)?1:0,this.buffer[2]=_.high(),new tt(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(tt.multiply(n,d)).plus(tt.multiply(i,c)).plus(tt.multiply(s,a)),this.buffer[3]+=tt.multiply(e,d).plus(tt.multiply(n,c)).plus(tt.multiply(i,a)).plus(tt.multiply(s,o)).low(),this}plus(t){let e=new Uint32Array(4);return e[3]=this.buffer[3]+t.buffer[3]>>>0,e[2]=this.buffer[2]+t.buffer[2]>>>0,e[1]=this.buffer[1]+t.buffer[1]>>>0,e[0]=this.buffer[0]+t.buffer[0]>>>0,e[0]<this.buffer[0]>>>0&&++e[1],e[1]<this.buffer[1]>>>0&&++e[2],e[2]<this.buffer[2]>>>0&&++e[3],this.buffer[3]=e[3],this.buffer[2]=e[2],this.buffer[1]=e[1],this.buffer[0]=e[0],this}hex(){return`${Nn(this.buffer[3])} ${Nn(this.buffer[2])} ${Nn(this.buffer[1])} ${Nn(this.buffer[0])}`}static multiply(t,e){return new me(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new me(new Uint32Array(t.buffer)).plus(e)}static from(t,e=new Uint32Array(4)){return me.fromString(typeof t=="string"?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(4)){return me.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(4)){let n=t.startsWith("-"),i=t.length,s=new me(e);for(let o=n?1:0;o<i;){let a=kn<i-o?kn:i-o,c=new me(new Uint32Array([Number.parseInt(t.slice(o,o+a),10),0,0,0])),d=new me(new Uint32Array([la[a],0,0,0]));s.times(d),s.plus(c),o+=a}return n?s.negate():s}static convertArray(t){let e=new Uint32Array(t.length*4);for(let n=-1,i=t.length;++n<i;)me.from(t[n],new Uint32Array(e.buffer,e.byteOffset+4*4*n,4));return e}};var Ns=class extends E{constructor(t,e,n,i){super();this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=t,this.nodes=e,this.buffers=n,this.dictionaries=i}visit(t){return super.visit(t instanceof z?t.type:t)}visitNull(t,{length:e}=this.nextFieldNode()){return C({type:t,length:e})}visitBool(t,{length:e,nullCount:n}=this.nextFieldNode()){return C({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitInt(t,{length:e,nullCount:n}=this.nextFieldNode()){return C({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitFloat(t,{length:e,nullCount:n}=this.nextFieldNode()){return C({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitUtf8(t,{length:e,nullCount:n}=this.nextFieldNode()){return C({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitBinary(t,{length:e,nullCount:n}=this.nextFieldNode()){return C({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitFixedSizeBinary(t,{length:e,nullCount:n}=this.nextFieldNode()){return C({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitDate(t,{length:e,nullCount:n}=this.nextFieldNode()){return C({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitTimestamp(t,{length:e,nullCount:n}=this.nextFieldNode()){return C({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitTime(t,{length:e,nullCount:n}=this.nextFieldNode()){return C({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitDecimal(t,{length:e,nullCount:n}=this.nextFieldNode()){return C({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitList(t,{length:e,nullCount:n}=this.nextFieldNode()){return C({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}visitStruct(t,{length:e,nullCount:n}=this.nextFieldNode()){return C({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),children:this.visitMany(t.children)})}visitUnion(t){return t.mode===bt.Sparse?this.visitSparseUnion(t):this.visitDenseUnion(t)}visitDenseUnion(t,{length:e,nullCount:n}=this.nextFieldNode()){return C({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),typeIds:this.readTypeIds(t),valueOffsets:this.readOffsets(t),children:this.visitMany(t.children)})}visitSparseUnion(t,{length:e,nullCount:n}=this.nextFieldNode()){return C({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),typeIds:this.readTypeIds(t),children:this.visitMany(t.children)})}visitDictionary(t,{length:e,nullCount:n}=this.nextFieldNode()){return C({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t.indices),dictionary:this.readDictionary(t)})}visitInterval(t,{length:e,nullCount:n}=this.nextFieldNode()){return C({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitFixedSizeList(t,{length:e,nullCount:n}=this.nextFieldNode()){return C({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),child:this.visit(t.children[0])})}visitMap(t,{length:e,nullCount:n}=this.nextFieldNode()){return C({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(t,e,n=this.nextBufferRange()){return e>0&&this.readData(t,n)||new Uint8Array(0)}readOffsets(t,e){return this.readData(t,e)}readTypeIds(t,e){return this.readData(t,e)}readData(t,{length:e,offset:n}=this.nextBufferRange()){return this.bytes.subarray(n,n+e)}readDictionary(t){return this.dictionaries.get(t.id)}},da=class extends Ns{constructor(t,e,n,i){super(new Uint8Array(0),e,n,i);this.sources=t}readNullBitmap(t,e,{offset:n}=this.nextBufferRange()){return e<=0?new Uint8Array(0):an(this.sources[n])}readOffsets(t,{offset:e}=this.nextBufferRange()){return W(Uint8Array,W(Int32Array,this.sources[e]))}readTypeIds(t,{offset:e}=this.nextBufferRange()){return W(Uint8Array,W(t.ArrayType,this.sources[e]))}readData(t,{offset:e}=this.nextBufferRange()){let{sources:n}=this;return A.isTimestamp(t)?W(Uint8Array,Wt.convertArray(n[e])):(A.isInt(t)||A.isTime(t))&&t.bitWidth===64?W(Uint8Array,Wt.convertArray(n[e])):A.isDate(t)&&t.unit===Ct.MILLISECOND?W(Uint8Array,Wt.convertArray(n[e])):A.isDecimal(t)?W(Uint8Array,me.convertArray(n[e])):A.isBinary(t)||A.isFixedSizeBinary(t)?Mm(n[e]):A.isBool(t)?an(n[e]):A.isUtf8(t)?Tr(n[e].join("")):W(Uint8Array,W(t.ArrayType,n[e].map(i=>+i)))}};function Mm(r){let t=r.join(""),e=new Uint8Array(t.length/2);for(let n=0;n<t.length;n+=2)e[n>>1]=Number.parseInt(t.slice(n,n+2),16);return e}var vi=class extends dr{constructor(t){super(t);this._values=new ln(new Uint8Array(0))}get byteLength(){let t=this._pendingLength+this.length*4;return this._offsets&&(t+=this._offsets.byteLength),this._values&&(t+=this._values.byteLength),this._nulls&&(t+=this._nulls.byteLength),t}setValue(t,e){return super.setValue(t,O(e))}_flushPending(t,e){let n=this._offsets,i=this._values.reserve(e).buffer,s=0;for(let[o,a]of t)if(a===void 0)n.set(o,0);else{let c=a.length;i.set(a,s),n.set(o,c),s+=c}}};var fa=class extends _t{constructor(t){super(t);this._values=new hi}setValue(t,e){this._values.set(t,+e)}};var Ln=class extends Vt{};Ln.prototype._setValue=Jo;var ks=class extends Ln{};ks.prototype._setValue=as;var Ls=class extends Ln{};Ls.prototype._setValue=cs;var Cs=class extends Vt{};Cs.prototype._setValue=Qo;var ha=class extends _t{constructor({type:t,nullValues:e,dictionaryHashFunction:n}){super({type:new Fe(t.dictionary,t.indices,t.id,t.isOrdered)});this._nulls=null,this._dictionaryOffset=0,this._keysToIndices=Object.create(null),this.indices=dn({type:this.type.indices,nullValues:e}),this.dictionary=dn({type:this.type.dictionary,nullValues:null}),typeof n=="function"&&(this.valueToKey=n)}get values(){return this.indices.values}get nullCount(){return this.indices.nullCount}get nullBitmap(){return this.indices.nullBitmap}get byteLength(){return this.indices.byteLength+this.dictionary.byteLength}get reservedLength(){return this.indices.reservedLength+this.dictionary.reservedLength}get reservedByteLength(){return this.indices.reservedByteLength+this.dictionary.reservedByteLength}isValid(t){return this.indices.isValid(t)}setValid(t,e){let n=this.indices;return e=n.setValid(t,e),this.length=n.length,e}setValue(t,e){let n=this._keysToIndices,i=this.valueToKey(e),s=n[i];return s===void 0&&(n[i]=s=this._dictionaryOffset+this.dictionary.append(e).length-1),this.indices.setValue(t,s)}flush(){let t=this.type,e=this._dictionary,n=this.dictionary.toVector(),i=this.indices.flush().clone(t);return i.dictionary=e?e.concat(n):n,this.finished||(this._dictionaryOffset+=n.length),this._dictionary=i.dictionary,this.clear(),i}finish(){return this.indices.finish(),this.dictionary.finish(),this._dictionaryOffset=0,this._keysToIndices=Object.create(null),super.finish()}clear(){return this.indices.clear(),this.dictionary.clear(),super.clear()}valueToKey(t){return typeof t=="string"?t:`${t}`}};var Ps=class extends Vt{};Ps.prototype._setValue=Ko;var pa=class extends _t{setValue(t,e){let[n]=this.children,i=t*this.stride;for(let s=-1,o=e.length;++s<o;)n.set(i+s,e[s])}addChild(t,e="0"){if(this.numChildren>0)throw new Error("FixedSizeListBuilder can only have one child.");let n=this.children.push(t);return this.type=new Ze(this.type.listSize,new z(e,t.type,!0)),n}};var Cn=class extends Vt{setValue(t,e){this._values.set(t,e)}},ma=class extends Cn{setValue(t,e){super.setValue(t,ci(e))}},ya=class extends Cn{},_a=class extends Cn{};var Pn=class extends Vt{};Pn.prototype._setValue=ta;var Vs=class extends Pn{};Vs.prototype._setValue=_s;var Hs=class extends Pn{};Hs.prototype._setValue=bs;var He=class extends Vt{setValue(t,e){this._values.set(t,e)}},ba=class extends He{},ga=class extends He{},wa=class extends He{},va=class extends He{},Sa=class extends He{},Ia=class extends He{},Ba=class extends He{},Fa=class extends He{};var Aa=class extends dr{constructor(t){super(t);this._offsets=new pi}addChild(t,e="0"){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=t,this.type=new Je(new z(e,t.type,!0)),this.numChildren-1}_flushPending(t){let e=this._offsets,[n]=this.children;for(let[i,s]of t)if(s===void 0)e.set(i,0);else{let o=s.length,a=e.set(i,o).buffer[i];for(let c=-1;++c<o;)n.set(a+c,s[c])}}};var xa=class extends dr{set(t,e){return super.set(t,e)}setValue(t,e){let n=e instanceof Map?e:new Map(Object.entries(e)),i=this._pending||(this._pending=new Map),s=i.get(t);s&&(this._pendingLength-=s.size),this._pendingLength+=n.size,i.set(t,n)}addChild(t,e=`${this.numChildren}`){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=t,this.type=new Qe(new z(e,t.type,!0),this.type.keysSorted),this.numChildren-1}_flushPending(t){let e=this._offsets,[n]=this.children;for(let[i,s]of t)if(s===void 0)e.set(i,0);else{let{[i]:o,[i+1]:a}=e.set(i,s.size).buffer;for(let c of s.entries())if(n.set(o,c),++o>=a)break}}};var Ta=class extends _t{setValue(t,e){}setValid(t,e){return this.length=Math.max(t+1,this.length),e}};var Da=class extends _t{setValue(t,e){let n=this.children;switch(Array.isArray(e)||e.constructor){case!0:return this.type.children.forEach((i,s)=>n[s].set(t,e[s]));case Map:return this.type.children.forEach((i,s)=>n[s].set(t,e.get(i.name)));default:return this.type.children.forEach((i,s)=>n[s].set(t,e[i.name]))}}addChild(t,e=`${this.numChildren}`){let n=this.children.push(t);return this.type=new ft([...this.type.children,new z(e,t.type,!0)]),n}};var Gr=class extends Vt{};Gr.prototype._setValue=qo;var zs=class extends Gr{};zs.prototype._setValue=ls;var js=class extends Gr{};js.prototype._setValue=us;var Ws=class extends Gr{};Ws.prototype._setValue=ds;var Ys=class extends Gr{};Ys.prototype._setValue=fs;var Kr=class extends Vt{};Kr.prototype._setValue=Zo;var $s=class extends Kr{};$s.prototype._setValue=hs;var Xs=class extends Kr{};Xs.prototype._setValue=ps;var Gs=class extends Kr{};Gs.prototype._setValue=ms;var Ks=class extends Kr{};Ks.prototype._setValue=ys;var Si=class extends _t{constructor(t){super(t);this._typeIds=new Hr(new Int8Array(0),1),typeof t.valueToChildTypeId=="function"&&(this._valueToChildTypeId=t.valueToChildTypeId)}get typeIdToChildIndex(){return this.type.typeIdToChildIndex}append(t,e){return this.set(this.length,t,e)}set(t,e,n){return n===void 0&&(n=this._valueToChildTypeId(this,e,t)),this.setValid(t,this.isValid(e))&&this.setValue(t,e,n),this}setValue(t,e,n){this._typeIds.set(t,n);let i=this.type.typeIdToChildIndex[n],s=this.children[i];s==null||s.set(t,e)}addChild(t,e=`${this.children.length}`){let n=this.children.push(t),{type:{children:i,mode:s,typeIds:o}}=this,a=[...i,new z(e,t.type)];return this.type=new qe(s,[...o,n],a),n}_valueToChildTypeId(t,e,n){throw new Error("Cannot map UnionBuilder value to child typeId. Pass the `childTypeId` as the second argument to unionBuilder.append(), or supply a `valueToChildTypeId` function as part of the UnionBuilder constructor options.")}},Ea=class extends Si{},Oa=class extends Si{constructor(t){super(t);this._offsets=new Hr(new Int32Array(0))}setValue(t,e,n){let i=this._typeIds.set(t,n).buffer[t],s=this.getChildAt(this.type.typeIdToChildIndex[i]),o=this._offsets.set(t,s.length).buffer[t];s==null||s.set(o,e)}};var Js=class extends dr{constructor(t){super(t);this._values=new ln(new Uint8Array(0))}get byteLength(){let t=this._pendingLength+this.length*4;return this._offsets&&(t+=this._offsets.byteLength),this._values&&(t+=this._values.byteLength),this._nulls&&(t+=this._nulls.byteLength),t}setValue(t,e){return super.setValue(t,Tr(e))}_flushPending(t,e){}};Js.prototype._flushPending=vi.prototype._flushPending;var hu=class extends E{visitNull(){return Ta}visitBool(){return fa}visitInt(){return He}visitInt8(){return ba}visitInt16(){return ga}visitInt32(){return wa}visitInt64(){return va}visitUint8(){return Sa}visitUint16(){return Ia}visitUint32(){return Ba}visitUint64(){return Fa}visitFloat(){return Cn}visitFloat16(){return ma}visitFloat32(){return ya}visitFloat64(){return _a}visitUtf8(){return Js}visitBinary(){return vi}visitFixedSizeBinary(){return Ps}visitDate(){return Ln}visitDateDay(){return ks}visitDateMillisecond(){return Ls}visitTimestamp(){return Gr}visitTimestampSecond(){return zs}visitTimestampMillisecond(){return js}visitTimestampMicrosecond(){return Ws}visitTimestampNanosecond(){return Ys}visitTime(){return Kr}visitTimeSecond(){return $s}visitTimeMillisecond(){return Xs}visitTimeMicrosecond(){return Gs}visitTimeNanosecond(){return Ks}visitDecimal(){return Cs}visitList(){return Aa}visitStruct(){return Da}visitUnion(){return Si}visitDenseUnion(){return Oa}visitSparseUnion(){return Ea}visitDictionary(){return ha}visitInterval(){return Pn}visitIntervalDayTime(){return Vs}visitIntervalYearMonth(){return Hs}visitFixedSizeList(){return pa}visitMap(){return xa}},pu=new hu;function dn(r){let t=r.type,e=new(pu.getVisitFn(t)())(r);if(t.children&&t.children.length>0){let n=r.children||[],i={nullValues:r.nullValues},s=Array.isArray(n)?(o,a)=>n[a]||i:({name:o})=>n[o]||i;for(let[o,a]of t.children.entries()){let{type:c}=a,d=s(a,o);e.children.push(dn(Object.assign(Object.assign({},d),{type:c})))}}return e}var N=class extends E{compareSchemas(t,e){return t===e||e instanceof t.constructor&&this.compareManyFields(t.fields,e.fields)}compareManyFields(t,e){return t===e||Array.isArray(t)&&Array.isArray(e)&&t.length===e.length&&t.every((n,i)=>this.compareFields(n,e[i]))}compareFields(t,e){return t===e||e instanceof t.constructor&&t.name===e.name&&t.nullable===e.nullable&&this.visit(t.type,e.type)}};function ne(r,t){return t instanceof r.constructor}function Ii(r,t){return r===t||ne(r,t)}function wr(r,t){return r===t||ne(r,t)&&r.bitWidth===t.bitWidth&&r.isSigned===t.isSigned}function qs(r,t){return r===t||ne(r,t)&&r.precision===t.precision}function Rm(r,t){return r===t||ne(r,t)&&r.byteWidth===t.byteWidth}function Ma(r,t){return r===t||ne(r,t)&&r.unit===t.unit}function Bi(r,t){return r===t||ne(r,t)&&r.unit===t.unit&&r.timezone===t.timezone}function Fi(r,t){return r===t||ne(r,t)&&r.unit===t.unit&&r.bitWidth===t.bitWidth}function Um(r,t){return r===t||ne(r,t)&&r.children.length===t.children.length&&rr.compareManyFields(r.children,t.children)}function Nm(r,t){return r===t||ne(r,t)&&r.children.length===t.children.length&&rr.compareManyFields(r.children,t.children)}function Ra(r,t){return r===t||ne(r,t)&&r.mode===t.mode&&r.typeIds.every((e,n)=>e===t.typeIds[n])&&rr.compareManyFields(r.children,t.children)}function km(r,t){return r===t||ne(r,t)&&r.id===t.id&&r.isOrdered===t.isOrdered&&rr.visit(r.indices,t.indices)&&rr.visit(r.dictionary,t.dictionary)}function Ua(r,t){return r===t||ne(r,t)&&r.unit===t.unit}function Lm(r,t){return r===t||ne(r,t)&&r.listSize===t.listSize&&r.children.length===t.children.length&&rr.compareManyFields(r.children,t.children)}function Cm(r,t){return r===t||ne(r,t)&&r.keysSorted===t.keysSorted&&r.children.length===t.children.length&&rr.compareManyFields(r.children,t.children)}N.prototype.visitNull=Ii;N.prototype.visitBool=Ii;N.prototype.visitInt=wr;N.prototype.visitInt8=wr;N.prototype.visitInt16=wr;N.prototype.visitInt32=wr;N.prototype.visitInt64=wr;N.prototype.visitUint8=wr;N.prototype.visitUint16=wr;N.prototype.visitUint32=wr;N.prototype.visitUint64=wr;N.prototype.visitFloat=qs;N.prototype.visitFloat16=qs;N.prototype.visitFloat32=qs;N.prototype.visitFloat64=qs;N.prototype.visitUtf8=Ii;N.prototype.visitBinary=Ii;N.prototype.visitFixedSizeBinary=Rm;N.prototype.visitDate=Ma;N.prototype.visitDateDay=Ma;N.prototype.visitDateMillisecond=Ma;N.prototype.visitTimestamp=Bi;N.prototype.visitTimestampSecond=Bi;N.prototype.visitTimestampMillisecond=Bi;N.prototype.visitTimestampMicrosecond=Bi;N.prototype.visitTimestampNanosecond=Bi;N.prototype.visitTime=Fi;N.prototype.visitTimeSecond=Fi;N.prototype.visitTimeMillisecond=Fi;N.prototype.visitTimeMicrosecond=Fi;N.prototype.visitTimeNanosecond=Fi;N.prototype.visitDecimal=Ii;N.prototype.visitList=Um;N.prototype.visitStruct=Nm;N.prototype.visitUnion=Ra;N.prototype.visitDenseUnion=Ra;N.prototype.visitSparseUnion=Ra;N.prototype.visitDictionary=km;N.prototype.visitInterval=Ua;N.prototype.visitIntervalDayTime=Ua;N.prototype.visitIntervalYearMonth=Ua;N.prototype.visitFixedSizeList=Lm;N.prototype.visitMap=Cm;var rr=new N;function fn(r,t){return rr.compareSchemas(r,t)}function mu(r,t){return rr.compareFields(r,t)}function yu(r,t){return rr.visit(r,t)}function Zs(r,t){return Pm(r,t.map(e=>e.data.concat()))}function Pm(r,t){let e=[...r.fields],n=[],i={numBatches:t.reduce((_,g)=>Math.max(_,g.length),0)},s=0,o=0,a=-1,c=t.length,d,p=[];for(;i.numBatches-- >0;){for(o=Number.POSITIVE_INFINITY,a=-1;++a<c;)p[a]=d=t[a].shift(),o=Math.min(o,d?d.length:o);Number.isFinite(o)&&(p=Vm(e,o,p,t,i),o>0&&(n[s++]=C({type:new ft(e),length:o,nullCount:0,children:p.slice()})))}return[r=r.assign(e),n.map(_=>new ct(r,_))]}function Vm(r,t,e,n,i){var s;let o=(t+63&-64)>>3;for(let a=-1,c=n.length;++a<c;){let d=e[a],p=d==null?void 0:d.length;if(p>=t)p===t?e[a]=d:(e[a]=d.slice(0,t),i.numBatches=Math.max(i.numBatches,n[a].unshift(d.slice(t,p-t))));else{let _=r[a];r[a]=_.clone({nullable:!0}),e[a]=(s=d==null?void 0:d._changeLengthAndBackfillNullBitmap(t))!==null&&s!==void 0?s:C({type:_.type,length:t,nullCount:t,nullBitmap:new Uint8Array(o)})}}return e}var _u,Bt=class{constructor(...t){var e,n;if(t.length===0)return this.batches=[],this.schema=new J([]),this._offsets=[0],this;let i,s;t[0]instanceof J&&(i=t.shift()),t[t.length-1]instanceof Uint32Array&&(s=t.pop());let o=c=>{if(c){if(c instanceof ct)return[c];if(c instanceof Bt)return c.batches;if(c instanceof Q){if(c.type instanceof ft)return[new ct(new J(c.type.children),c)]}else{if(Array.isArray(c))return c.flatMap(d=>o(d));if(typeof c[Symbol.iterator]=="function")return[...c].flatMap(d=>o(d));if(typeof c=="object"){let d=Object.keys(c),p=d.map(w=>new L([c[w]])),_=new J(d.map((w,q)=>new z(String(w),p[q].type))),[,g]=Zs(_,p);return g.length===0?[new ct(c)]:g}}}return[]},a=t.flatMap(c=>o(c));if(i=(n=i!=null?i:(e=a[0])===null||e===void 0?void 0:e.schema)!==null&&n!==void 0?n:new J([]),!(i instanceof J))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(let c of a){if(!(c instanceof ct))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!fn(i,c.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=i,this.batches=a,this._offsets=s!=null?s:Bs(this.data)}get data(){return this.batches.map(({data:t})=>t)}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce((t,e)=>t+e.length,0)}get nullCount(){return this._nullCount===-1&&(this._nullCount=Is(this.data)),this._nullCount}isValid(t){return!1}get(t){return null}set(t,e){}indexOf(t,e){return-1}getByteLength(t){return 0}[Symbol.iterator](){return On.visit(new L(this.data))}toArray(){return[...this]}toString(){return`[
  ${this.toArray().join(`,
  `)}
]`}concat(...t){let e=this.schema,n=this.data.concat(t.flatMap(({data:i})=>i));return new Bt(e,n.map(i=>new ct(e,i)))}slice(t,e){let n=this.schema;[t,e]=li({length:this.numRows},t,e);let i=Fs(this.data,this._offsets,t,e);return new Bt(n,i.map(s=>new ct(n,s)))}getChild(t){return this.getChildAt(this.schema.fields.findIndex(e=>e.name===t))}getChildAt(t){if(t>-1&&t<this.schema.fields.length){let e=this.data.map(n=>n.children[t]);if(e.length===0){let{type:n}=this.schema.fields[t],i=C({type:n,length:0,nullCount:0});e.push(i._changeLengthAndBackfillNullBitmap(this.numRows))}return new L(e)}return null}setChild(t,e){var n;return this.setChildAt((n=this.schema.fields)===null||n===void 0?void 0:n.findIndex(i=>i.name===t),e)}setChildAt(t,e){let n=this.schema,i=[...this.batches];if(t>-1&&t<this.numCols){e||(e=new L([C({type:new ee,length:this.numRows})]));let s=n.fields.slice(),o=s[t].clone({type:e.type}),a=this.schema.fields.map((c,d)=>this.getChildAt(d));[s[t],a[t]]=[o,e],[n,i]=Zs(n,a)}return new Bt(n,i)}select(t){let e=this.schema.fields.reduce((n,i,s)=>n.set(i.name,s),new Map);return this.selectAt(t.map(n=>e.get(n)).filter(n=>n>-1))}selectAt(t){let e=this.schema.selectAt(t),n=this.batches.map(i=>i.selectAt(t));return new Bt(e,n)}assign(t){let e=this.schema.fields,[n,i]=t.schema.fields.reduce((a,c,d)=>{let[p,_]=a,g=e.findIndex(w=>w.name===c.name);return~g?_[g]=d:p.push(d),a},[[],[]]),s=this.schema.assign(t.schema),o=[...e.map((a,c)=>[c,i[c]]).map(([a,c])=>c===void 0?this.getChildAt(a):t.getChildAt(c)),...n.map(a=>t.getChildAt(a))].filter(Boolean);return new Bt(...Zs(s,o))}};_u=Symbol.toStringTag;Bt[_u]=(r=>(r.schema=null,r.batches=[],r._offsets=new Uint32Array([0]),r._nullCount=-1,r[Symbol.isConcatSpreadable]=!0,r.isValid=Vr(di),r.get=Vr(At.getVisitFn(h.Struct)),r.set=As(Pt.getVisitFn(h.Struct)),r.indexOf=xs(cn.getVisitFn(h.Struct)),r.getByteLength=Vr(Pe.getVisitFn(h.Struct)),"Table"))(Bt.prototype);var gu,ct=class{constructor(...t){switch(t.length){case 2:{if([this.schema]=t,!(this.schema instanceof J))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");if([,this.data=C({nullCount:0,type:new ft(this.schema.fields),children:this.schema.fields.map(e=>C({type:e.type,nullCount:0}))})]=t,!(this.data instanceof Q))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=bu(this.schema,this.data.children);break}case 1:{let[e]=t,{fields:n,children:i,length:s}=Object.keys(e).reduce((c,d,p)=>(c.children[p]=e[d],c.length=Math.max(c.length,e[d].length),c.fields[p]=z.new({name:d,type:e[d].type,nullable:!0}),c),{length:0,fields:new Array,children:new Array}),o=new J(n),a=C({type:new ft(n),length:s,children:i,nullCount:0});[this.schema,this.data]=bu(o,a.children,s);break}default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=wu(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(t){return this.data.getValid(t)}get(t){return At.visit(this.data,t)}set(t,e){return Pt.visit(this.data,t,e)}indexOf(t,e){return cn.visit(this.data,t,e)}getByteLength(t){return Pe.visit(this.data,t)}[Symbol.iterator](){return On.visit(new L([this.data]))}toArray(){return[...this]}concat(...t){return new Bt(this.schema,[this,...t])}slice(t,e){let[n]=new L([this.data]).slice(t,e).data;return new ct(this.schema,n)}getChild(t){var e;return this.getChildAt((e=this.schema.fields)===null||e===void 0?void 0:e.findIndex(n=>n.name===t))}getChildAt(t){return t>-1&&t<this.schema.fields.length?new L([this.data.children[t]]):null}setChild(t,e){var n;return this.setChildAt((n=this.schema.fields)===null||n===void 0?void 0:n.findIndex(i=>i.name===t),e)}setChildAt(t,e){let n=this.schema,i=this.data;if(t>-1&&t<this.numCols){e||(e=new L([C({type:new ee,length:this.numRows})]));let s=n.fields.slice(),o=i.children.slice(),a=s[t].clone({type:e.type});[s[t],o[t]]=[a,e.data[0]],n=new J(s,new Map(this.schema.metadata)),i=C({type:new ft(s),children:o})}return new ct(n,i)}select(t){let e=this.schema.select(t),n=new ft(e.fields),i=[];for(let s of t){let o=this.schema.fields.findIndex(a=>a.name===s);~o&&(i[o]=this.data.children[o])}return new ct(e,C({type:n,length:this.numRows,children:i}))}selectAt(t){let e=this.schema.selectAt(t),n=t.map(s=>this.data.children[s]).filter(Boolean),i=C({type:new ft(e.fields),length:this.numRows,children:n});return new ct(e,i)}};gu=Symbol.toStringTag;ct[gu]=(r=>(r._nullCount=-1,r[Symbol.isConcatSpreadable]=!0,"RecordBatch"))(ct.prototype);function bu(r,t,e=t.reduce((n,i)=>Math.max(n,i.length),0)){var n;let i=[...r.fields],s=[...t],o=(e+63&-64)>>3;for(let[a,c]of r.fields.entries()){let d=t[a];(!d||d.length!==e)&&(i[a]=c.clone({nullable:!0}),s[a]=(n=d==null?void 0:d._changeLengthAndBackfillNullBitmap(e))!==null&&n!==void 0?n:C({type:c.type,length:e,nullCount:e,nullBitmap:new Uint8Array(o)}))}return[r.assign(i),C({type:new ft(i),length:e,children:s})]}function wu(r,t,e=new Map){for(let n=-1,i=r.length;++n<i;){let o=r[n].type,a=t[n];if(A.isDictionary(o)){if(!e.has(o.id))a.dictionary&&e.set(o.id,a.dictionary);else if(e.get(o.id)!==a.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}o.children&&o.children.length>0&&wu(o.children,a.children,e)}return e}var Vn=class extends ct{constructor(t){let e=t.fields.map(i=>C({type:i.type})),n=C({type:new ft(t.fields),nullCount:0,children:e});super(t,n)}};var Ai;(function(r){r[r.BUFFER=0]="BUFFER"})(Ai||(Ai={}));var xi;(function(r){r[r.LZ4_FRAME=0]="LZ4_FRAME",r[r.ZSTD=1]="ZSTD"})(xi||(xi={}));var nr=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBodyCompression(t,e){return(e||new nr).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBodyCompression(t,e){return t.setPosition(t.position()+4),(e||new nr).__init(t.readInt32(t.position())+t.position(),t)}codec(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt8(this.bb_pos+t):xi.LZ4_FRAME}method(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt8(this.bb_pos+t):Ai.BUFFER}static startBodyCompression(t){t.startObject(2)}static addCodec(t,e){t.addFieldInt8(0,e,xi.LZ4_FRAME)}static addMethod(t,e){t.addFieldInt8(1,e,Ai.BUFFER)}static endBodyCompression(t){return t.endObject()}static createBodyCompression(t,e,n){return nr.startBodyCompression(t),nr.addCodec(t,e),nr.addMethod(t,n),nr.endBodyCompression(t)}};var Ti=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createBuffer(t,e,n){return t.prep(8,16),t.writeInt64(n),t.writeInt64(e),t.offset()}};var Di=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createFieldNode(t,e,n){return t.prep(8,16),t.writeInt64(n),t.writeInt64(e),t.offset()}};var qt=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsRecordBatch(t,e){return(e||new qt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsRecordBatch(t,e){return t.setPosition(t.position()+4),(e||new qt).__init(t.readInt32(t.position())+t.position(),t)}length(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}nodes(t,e){let n=this.bb.__offset(this.bb_pos,6);return n?(e||new Di).__init(this.bb.__vector(this.bb_pos+n)+t*16,this.bb):null}nodesLength(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}buffers(t,e){let n=this.bb.__offset(this.bb_pos,8);return n?(e||new Ti).__init(this.bb.__vector(this.bb_pos+n)+t*16,this.bb):null}buffersLength(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}compression(t){let e=this.bb.__offset(this.bb_pos,10);return e?(t||new nr).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}static startRecordBatch(t){t.startObject(4)}static addLength(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addNodes(t,e){t.addFieldOffset(1,e,0)}static startNodesVector(t,e){t.startVector(16,e,8)}static addBuffers(t,e){t.addFieldOffset(2,e,0)}static startBuffersVector(t,e){t.startVector(16,e,8)}static addCompression(t,e){t.addFieldOffset(3,e,0)}static endRecordBatch(t){return t.endObject()}};var ze=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDictionaryBatch(t,e){return(e||new ze).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryBatch(t,e){return t.setPosition(t.position()+4),(e||new ze).__init(t.readInt32(t.position())+t.position(),t)}id(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}data(t){let e=this.bb.__offset(this.bb_pos,6);return e?(t||new qt).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}isDelta(){let t=this.bb.__offset(this.bb_pos,8);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startDictionaryBatch(t){t.startObject(3)}static addId(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addData(t,e){t.addFieldOffset(1,e,0)}static addIsDelta(t,e){t.addFieldInt8(2,+e,0)}static endDictionaryBatch(t){return t.endObject()}};var Hn;(function(r){r[r.NONE=0]="NONE",r[r.Schema=1]="Schema",r[r.DictionaryBatch=2]="DictionaryBatch",r[r.RecordBatch=3]="RecordBatch",r[r.Tensor=4]="Tensor",r[r.SparseTensor=5]="SparseTensor"})(Hn||(Hn={}));var xt=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsMessage(t,e){return(e||new xt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMessage(t,e){return t.setPosition(t.position()+4),(e||new xt).__init(t.readInt32(t.position())+t.position(),t)}version(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):jr.V1}headerType(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):Hn.NONE}header(t){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__union(t,this.bb_pos+e):null}bodyLength(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}customMetadata(t,e){let n=this.bb.__offset(this.bb_pos,12);return n?(e||new ht).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}customMetadataLength(){let t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startMessage(t){t.startObject(5)}static addVersion(t,e){t.addFieldInt16(0,e,jr.V1)}static addHeaderType(t,e){t.addFieldInt8(1,e,Hn.NONE)}static addHeader(t,e){t.addFieldOffset(2,e,0)}static addBodyLength(t,e){t.addFieldInt64(3,e,t.createLong(0,0))}static addCustomMetadata(t,e){t.addFieldOffset(4,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endMessage(t){return t.endObject()}static finishMessageBuffer(t,e){t.finish(e)}static finishSizePrefixedMessageBuffer(t,e){t.finish(e,void 0,!0)}static createMessage(t,e,n,i,s,o){return xt.startMessage(t),xt.addVersion(t,e),xt.addHeaderType(t,n),xt.addHeader(t,i),xt.addBodyLength(t,s),xt.addCustomMetadata(t,o),xt.endMessage(t)}};var zm=Ot,vu=class extends E{visit(t,e){return t==null||e==null?void 0:super.visit(t,e)}visitNull(t,e){return mr.startNull(e),mr.endNull(e)}visitInt(t,e){return Ht.startInt(e),Ht.addBitWidth(e,t.bitWidth),Ht.addIsSigned(e,t.isSigned),Ht.endInt(e)}visitFloat(t,e){return de.startFloatingPoint(e),de.addPrecision(e,t.precision),de.endFloatingPoint(e)}visitBinary(t,e){return fr.startBinary(e),fr.endBinary(e)}visitBool(t,e){return hr.startBool(e),hr.endBool(e)}visitUtf8(t,e){return _r.startUtf8(e),_r.endUtf8(e)}visitDecimal(t,e){return zt.startDecimal(e),zt.addScale(e,t.scale),zt.addPrecision(e,t.precision),zt.addBitWidth(e,t.bitWidth),zt.endDecimal(e)}visitDate(t,e){return ce.startDate(e),ce.addUnit(e,t.unit),ce.endDate(e)}visitTime(t,e){return Gt.startTime(e),Gt.addUnit(e,t.unit),Gt.addBitWidth(e,t.bitWidth),Gt.endTime(e)}visitTimestamp(t,e){let n=t.timezone&&e.createString(t.timezone)||void 0;return Kt.startTimestamp(e),Kt.addUnit(e,t.unit),n!==void 0&&Kt.addTimezone(e,n),Kt.endTimestamp(e)}visitInterval(t,e){return fe.startInterval(e),fe.addUnit(e,t.unit),fe.endInterval(e)}visitList(t,e){return pr.startList(e),pr.endList(e)}visitStruct(t,e){return yr.startStruct_(e),yr.endStruct_(e)}visitUnion(t,e){jt.startTypeIdsVector(e,t.typeIds.length);let n=jt.createTypeIdsVector(e,t.typeIds);return jt.startUnion(e),jt.addMode(e,t.mode),jt.addTypeIds(e,n),jt.endUnion(e)}visitDictionary(t,e){let n=this.visit(t.indices,e);return Te.startDictionaryEncoding(e),Te.addId(e,new zm(t.id,0)),Te.addIsOrdered(e,t.isOrdered),n!==void 0&&Te.addIndexType(e,n),Te.endDictionaryEncoding(e)}visitFixedSizeBinary(t,e){return le.startFixedSizeBinary(e),le.addByteWidth(e,t.byteWidth),le.endFixedSizeBinary(e)}visitFixedSizeList(t,e){return ue.startFixedSizeList(e),ue.addListSize(e,t.listSize),ue.endFixedSizeList(e)}visitMap(t,e){return he.startMap(e),he.addKeysSorted(e,t.keysSorted),he.endMap(e)}},Qs=new vu;function Fu(r,t=new Map){return new J(jm(r,t),to(r.customMetadata),t)}function Na(r){return new Yt(r.count,xu(r.columns),Tu(r.columns))}function Au(r){return new _e(Na(r.data),r.id,r.isDelta)}function jm(r,t){return(r.fields||[]).filter(Boolean).map(e=>z.fromJSON(e,t))}function Su(r,t){return(r.children||[]).filter(Boolean).map(e=>z.fromJSON(e,t))}function xu(r){return(r||[]).reduce((t,e)=>[...t,new ir(e.count,Wm(e.VALIDITY)),...xu(e.children)],[])}function Tu(r,t=[]){for(let e=-1,n=(r||[]).length;++e<n;){let i=r[e];i.VALIDITY&&t.push(new ye(t.length,i.VALIDITY.length)),i.TYPE&&t.push(new ye(t.length,i.TYPE.length)),i.OFFSET&&t.push(new ye(t.length,i.OFFSET.length)),i.DATA&&t.push(new ye(t.length,i.DATA.length)),t=Tu(i.children,t)}return t}function Wm(r){return(r||[]).reduce((t,e)=>t+ +(e===0),0)}function Du(r,t){let e,n,i,s,o,a;return!t||!(s=r.dictionary)?(o=Bu(r,Su(r,t)),i=new z(r.name,o,r.nullable,to(r.customMetadata))):t.has(e=s.id)?(n=(n=s.indexType)?Iu(n):new ar,a=new Fe(t.get(e),n,e,s.isOrdered),i=new z(r.name,a,r.nullable,to(r.customMetadata))):(n=(n=s.indexType)?Iu(n):new ar,t.set(e,o=Bu(r,Su(r,t))),a=new Fe(o,n,e,s.isOrdered),i=new z(r.name,a,r.nullable,to(r.customMetadata))),i||null}function to(r){return new Map(Object.entries(r||{}))}function Iu(r){return new Ft(r.isSigned,r.bitWidth)}function Bu(r,t){let e=r.type.name;switch(e){case"NONE":return new ee;case"null":return new ee;case"binary":return new Er;case"utf8":return new Or;case"bool":return new Mr;case"list":return new Je((t||[])[0]);case"struct":return new ft(t||[]);case"struct_":return new ft(t||[])}switch(e){case"int":{let n=r.type;return new Ft(n.isSigned,n.bitWidth)}case"floatingpoint":{let n=r.type;return new oe(dt[n.precision])}case"decimal":{let n=r.type;return new Rr(n.scale,n.precision,n.bitWidth)}case"date":{let n=r.type;return new Ur(Ct[n.unit])}case"time":{let n=r.type;return new Ke(X[n.unit],n.bitWidth)}case"timestamp":{let n=r.type;return new Nr(X[n.unit],n.timezone)}case"interval":{let n=r.type;return new kr(Xt[n.unit])}case"union":{let n=r.type;return new qe(bt[n.mode],n.typeIds||[],t||[])}case"fixedsizebinary":{let n=r.type;return new Lr(n.byteWidth)}case"fixedsizelist":{let n=r.type;return new Ze(n.listSize,(t||[])[0])}case"map":{let n=r.type;return new Qe((t||[])[0],n.keysSorted)}}throw new Error(`Unrecognized type: "${e}"`)}var hn=Ot,Ym=zr,$m=re,Rt=class{constructor(t,e,n,i){this._version=e,this._headerType=n,this.body=new Uint8Array(0),i&&(this._createHeader=()=>i),this._bodyLength=typeof t=="number"?t:t.low}static fromJSON(t,e){let n=new Rt(0,kt.V4,e);return n._createHeader=Xm(t,e),n}static decode(t){t=new $m(O(t));let e=xt.getRootAsMessage(t),n=e.bodyLength(),i=e.version(),s=e.headerType(),o=new Rt(n,i,s);return o._createHeader=Gm(e,s),o}static encode(t){let e=new Ym,n=-1;return t.isSchema()?n=J.encode(e,t.header()):t.isRecordBatch()?n=Yt.encode(e,t.header()):t.isDictionaryBatch()&&(n=_e.encode(e,t.header())),xt.startMessage(e),xt.addVersion(e,kt.V4),xt.addHeader(e,n),xt.addHeaderType(e,t.headerType),xt.addBodyLength(e,new hn(t.bodyLength,0)),xt.finishMessageBuffer(e,xt.endMessage(e)),e.asUint8Array()}static from(t,e=0){if(t instanceof J)return new Rt(0,kt.V4,Z.Schema,t);if(t instanceof Yt)return new Rt(e,kt.V4,Z.RecordBatch,t);if(t instanceof _e)return new Rt(e,kt.V4,Z.DictionaryBatch,t);throw new Error(`Unrecognized Message header: ${t}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===Z.Schema}isRecordBatch(){return this.headerType===Z.RecordBatch}isDictionaryBatch(){return this.headerType===Z.DictionaryBatch}},Yt=class{constructor(t,e,n){this._nodes=e,this._buffers=n,this._length=typeof t=="number"?t:t.low}get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}},_e=class{constructor(t,e,n=!1){this._data=t,this._isDelta=n,this._id=typeof e=="number"?e:e.low}get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}},ye=class{constructor(t,e){this.offset=typeof t=="number"?t:t.low,this.length=typeof e=="number"?e:e.low}},ir=class{constructor(t,e){this.length=typeof t=="number"?t:t.low,this.nullCount=typeof e=="number"?e:e.low}};function Xm(r,t){return()=>{switch(t){case Z.Schema:return J.fromJSON(r);case Z.RecordBatch:return Yt.fromJSON(r);case Z.DictionaryBatch:return _e.fromJSON(r)}throw new Error(`Unrecognized Message type: { name: ${Z[t]}, type: ${t} }`)}}function Gm(r,t){return()=>{switch(t){case Z.Schema:return J.decode(r.header(new wt));case Z.RecordBatch:return Yt.decode(r.header(new qt),r.version());case Z.DictionaryBatch:return _e.decode(r.header(new ze),r.version())}throw new Error(`Unrecognized Message type: { name: ${Z[t]}, type: ${t} }`)}}z.encode=sy;z.decode=ny;z.fromJSON=Du;J.encode=iy;J.decode=Km;J.fromJSON=Fu;Yt.encode=oy;Yt.decode=Jm;Yt.fromJSON=Na;_e.encode=ay;_e.decode=qm;_e.fromJSON=Au;ir.encode=cy;ir.decode=Qm;ye.encode=ly;ye.decode=Zm;function Km(r,t=new Map){let e=ry(r,t);return new J(e,eo(r),t)}function Jm(r,t=kt.V4){return new Yt(r.length(),ty(r),ey(r,t))}function qm(r,t=kt.V4){return new _e(Yt.decode(r.data(),t),r.id(),r.isDelta())}function Zm(r){return new ye(r.offset(),r.length())}function Qm(r){return new ir(r.length(),r.nullCount())}function ty(r){let t=[];for(let e,n=-1,i=-1,s=r.nodesLength();++n<s;)(e=r.nodes(n))&&(t[++i]=ir.decode(e));return t}function ey(r,t){let e=[];for(let n,i=-1,s=-1,o=r.buffersLength();++i<o;)(n=r.buffers(i))&&(t<kt.V4&&(n.bb_pos+=8*(i+1)),e[++s]=ye.decode(n));return e}function ry(r,t){let e=[];for(let n,i=-1,s=-1,o=r.fieldsLength();++i<o;)(n=r.fields(i))&&(e[++s]=z.decode(n,t));return e}function Eu(r,t){let e=[];for(let n,i=-1,s=-1,o=r.childrenLength();++i<o;)(n=r.children(i))&&(e[++s]=z.decode(n,t));return e}function ny(r,t){let e,n,i,s,o,a;return!t||!(a=r.dictionary())?(i=Mu(r,Eu(r,t)),n=new z(r.name(),i,r.nullable(),eo(r))):t.has(e=a.id().low)?(s=(s=a.indexType())?Ou(s):new ar,o=new Fe(t.get(e),s,e,a.isOrdered()),n=new z(r.name(),o,r.nullable(),eo(r))):(s=(s=a.indexType())?Ou(s):new ar,t.set(e,i=Mu(r,Eu(r,t))),o=new Fe(i,s,e,a.isOrdered()),n=new z(r.name(),o,r.nullable(),eo(r))),n||null}function eo(r){let t=new Map;if(r)for(let e,n,i=-1,s=Math.trunc(r.customMetadataLength());++i<s;)(e=r.customMetadata(i))&&(n=e.key())!=null&&t.set(n,e.value());return t}function Ou(r){return new Ft(r.isSigned(),r.bitWidth())}function Mu(r,t){let e=r.typeType();switch(e){case pt.NONE:return new ee;case pt.Null:return new ee;case pt.Binary:return new Er;case pt.Utf8:return new Or;case pt.Bool:return new Mr;case pt.List:return new Je((t||[])[0]);case pt.Struct_:return new ft(t||[])}switch(e){case pt.Int:{let n=r.type(new Ht);return new Ft(n.isSigned(),n.bitWidth())}case pt.FloatingPoint:{let n=r.type(new de);return new oe(n.precision())}case pt.Decimal:{let n=r.type(new zt);return new Rr(n.scale(),n.precision(),n.bitWidth())}case pt.Date:{let n=r.type(new ce);return new Ur(n.unit())}case pt.Time:{let n=r.type(new Gt);return new Ke(n.unit(),n.bitWidth())}case pt.Timestamp:{let n=r.type(new Kt);return new Nr(n.unit(),n.timezone())}case pt.Interval:{let n=r.type(new fe);return new kr(n.unit())}case pt.Union:{let n=r.type(new jt);return new qe(n.mode(),n.typeIdsArray()||[],t||[])}case pt.FixedSizeBinary:{let n=r.type(new le);return new Lr(n.byteWidth())}case pt.FixedSizeList:{let n=r.type(new ue);return new Ze(n.listSize(),(t||[])[0])}case pt.Map:{let n=r.type(new he);return new Qe((t||[])[0],n.keysSorted())}}throw new Error(`Unrecognized type: "${pt[e]}" (${e})`)}function iy(r,t){let e=t.fields.map(s=>z.encode(r,s));wt.startFieldsVector(r,e.length);let n=wt.createFieldsVector(r,e),i=t.metadata&&t.metadata.size>0?wt.createCustomMetadataVector(r,[...t.metadata].map(([s,o])=>{let a=r.createString(`${s}`),c=r.createString(`${o}`);return ht.startKeyValue(r),ht.addKey(r,a),ht.addValue(r,c),ht.endKeyValue(r)})):-1;return wt.startSchema(r),wt.addFields(r,n),wt.addEndianness(r,uy?Wr.Little:Wr.Big),i!==-1&&wt.addCustomMetadata(r,i),wt.endSchema(r)}function sy(r,t){let e=-1,n=-1,i=-1,s=t.type,o=t.typeId;A.isDictionary(s)?(o=s.dictionary.typeId,i=Qs.visit(s,r),n=Qs.visit(s.dictionary,r)):n=Qs.visit(s,r);let a=(s.children||[]).map(p=>z.encode(r,p)),c=Mt.createChildrenVector(r,a),d=t.metadata&&t.metadata.size>0?Mt.createCustomMetadataVector(r,[...t.metadata].map(([p,_])=>{let g=r.createString(`${p}`),w=r.createString(`${_}`);return ht.startKeyValue(r),ht.addKey(r,g),ht.addValue(r,w),ht.endKeyValue(r)})):-1;return t.name&&(e=r.createString(t.name)),Mt.startField(r),Mt.addType(r,n),Mt.addTypeType(r,o),Mt.addChildren(r,c),Mt.addNullable(r,!!t.nullable),e!==-1&&Mt.addName(r,e),i!==-1&&Mt.addDictionary(r,i),d!==-1&&Mt.addCustomMetadata(r,d),Mt.endField(r)}function oy(r,t){let e=t.nodes||[],n=t.buffers||[];qt.startNodesVector(r,e.length);for(let o of e.slice().reverse())ir.encode(r,o);let i=r.endVector();qt.startBuffersVector(r,n.length);for(let o of n.slice().reverse())ye.encode(r,o);let s=r.endVector();return qt.startRecordBatch(r),qt.addLength(r,new hn(t.length,0)),qt.addNodes(r,i),qt.addBuffers(r,s),qt.endRecordBatch(r)}function ay(r,t){let e=Yt.encode(r,t.data);return ze.startDictionaryBatch(r),ze.addId(r,new hn(t.id,0)),ze.addIsDelta(r,t.isDelta),ze.addData(r,e),ze.endDictionaryBatch(r)}function cy(r,t){return Di.createFieldNode(r,new hn(t.length,0),new hn(t.nullCount,0))}function ly(r,t){return Ti.createBuffer(r,new hn(t.offset,0),new hn(t.length,0))}var uy=(()=>{let r=new ArrayBuffer(2);return new DataView(r).setInt16(0,256,!0),new Int16Array(r)[0]===256})();var La=r=>`Expected ${Z[r]} Message in stream, but was null or length 0.`,Ca=r=>`Header pointer of flatbuffer-encoded ${Z[r]} Message is null or length 0.`,Ru=(r,t)=>`Expected to read ${r} metadata bytes, but only read ${t}.`,Uu=(r,t)=>`Expected to read ${r} bytes for message body, but only read ${t}.`,Ei=class{constructor(t){this.source=t instanceof gr?t:new gr(t)}[Symbol.iterator](){return this}next(){let t;return(t=this.readMetadataLength()).done?at:t.value===-1&&(t=this.readMetadataLength()).done?at:(t=this.readMetadata(t.value)).done?at:t}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}readMessage(t){let e;if((e=this.next()).done)return null;if(t!=null&&e.value.headerType!==t)throw new Error(La(t));return e.value}readMessageBody(t){if(t<=0)return new Uint8Array(0);let e=O(this.source.read(t));if(e.byteLength<t)throw new Error(Uu(t,e.byteLength));return e.byteOffset%8===0&&e.byteOffset+e.byteLength<=e.buffer.byteLength?e:e.slice()}readSchema(t=!1){let e=Z.Schema,n=this.readMessage(e),i=n==null?void 0:n.header();if(t&&!i)throw new Error(Ca(e));return i}readMetadataLength(){let t=this.source.read(io),e=t&&new re(t),n=(e==null?void 0:e.readInt32(0))||0;return{done:n===0,value:n}}readMetadata(t){let e=this.source.read(t);if(!e)return at;if(e.byteLength<t)throw new Error(Ru(t,e.byteLength));return{done:!1,value:Rt.decode(e)}}},ro=class{constructor(t,e){this.source=t instanceof pe?t:ts(t)?new un(t,e):new pe(t)}[Symbol.asyncIterator](){return this}next(){return I(this,void 0,void 0,function*(){let t;return(t=yield this.readMetadataLength()).done?at:t.value===-1&&(t=yield this.readMetadataLength()).done?at:(t=yield this.readMetadata(t.value)).done?at:t})}throw(t){return I(this,void 0,void 0,function*(){return yield this.source.throw(t)})}return(t){return I(this,void 0,void 0,function*(){return yield this.source.return(t)})}readMessage(t){return I(this,void 0,void 0,function*(){let e;if((e=yield this.next()).done)return null;if(t!=null&&e.value.headerType!==t)throw new Error(La(t));return e.value})}readMessageBody(t){return I(this,void 0,void 0,function*(){if(t<=0)return new Uint8Array(0);let e=O(yield this.source.read(t));if(e.byteLength<t)throw new Error(Uu(t,e.byteLength));return e.byteOffset%8===0&&e.byteOffset+e.byteLength<=e.buffer.byteLength?e:e.slice()})}readSchema(t=!1){return I(this,void 0,void 0,function*(){let e=Z.Schema,n=yield this.readMessage(e),i=n==null?void 0:n.header();if(t&&!i)throw new Error(Ca(e));return i})}readMetadataLength(){return I(this,void 0,void 0,function*(){let t=yield this.source.read(io),e=t&&new re(t),n=(e==null?void 0:e.readInt32(0))||0;return{done:n===0,value:n}})}readMetadata(t){return I(this,void 0,void 0,function*(){let e=yield this.source.read(t);if(!e)return at;if(e.byteLength<t)throw new Error(Ru(t,e.byteLength));return{done:!1,value:Rt.decode(e)}})}},no=class extends Ei{constructor(t){super(new Uint8Array(0));this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=t instanceof Ms?t:new Ms(t)}next(){let{_json:t}=this;if(!this._schema){this._schema=!0;let e=Rt.fromJSON(t.schema,Z.Schema);return{done:!1,value:e}}if(this._dictionaryIndex<t.dictionaries.length){let e=t.dictionaries[this._dictionaryIndex++];this._body=e.data.columns;let n=Rt.fromJSON(e,Z.DictionaryBatch);return{done:!1,value:n}}if(this._batchIndex<t.batches.length){let e=t.batches[this._batchIndex++];this._body=e.columns;let n=Rt.fromJSON(e,Z.RecordBatch);return{done:!1,value:n}}return this._body=[],at}readMessageBody(t){return e(this._body);function e(n){return(n||[]).reduce((i,s)=>[...i,...s.VALIDITY&&[s.VALIDITY]||[],...s.TYPE&&[s.TYPE]||[],...s.OFFSET&&[s.OFFSET]||[],...s.DATA&&[s.DATA]||[],...e(s.children)],[])}}readMessage(t){let e;if((e=this.next()).done)return null;if(t!=null&&e.value.headerType!==t)throw new Error(La(t));return e.value}readSchema(){let t=Z.Schema,e=this.readMessage(t),n=e==null?void 0:e.header();if(!e||!n)throw new Error(Ca(t));return n}},io=4,ka="ARROW1",zn=new Uint8Array(ka.length);for(let r=0;r<ka.length;r+=1)zn[r]=ka.codePointAt(r);function so(r,t=0){for(let e=-1,n=zn.length;++e<n;)if(zn[e]!==r[t+e])return!1;return!0}var jn=zn.length,Pa=jn+io,Nu=jn*2+io;var Tt=class extends Un{constructor(t){super();this._impl=t}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(t){return this._impl.throw(t)}return(t){return this._impl.return(t)}cancel(){return this._impl.cancel()}reset(t){return this._impl.reset(t),this._DOMStream=void 0,this._nodeStream=void 0,this}open(t){let e=this._impl.open(t);return Re(e)?e.then(()=>this):this}readRecordBatch(t){return this._impl.isFile()?this._impl.readRecordBatch(t):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return Lt.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return Lt.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,e){throw new Error('"throughDOM" not available in this environment')}static from(t){return t instanceof Tt?t:Zi(t)?fy(t):ts(t)?my(t):Re(t)?(()=>I(this,void 0,void 0,function*(){return yield Tt.from(yield t)}))():es(t)||si(t)||ns(t)||Ie(t)?py(new pe(t)):hy(new gr(t))}static readAll(t){return t instanceof Tt?t.isSync()?ku(t):Lu(t):Zi(t)||ArrayBuffer.isView(t)||Ue(t)||Qi(t)?ku(t):Lu(t)}},vr=class extends Tt{constructor(t){super(t);this._impl=t}readAll(){return[...this]}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return te(this,arguments,function*(){yield j(yield*gn(Se(this[Symbol.iterator]())))})}},pn=class extends Tt{constructor(t){super(t);this._impl=t}readAll(){var t,e;return I(this,void 0,void 0,function*(){let n=new Array;try{for(var i=Se(this),s;s=yield i.next(),!s.done;){let o=s.value;n.push(o)}}catch(o){t={error:o}}finally{try{s&&!s.done&&(e=i.return)&&(yield e.call(i))}finally{if(t)throw t.error}}return n})}[Symbol.iterator](){throw new Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}},mn=class extends vr{constructor(t){super(t);this._impl=t}},oo=class extends pn{constructor(t){super(t);this._impl=t}},Va=class{constructor(t=new Map){this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=t}get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(t){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=t,this.dictionaries=new Map,this}_loadRecordBatch(t,e){let n=this._loadVectors(t,e,this.schema.fields),i=C({type:new ft(this.schema.fields),length:t.length,children:n});return new ct(this.schema,i)}_loadDictionaryBatch(t,e){let{id:n,isDelta:i}=t,{dictionaries:s,schema:o}=this,a=s.get(n);if(i||!a){let c=o.dictionaries.get(n),d=this._loadVectors(t.data,e,[c]);return(a&&i?a.concat(new L(d)):new L(d)).memoize()}return a.memoize()}_loadVectors(t,e,n){return new Ns(e,t.nodes,t.buffers,this.dictionaries).visitMany(n)}},Oi=class extends Va{constructor(t,e){super(e);this._reader=Zi(t)?new no(this._handle=t):new Ei(this._handle=t)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(t){return this.closed||(this.autoDestroy=Vu(this,t),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(t):at}return(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(t):at}next(){if(this.closed)return at;let t,{_reader:e}=this;for(;t=this._readNextMessageAndValidate();)if(t.isSchema())this.reset(t.header());else if(t.isRecordBatch()){this._recordBatchIndex++;let n=t.header(),i=e.readMessageBody(t.bodyLength),s=this._loadRecordBatch(n,i);return{done:!1,value:s}}else if(t.isDictionaryBatch()){this._dictionaryIndex++;let n=t.header(),i=e.readMessageBody(t.bodyLength),s=this._loadDictionaryBatch(n,i);this.dictionaries.set(n.id,s)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new Vn(this.schema)}):this.return()}_readNextMessageAndValidate(t){return this._reader.readMessage(t)}},Mi=class extends Va{constructor(t,e){super(e);this._reader=new ro(this._handle=t)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){return I(this,void 0,void 0,function*(){!this.closed&&(this.closed=!0)&&(yield this.reset()._reader.return(),this._reader=null,this.dictionaries=null)})}open(t){return I(this,void 0,void 0,function*(){return this.closed||(this.autoDestroy=Vu(this,t),this.schema||(this.schema=yield this._reader.readSchema())||(yield this.cancel())),this})}throw(t){return I(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.throw(t):at})}return(t){return I(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.return(t):at})}next(){return I(this,void 0,void 0,function*(){if(this.closed)return at;let t,{_reader:e}=this;for(;t=yield this._readNextMessageAndValidate();)if(t.isSchema())yield this.reset(t.header());else if(t.isRecordBatch()){this._recordBatchIndex++;let n=t.header(),i=yield e.readMessageBody(t.bodyLength),s=this._loadRecordBatch(n,i);return{done:!1,value:s}}else if(t.isDictionaryBatch()){this._dictionaryIndex++;let n=t.header(),i=yield e.readMessageBody(t.bodyLength),s=this._loadDictionaryBatch(n,i);this.dictionaries.set(n.id,s)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new Vn(this.schema)}):yield this.return()})}_readNextMessageAndValidate(t){return I(this,void 0,void 0,function*(){return yield this._reader.readMessage(t)})}},Ha=class extends Oi{constructor(t,e){super(t instanceof Rs?t:new Rs(t),e)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isSync(){return!0}isFile(){return!0}open(t){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(let e of this._footer.dictionaryBatches())e&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(t)}readRecordBatch(t){var e;if(this.closed)return null;this._footer||this.open();let n=(e=this._footer)===null||e===void 0?void 0:e.getRecordBatch(t);if(n&&this._handle.seek(n.offset)){let i=this._reader.readMessage(Z.RecordBatch);if(i!=null&&i.isRecordBatch()){let s=i.header(),o=this._reader.readMessageBody(i.bodyLength);return this._loadRecordBatch(s,o)}}return null}_readDictionaryBatch(t){var e;let n=(e=this._footer)===null||e===void 0?void 0:e.getDictionaryBatch(t);if(n&&this._handle.seek(n.offset)){let i=this._reader.readMessage(Z.DictionaryBatch);if(i!=null&&i.isDictionaryBatch()){let s=i.header(),o=this._reader.readMessageBody(i.bodyLength),a=this._loadDictionaryBatch(s,o);this.dictionaries.set(s.id,a)}}}_readFooter(){let{_handle:t}=this,e=t.size-Pa,n=t.readInt32(e),i=t.readAt(e-n,n);return $r.decode(i)}_readNextMessageAndValidate(t){var e;if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){let n=(e=this._footer)===null||e===void 0?void 0:e.getRecordBatch(this._recordBatchIndex);if(n&&this._handle.seek(n.offset))return this._reader.readMessage(t)}return null}},Cu=class extends Mi{constructor(t,...e){let n=typeof e[0]!="number"?e.shift():void 0,i=e[0]instanceof Map?e.shift():void 0;super(t instanceof un?t:new un(t,n),i)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isFile(){return!0}isAsync(){return!0}open(t){let e=Object.create(null,{open:{get:()=>super.open}});return I(this,void 0,void 0,function*(){if(!this.closed&&!this._footer){this.schema=(this._footer=yield this._readFooter()).schema;for(let n of this._footer.dictionaryBatches())n&&(yield this._readDictionaryBatch(this._dictionaryIndex++))}return yield e.open.call(this,t)})}readRecordBatch(t){var e;return I(this,void 0,void 0,function*(){if(this.closed)return null;this._footer||(yield this.open());let n=(e=this._footer)===null||e===void 0?void 0:e.getRecordBatch(t);if(n&&(yield this._handle.seek(n.offset))){let i=yield this._reader.readMessage(Z.RecordBatch);if(i!=null&&i.isRecordBatch()){let s=i.header(),o=yield this._reader.readMessageBody(i.bodyLength);return this._loadRecordBatch(s,o)}}return null})}_readDictionaryBatch(t){var e;return I(this,void 0,void 0,function*(){let n=(e=this._footer)===null||e===void 0?void 0:e.getDictionaryBatch(t);if(n&&(yield this._handle.seek(n.offset))){let i=yield this._reader.readMessage(Z.DictionaryBatch);if(i!=null&&i.isDictionaryBatch()){let s=i.header(),o=yield this._reader.readMessageBody(i.bodyLength),a=this._loadDictionaryBatch(s,o);this.dictionaries.set(s.id,a)}}})}_readFooter(){return I(this,void 0,void 0,function*(){let{_handle:t}=this;t._pending&&(yield t._pending);let e=t.size-Pa,n=yield t.readInt32(e),i=yield t.readAt(e-n,n);return $r.decode(i)})}_readNextMessageAndValidate(t){return I(this,void 0,void 0,function*(){if(this._footer||(yield this.open()),this._footer&&this._recordBatchIndex<this.numRecordBatches){let e=this._footer.getRecordBatch(this._recordBatchIndex);if(e&&(yield this._handle.seek(e.offset)))return yield this._reader.readMessage(t)}return null})}},Pu=class extends Oi{constructor(t,e){super(t,e)}_loadVectors(t,e,n){return new da(e,t.nodes,t.buffers,this.dictionaries).visitMany(n)}};function Vu(r,t){return t&&typeof t.autoDestroy=="boolean"?t.autoDestroy:r.autoDestroy}function*ku(r){let t=Tt.from(r);try{if(!t.open({autoDestroy:!1}).closed)do yield t;while(!t.reset().open().closed)}finally{t.cancel()}}function Lu(r){return te(this,arguments,function*(){let e=yield j(Tt.from(r));try{if(!(yield j(e.open({autoDestroy:!1}))).closed)do yield yield j(e);while(!(yield j(e.reset().open())).closed)}finally{yield j(e.cancel())}})}function fy(r){return new vr(new Pu(r))}function hy(r){let t=r.peek(jn+7&-8);return t&&t.byteLength>=4?so(t)?new mn(new Ha(r.read())):new vr(new Oi(r)):new vr(new Oi(function*(){}()))}function py(r){return I(this,void 0,void 0,function*(){let t=yield r.peek(jn+7&-8);return t&&t.byteLength>=4?so(t)?new mn(new Ha(yield r.read())):new pn(new Mi(r)):new pn(new Mi(function(){return te(this,arguments,function*(){})}()))})}function my(r){return I(this,void 0,void 0,function*(){let{size:t}=yield r.stat(),e=new un(r,t);return t>=Nu&&so(yield e.readAt(0,jn+7&-8))?new oo(new Cu(e)):new pn(new Mi(e))})}var vt=class extends E{constructor(){super();this._byteLength=0,this._nodes=[],this._buffers=[],this._bufferRegions=[]}static assemble(...t){let e=i=>i.flatMap(s=>Array.isArray(s)?e(s):s instanceof ct?s.data.children:s.data),n=new vt;return n.visitMany(e(t)),n}visit(t){if(t instanceof L)return this.visitMany(t.data),this;let{type:e}=t;if(!A.isDictionary(e)){let{length:n,nullCount:i}=t;if(n>2147483647)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");A.isNull(e)||je.call(this,i<=0?new Uint8Array(0):Tn(t.offset,n,t.nullBitmap)),this.nodes.push(new ir(n,i))}return super.visit(t)}visitNull(t){return this}visitDictionary(t){return this.visit(t.clone(t.type.indices))}get nodes(){return this._nodes}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get bufferRegions(){return this._bufferRegions}};function je(r){let t=r.byteLength+7&-8;return this.buffers.push(r),this.bufferRegions.push(new ye(this._byteLength,t)),this._byteLength+=t,this}function yy(r){let{type:t,length:e,typeIds:n,valueOffsets:i}=r;if(je.call(this,n),t.mode===bt.Sparse)return za.call(this,r);if(t.mode===bt.Dense){if(r.offset<=0)return je.call(this,i),za.call(this,r);{let s=n.reduce((p,_)=>Math.max(p,_),n[0]),o=new Int32Array(s+1),a=new Int32Array(s+1).fill(-1),c=new Int32Array(e),d=oi(-i[0],e,i);for(let p,_,g=-1;++g<e;)(_=a[p=n[g]])===-1&&(_=a[p]=d[p]),c[g]=d[g]-_,++o[p];je.call(this,c);for(let p,_=-1,g=t.children.length;++_<g;)if(p=r.children[_]){let w=t.typeIds[_],q=Math.min(e,o[w]);this.visit(p.slice(a[w],q))}}}return this}function _y(r){let t;return r.nullCount>=r.length?je.call(this,new Uint8Array(0)):(t=r.values)instanceof Uint8Array?je.call(this,Tn(r.offset,r.length,t)):je.call(this,an(r.values))}function Jr(r){return je.call(this,r.values.subarray(0,r.length*r.stride))}function Hu(r){let{length:t,values:e,valueOffsets:n}=r,i=n[0],s=n[t],o=Math.min(s-i,e.byteLength-i);return je.call(this,oi(-n[0],t,n)),je.call(this,e.subarray(i,i+o)),this}function ja(r){let{length:t,valueOffsets:e}=r;return e&&je.call(this,oi(e[0],t,e)),this.visit(r.children[0])}function za(r){return this.visitMany(r.type.children.map((t,e)=>r.children[e]).filter(Boolean))[0]}vt.prototype.visitBool=_y;vt.prototype.visitInt=Jr;vt.prototype.visitFloat=Jr;vt.prototype.visitUtf8=Hu;vt.prototype.visitBinary=Hu;vt.prototype.visitFixedSizeBinary=Jr;vt.prototype.visitDate=Jr;vt.prototype.visitTimestamp=Jr;vt.prototype.visitTime=Jr;vt.prototype.visitDecimal=Jr;vt.prototype.visitList=ja;vt.prototype.visitStruct=za;vt.prototype.visitUnion=yy;vt.prototype.visitInterval=Jr;vt.prototype.visitFixedSizeList=ja;vt.prototype.visitMap=ja;var yn=class extends Un{constructor(t){super();this._position=0,this._started=!1,this._sink=new br,this._schema=null,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,$t(t)||(t={autoDestroy:!0,writeLegacyIpcFormat:!1}),this._autoDestroy=typeof t.autoDestroy=="boolean"?t.autoDestroy:!0,this._writeLegacyIpcFormat=typeof t.writeLegacyIpcFormat=="boolean"?t.writeLegacyIpcFormat:!1}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,e){throw new Error('"throughDOM" not available in this environment')}toString(t=!1){return this._sink.toString(t)}toUint8Array(t=!1){return this._sink.toUint8Array(t)}writeAll(t){return Re(t)?t.then(e=>this.writeAll(e)):Ie(t)?Ya(this,t):Wa(this,t)}get closed(){return this._sink.closed}[Symbol.asyncIterator](){return this._sink[Symbol.asyncIterator]()}toDOMStream(t){return this._sink.toDOMStream(t)}toNodeStream(t){return this._sink.toNodeStream(t)}close(){return this.reset()._sink.close()}abort(t){return this.reset()._sink.abort(t)}finish(){return this._autoDestroy?this.close():this.reset(this._sink,this._schema),this}reset(t=this._sink,e=null){return t===this._sink||t instanceof br?this._sink=t:(this._sink=new br,t&&Qc(t)?this.toDOMStream({type:"bytes"}).pipeTo(t):t&&tl(t)&&this.toNodeStream({objectMode:!1}).pipe(t)),this._started&&this._schema&&this._writeFooter(this._schema),this._started=!1,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,(!e||!fn(e,this._schema))&&(e==null?(this._position=0,this._schema=null):(this._started=!0,this._schema=e,this._writeSchema(e))),this}write(t){let e=null;if(this._sink){if(t==null)return this.finish()&&void 0;if(t instanceof Bt&&!(e=t.schema))return this.finish()&&void 0;if(t instanceof ct&&!(e=t.schema))return this.finish()&&void 0}else throw new Error("RecordBatchWriter is closed");if(e&&!fn(e,this._schema)){if(this._started&&this._autoDestroy)return this.close();this.reset(this._sink,e)}t instanceof ct?t instanceof Vn||this._writeRecordBatch(t):t instanceof Bt?this.writeAll(t.batches):Ue(t)&&this.writeAll(t)}_writeMessage(t,e=8){let n=e-1,i=Rt.encode(t),s=i.byteLength,o=this._writeLegacyIpcFormat?4:8,a=s+o+n&~n,c=a-s-o;return t.headerType===Z.RecordBatch?this._recordBatchBlocks.push(new er(a,t.bodyLength,this._position)):t.headerType===Z.DictionaryBatch&&this._dictionaryBlocks.push(new er(a,t.bodyLength,this._position)),this._writeLegacyIpcFormat||this._write(Int32Array.of(-1)),this._write(Int32Array.of(a-o)),s>0&&this._write(i),this._writePadding(c)}_write(t){if(this._started){let e=O(t);e&&e.byteLength>0&&(this._sink.write(e),this._position+=e.byteLength)}return this}_writeSchema(t){return this._writeMessage(Rt.from(t))}_writeFooter(t){return this._writeLegacyIpcFormat?this._write(Int32Array.of(0)):this._write(Int32Array.of(-1,0))}_writeMagic(){return this._write(zn)}_writePadding(t){return t>0?this._write(new Uint8Array(t)):this}_writeRecordBatch(t){let{byteLength:e,nodes:n,bufferRegions:i,buffers:s}=vt.assemble(t),o=new Yt(t.numRows,n,i),a=Rt.from(o,e);return this._writeDictionaries(t)._writeMessage(a)._writeBodyBuffers(s)}_writeDictionaryBatch(t,e,n=!1){this._dictionaryDeltaOffsets.set(e,t.length+(this._dictionaryDeltaOffsets.get(e)||0));let{byteLength:i,nodes:s,bufferRegions:o,buffers:a}=vt.assemble(new L([t])),c=new Yt(t.length,s,o),d=new _e(c,e,n),p=Rt.from(d,i);return this._writeMessage(p)._writeBodyBuffers(a)}_writeBodyBuffers(t){let e,n,i;for(let s=-1,o=t.length;++s<o;)(e=t[s])&&(n=e.byteLength)>0&&(this._write(e),(i=(n+7&-8)-n)>0&&this._writePadding(i));return this}_writeDictionaries(t){for(let[e,n]of t.dictionaries){let i=this._dictionaryDeltaOffsets.get(e)||0;if(i===0||(n=n==null?void 0:n.slice(i)).length>0)for(let s of n.data)this._writeDictionaryBatch(s,e,i>0),i+=s.length}return this}},Sr=class extends yn{static writeAll(t,e){let n=new Sr(e);return Re(t)?t.then(i=>n.writeAll(i)):Ie(t)?Ya(n,t):Wa(n,t)}},_n=class extends yn{static writeAll(t){let e=new _n;return Re(t)?t.then(n=>e.writeAll(n)):Ie(t)?Ya(e,t):Wa(e,t)}constructor(){super();this._autoDestroy=!0}_writeSchema(t){return this._writeMagic()._writePadding(2)}_writeFooter(t){let e=$r.encode(new $r(t,kt.V4,this._recordBatchBlocks,this._dictionaryBlocks));return super._writeFooter(t)._write(e)._write(Int32Array.of(e.byteLength))._writeMagic()}};function Wa(r,t){let e=t;t instanceof Bt&&(e=t.batches,r.reset(void 0,t.schema));for(let n of e)r.write(n);return r.finish()}function Ya(r,t){var e,n,i,s;return I(this,void 0,void 0,function*(){try{for(e=Se(t);n=yield e.next(),!n.done;){let o=n.value;r.write(o)}}catch(o){i={error:o}}finally{try{n&&!n.done&&(s=e.return)&&(yield s.call(e))}finally{if(i)throw i.error}}return r.finish()})}function zu(r,t){if(Ie(r))return gy(r,t);if(Ue(r))return by(r,t);throw new Error("toDOMStream() must be called with an Iterable or AsyncIterable")}function by(r,t){let e=null,n=(t==null?void 0:t.type)==="bytes"||!1,i=(t==null?void 0:t.highWaterMark)||Math.pow(2,24);return new ReadableStream(Object.assign(Object.assign({},t),{start(o){s(o,e||(e=r[Symbol.iterator]()))},pull(o){e?s(o,e):o.close()},cancel(){((e==null?void 0:e.return)&&e.return()||!0)&&(e=null)}}),Object.assign({highWaterMark:n?i:void 0},t));function s(o,a){let c,d=null,p=o.desiredSize||null;for(;!(d=a.next(n?p:null)).done;)if(ArrayBuffer.isView(d.value)&&(c=O(d.value))&&(p!=null&&n&&(p=p-c.byteLength+1),d.value=c),o.enqueue(d.value),p!=null&&--p<=0)return;o.close()}}function gy(r,t){let e=null,n=(t==null?void 0:t.type)==="bytes"||!1,i=(t==null?void 0:t.highWaterMark)||Math.pow(2,24);return new ReadableStream(Object.assign(Object.assign({},t),{start(o){return I(this,void 0,void 0,function*(){yield s(o,e||(e=r[Symbol.asyncIterator]()))})},pull(o){return I(this,void 0,void 0,function*(){e?yield s(o,e):o.close()})},cancel(){return I(this,void 0,void 0,function*(){((e==null?void 0:e.return)&&(yield e.return())||!0)&&(e=null)})}}),Object.assign({highWaterMark:n?i:void 0},t));function s(o,a){return I(this,void 0,void 0,function*(){let c,d=null,p=o.desiredSize||null;for(;!(d=yield a.next(n?p:null)).done;)if(ArrayBuffer.isView(d.value)&&(c=O(d.value))&&(p!=null&&n&&(p=p-c.byteLength+1),d.value=c),o.enqueue(d.value),p!=null&&--p<=0)return;o.close()})}}function Yu(r){return new $u(r)}var $u=class{constructor(t){this._numChunks=0,this._finished=!1,this._bufferedSize=0;let{["readableStrategy"]:e,["writableStrategy"]:n,["queueingStrategy"]:i="count"}=t,s=qc(t,["readableStrategy","writableStrategy","queueingStrategy"]);this._controller=null,this._builder=dn(s),this._getSize=i!=="bytes"?ju:Wu;let{["highWaterMark"]:o=i==="bytes"?Math.pow(2,14):1e3}=Object.assign({},e),{["highWaterMark"]:a=i==="bytes"?Math.pow(2,14):1e3}=Object.assign({},n);this.readable=new ReadableStream({cancel:()=>{this._builder.clear()},pull:c=>{this._maybeFlush(this._builder,this._controller=c)},start:c=>{this._maybeFlush(this._builder,this._controller=c)}},{highWaterMark:o,size:i!=="bytes"?ju:Wu}),this.writable=new WritableStream({abort:()=>{this._builder.clear()},write:()=>{this._maybeFlush(this._builder,this._controller)},close:()=>{this._maybeFlush(this._builder.finish(),this._controller)}},{highWaterMark:a,size:c=>this._writeValueAndReturnChunkSize(c)})}_writeValueAndReturnChunkSize(t){let e=this._bufferedSize;return this._bufferedSize=this._getSize(this._builder.append(t)),this._bufferedSize-e}_maybeFlush(t,e){e!=null&&(this._bufferedSize>=e.desiredSize&&++this._numChunks&&this._enqueue(e,t.toVector()),t.finished&&((t.length>0||this._numChunks===0)&&++this._numChunks&&this._enqueue(e,t.toVector()),!this._finished&&(this._finished=!0)&&this._enqueue(e,null)))}_enqueue(t,e){this._bufferedSize=0,this._controller=null,e==null?t.close():t.enqueue(e)}},ju=r=>{var t;return(t=r==null?void 0:r.length)!==null&&t!==void 0?t:0},Wu=r=>{var t;return(t=r==null?void 0:r.byteLength)!==null&&t!==void 0?t:0};function ao(r,t){let e=new br,n=null,i=new ReadableStream({cancel(){return I(this,void 0,void 0,function*(){yield e.close()})},start(a){return I(this,void 0,void 0,function*(){yield o(a,n||(n=yield s()))})},pull(a){return I(this,void 0,void 0,function*(){n?yield o(a,n):a.close()})}});return{writable:new WritableStream(e,Object.assign({highWaterMark:Math.pow(2,14)},r)),readable:i};function s(){return I(this,void 0,void 0,function*(){return yield(yield Tt.from(e)).open(t)})}function o(a,c){return I(this,void 0,void 0,function*(){let d=a.desiredSize,p=null;for(;!(p=yield c.next()).done;)if(a.enqueue(p.value),d!=null&&--d<=0)return;a.close()})}}function co(r,t){let e=new this(r),n=new pe(e),i=new ReadableStream({cancel(){return I(this,void 0,void 0,function*(){yield n.cancel()})},pull(o){return I(this,void 0,void 0,function*(){yield s(o)})},start(o){return I(this,void 0,void 0,function*(){yield s(o)})}},Object.assign({highWaterMark:Math.pow(2,14)},t));return{writable:new WritableStream(e,r),readable:i};function s(o){return I(this,void 0,void 0,function*(){let a=null,c=o.desiredSize;for(;a=yield n.read(c||null);)if(o.enqueue(a),c!=null&&(c-=a.byteLength)<=0)return;o.close()})}}var Iy=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},No),ua),na),$o),Mo),ra),{compareSchemas:fn,compareFields:mu,compareTypes:yu});Lt.toDOMStream=zu;_t.throughDOM=Yu;Tt.throughDOM=ao;mn.throughDOM=ao;vr.throughDOM=ao;yn.throughDOM=co;_n.throughDOM=co;Sr.throughDOM=co;function Wn(r){switch(r.typeId){case h.Binary:return{sqlType:"binary"};case h.Bool:return{sqlType:"bool"};case h.Date:return{sqlType:"date"};case h.DateDay:return{sqlType:"date32[d]"};case h.DateMillisecond:return{sqlType:"date64[ms]"};case h.Decimal:{let t=r;return{sqlType:"decimal",precision:t.precision,scale:t.scale}}case h.Float:return{sqlType:"float"};case h.Float16:return{sqlType:"float16"};case h.Float32:return{sqlType:"float32"};case h.Float64:return{sqlType:"float64"};case h.Int:return{sqlType:"int32"};case h.Int16:return{sqlType:"int16"};case h.Int32:return{sqlType:"int32"};case h.Int64:return{sqlType:"int64"};case h.Uint16:return{sqlType:"uint16"};case h.Uint32:return{sqlType:"uint32"};case h.Uint64:return{sqlType:"uint64"};case h.Uint8:return{sqlType:"uint8"};case h.IntervalDayTime:return{sqlType:"interval[dt]"};case h.IntervalYearMonth:return{sqlType:"interval[m]"};case h.List:return{sqlType:"list",valueType:Wn(r.valueType)};case h.FixedSizeBinary:return{sqlType:"fixedsizebinary",byteWidth:r.byteWidth};case h.Null:return{sqlType:"null"};case h.Utf8:return{sqlType:"utf8"};case h.Struct:return{sqlType:"struct",fields:r.children.map(e=>lo(e.name,e.type))};case h.Map:{let t=r;return{sqlType:"map",keyType:Wn(t.keyType),valueType:Wn(t.valueType)}}case h.Time:return{sqlType:"time[s]"};case h.TimeMicrosecond:return{sqlType:"time[us]"};case h.TimeMillisecond:return{sqlType:"time[ms]"};case h.TimeNanosecond:return{sqlType:"time[ns]"};case h.TimeSecond:return{sqlType:"time[s]"};case h.Timestamp:return{sqlType:"timestamp",timezone:r.timezone||void 0};case h.TimestampSecond:return{sqlType:"timestamp[s]",timezone:r.timezone||void 0};case h.TimestampMicrosecond:return{sqlType:"timestamp[us]",timezone:r.timezone||void 0};case h.TimestampNanosecond:return{sqlType:"timestamp[ns]",timezone:r.timezone||void 0};case h.TimestampMillisecond:return{sqlType:"timestamp[ms]",timezone:r.timezone||void 0}}throw new Error(`unsupported arrow type: ${r.toString()}`)}function lo(r,t){let e=Wn(t);return e.name=r,e}var $a=class{constructor(){this._bindings=null;this._nextMessageId=0}log(t){this.postMessage({messageId:this._nextMessageId++,requestId:0,type:"LOG",data:t},[])}sendOK(t){this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"OK",data:null},[])}failWith(t,e){let n={name:e.name,message:e.message,stack:e.stack||void 0};this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"ERROR",data:n},[])}async onMessage(t){switch(t.type){case"PING":this.sendOK(t);return;case"INSTANTIATE":this._bindings!=null&&this.failWith(t,new Error("duckdb already initialized"));try{this._bindings=await this.instantiate(t.data[0],t.data[1],e=>{this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"INSTANTIATE_PROGRESS",data:e},[])}),this.sendOK(t)}catch(e){this._bindings=null,this.failWith(t,e)}return;default:break}if(!this._bindings)return this.failWith(t,new Error("duckdb is not initialized"));try{switch(t.type){case"GET_VERSION":this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"VERSION_STRING",data:this._bindings.getVersion()},[]);break;case"GET_FEATURE_FLAGS":this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"FEATURE_FLAGS",data:this._bindings.getFeatureFlags()},[]);break;case"RESET":this._bindings.reset(),this.sendOK(t);break;case"OPEN":this._bindings.open(t.data),this.sendOK(t);break;case"DROP_FILE":this._bindings.dropFile(t.data),this.sendOK(t);break;case"DROP_FILES":this._bindings.dropFiles(),this.sendOK(t);break;case"FLUSH_FILES":this._bindings.flushFiles(),this.sendOK(t);break;case"CONNECT":{let e=this._bindings.connect();this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"CONNECTION_INFO",data:e.useUnsafe((n,i)=>i)},[]);break}case"DISCONNECT":this._bindings.disconnect(t.data),this.sendOK(t);break;case"CREATE_PREPARED":{let e=this._bindings.createPrepared(t.data[0],t.data[1]);this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"PREPARED_STATEMENT_ID",data:e},[]);break}case"CLOSE_PREPARED":{this._bindings.closePrepared(t.data[0],t.data[1]),this.sendOK(t);break}case"RUN_PREPARED":{let e=this._bindings.runPrepared(t.data[0],t.data[1],t.data[2]);this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"QUERY_RESULT",data:e},[e.buffer]);break}case"RUN_QUERY":{let e=this._bindings.runQuery(t.data[0],t.data[1]);this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"QUERY_RESULT",data:e},[e.buffer]);break}case"SEND_PREPARED":{let e=this._bindings.sendPrepared(t.data[0],t.data[1],t.data[2]);this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"QUERY_START",data:e},[e.buffer]);break}case"SEND_QUERY":{let e=this._bindings.sendQuery(t.data[0],t.data[1]);this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"QUERY_START",data:e},[e.buffer]);break}case"FETCH_QUERY_RESULTS":{let e=this._bindings.fetchQueryResults(t.data);this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"QUERY_RESULT_CHUNK",data:e},[e.buffer]);break}case"GET_TABLE_NAMES":{let e=this._bindings.getTableNames(t.data[0],t.data[1]);this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"TABLE_NAMES",data:e},[]);break}case"GLOB_FILE_INFOS":{let e=this._bindings.globFiles(t.data);this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"FILE_INFOS",data:e},[]);break}case"REGISTER_FILE_URL":this._bindings.registerFileURL(t.data[0],t.data[1]),this.sendOK(t);break;case"REGISTER_FILE_BUFFER":this._bindings.registerFileBuffer(t.data[0],t.data[1]),this.sendOK(t);break;case"REGISTER_FILE_HANDLE":this._bindings.registerFileHandle(t.data[0],t.data[1]),this.sendOK(t);break;case"COPY_FILE_TO_PATH":this._bindings.copyFileToPath(t.data[0],t.data[1]),this.sendOK(t);break;case"COPY_FILE_TO_BUFFER":{let e=this._bindings.copyFileToBuffer(t.data);this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"FILE_BUFFER",data:e},[]);break}case"COLLECT_FILE_STATISTICS":this._bindings.collectFileStatistics(t.data[0],t.data[1]),this.sendOK(t);break;case"EXPORT_FILE_STATISTICS":{this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"FILE_STATISTICS",data:this._bindings.exportFileStatistics(t.data)},[]);break}case"INSERT_ARROW_FROM_IPC_STREAM":{this._bindings.insertArrowFromIPCStream(t.data[0],t.data[1],t.data[2]),this.sendOK(t);break}case"IMPORT_CSV_FROM_PATH":{this._bindings.insertCSVFromPath(t.data[0],t.data[1],t.data[2]),this.sendOK(t);break}case"IMPORT_JSON_FROM_PATH":{this._bindings.insertJSONFromPath(t.data[0],t.data[1],t.data[2]),this.sendOK(t);break}case"TOKENIZE":{let e=this._bindings.tokenize(t.data);this.postMessage({messageId:this._nextMessageId++,requestId:t.messageId,type:"SCRIPT_TOKENS",data:e},[]);break}}}catch(e){return this.failWith(t,e)}}};var Ku={},By=(()=>{var r=Ku.url;return function(t){t=t||{};var e=typeof t<"u"?t:{},n=Object.assign,i,s;e.ready=new Promise(function(l,u){i=l,s=u});var o=n({},e),a=[],c="./this.program",d=(l,u)=>{throw u},p=typeof window=="object",_=typeof importScripts=="function",g=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",w="";function q(l){return e.locateFile?e.locateFile(l,w):w+l}var G,yt,lt,Zt;function We(l){if(l instanceof $i)return;ie("exiting due to exception: "+l)}var tn,Ir,$n;g?(_?w=Xa().dirname(w)+"/":w=__dirname+"/",$n=function(){Ir||(tn=Gu(),Ir=Xa())},G=function(u,f){return $n(),u=Ir.normalize(u),tn.readFileSync(u,f?null:"utf8")},lt=function(u){var f=G(u,!0);return f.buffer||(f=new Uint8Array(f)),f},yt=function(u,f,m){$n(),u=Ir.normalize(u),tn.readFile(u,function(y,B){y?m(y):f(B.buffer)})},process.argv.length>1&&(c=process.argv[1].replace(/\\/g,"/")),a=process.argv.slice(2),process.on("uncaughtException",function(l){if(!(l instanceof $i))throw l}),process.on("unhandledRejection",function(l){throw l}),d=(l,u)=>{if(po())throw process.exitCode=l,u;We(u),process.exit(l)},e.inspect=function(){return"[Emscripten Module object]"}):(p||_)&&(_?w=self.location.href:typeof document<"u"&&document.currentScript&&(w=document.currentScript.src),r&&(w=r),w.indexOf("blob:")!==0?w=w.substr(0,w.replace(/[?#].*/,"").lastIndexOf("/")+1):w="",G=function(l){var u=new XMLHttpRequest;return u.open("GET",l,!1),u.send(null),u.responseText},_&&(lt=function(l){var u=new XMLHttpRequest;return u.open("GET",l,!1),u.responseType="arraybuffer",u.send(null),new Uint8Array(u.response)}),yt=function(l,u,f){var m=new XMLHttpRequest;m.open("GET",l,!0),m.responseType="arraybuffer",m.onload=function(){if(m.status==200||m.status==0&&m.response){u(m.response);return}f()},m.onerror=f,m.send(null)},Zt=l=>document.title=l);var Ri=e.print||console.log.bind(console),ie=e.printErr||console.warn.bind(console);n(e,o),o=null,e.arguments&&(a=e.arguments),e.thisProgram&&(c=e.thisProgram),e.quit&&(d=e.quit);var gt;e.wasmBinary&&(gt=e.wasmBinary);var Qt=e.noExitRuntime||!0;typeof WebAssembly!="object"&&Oe("no native wasm support detected");var Dt,Ye=!1,Br;function De(l,u){l||Oe(u)}function Ut(l){var u=e["_"+l];return u}function Ee(l,u,f,m,y){var B={string:function(It){var Me=0;if(It!=null&&It!==0){var $e=(It.length<<2)+1;Me=Io($e),ho(It,Me,$e)}return Me},array:function(It){var Me=Io(It.length);return nc(It,Me),Me}};function S(It){return u==="string"?or(It):u==="boolean"?Boolean(It):It}var v=Ut(l),T=[],ot=0;if(m)for(var nt=0;nt<m.length;nt++){var we=B[f[nt]];we?(ot===0&&(ot=wc()),T[nt]=we(m[nt])):T[nt]=m[nt]}var ut=v.apply(null,T);function ve(It){return ot!==0&&vc(ot),S(It)}return ut=ve(ut),ut}var Xn=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function ec(l,u,f){for(var m=u+f,y=u;l[y]&&!(y>=m);)++y;if(y-u>16&&l.subarray&&Xn)return Xn.decode(l.subarray(u,y));for(var B="";u<y;){var S=l[u++];if(!(S&128)){B+=String.fromCharCode(S);continue}var v=l[u++]&63;if((S&224)==192){B+=String.fromCharCode((S&31)<<6|v);continue}var T=l[u++]&63;if((S&240)==224?S=(S&15)<<12|v<<6|T:S=(S&7)<<18|v<<12|T<<6|l[u++]&63,S<65536)B+=String.fromCharCode(S);else{var ot=S-65536;B+=String.fromCharCode(55296|ot>>10,56320|ot&1023)}}return B}function or(l,u){return l?ec(Fr,l,u):""}function rc(l,u,f,m){if(!(m>0))return 0;for(var y=f,B=f+m-1,S=0;S<l.length;++S){var v=l.charCodeAt(S);if(v>=55296&&v<=57343){var T=l.charCodeAt(++S);v=65536+((v&1023)<<10)|T&1023}if(v<=127){if(f>=B)break;u[f++]=v}else if(v<=2047){if(f+1>=B)break;u[f++]=192|v>>6,u[f++]=128|v&63}else if(v<=65535){if(f+2>=B)break;u[f++]=224|v>>12,u[f++]=128|v>>6&63,u[f++]=128|v&63}else{if(f+3>=B)break;u[f++]=240|v>>18,u[f++]=128|v>>12&63,u[f++]=128|v>>6&63,u[f++]=128|v&63}}return u[f]=0,f-y}function ho(l,u,f){return rc(l,Fr,u,f)}function cd(l){for(var u=0,f=0;f<l.length;++f){var m=l.charCodeAt(f);m>=55296&&m<=57343&&(m=65536+((m&1023)<<10)|l.charCodeAt(++f)&1023),m<=127?++u:m<=2047?u+=2:m<=65535?u+=3:u+=4}return u}function nc(l,u){Gn.set(l,u)}function ld(l,u,f){for(var m=0;m<l.length;++m)Gn[u++>>0]=l.charCodeAt(m);f||(Gn[u>>0]=0)}function ud(l,u){return l%u>0&&(l+=u-l%u),l}var ic,Gn,Fr,Kn,sc,F,dd,fd,hd;function oc(l){ic=l,e.HEAP8=Gn=new Int8Array(l),e.HEAP16=Kn=new Int16Array(l),e.HEAP32=F=new Int32Array(l),e.HEAPU8=Fr=new Uint8Array(l),e.HEAPU16=sc=new Uint16Array(l),e.HEAPU32=dd=new Uint32Array(l),e.HEAPF32=fd=new Float32Array(l),e.HEAPF64=hd=new Float64Array(l)}var Uy=e.INITIAL_MEMORY||16777216,ac,cc=[],lc=[],pd=[],uc=[],md=!1,yd=!1,_d=0;function po(){return Qt||_d>0}function bd(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)Id(e.preRun.shift());Ui(cc)}function gd(){md=!0,Ui(lc)}function wd(){Ui(pd)}function vd(){yd=!0}function Sd(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)Fd(e.postRun.shift());Ui(uc)}function Id(l){cc.unshift(l)}function Bd(l){lc.unshift(l)}function Fd(l){uc.unshift(l)}var en=0,mo=null,Jn=null;function Ad(l){en++,e.monitorRunDependencies&&e.monitorRunDependencies(en)}function xd(l){if(en--,e.monitorRunDependencies&&e.monitorRunDependencies(en),en==0&&(mo!==null&&(clearInterval(mo),mo=null),Jn)){var u=Jn;Jn=null,u()}}e.preloadedImages={},e.preloadedAudios={};function Oe(l){e.onAbort&&e.onAbort(l),l="Aborted("+l+")",ie(l),Ye=!0,Br=1,l+=". Build with -s ASSERTIONS=1 for more info.";var u=new WebAssembly.RuntimeError(l);throw s(u),u}var Td="data:application/octet-stream;base64,";function dc(l){return l.startsWith(Td)}var be;e.locateFile?(be="./duckdb-eh.wasm",dc(be)||(be=q(be))):be=new URL("./duckdb-eh.wasm",Ku.url).toString();function fc(l){try{if(l==be&&gt)return new Uint8Array(gt);if(lt)return lt(l);throw"both async and sync fetching of the wasm failed"}catch(u){Oe(u)}}function Dd(){return!gt&&(p||_)&&typeof fetch=="function"?fetch(be,{credentials:"same-origin"}).then(function(l){if(!l.ok)throw"failed to load wasm binary file at '"+be+"'";return l.arrayBuffer()}).catch(function(){return fc(be)}):Promise.resolve().then(function(){return fc(be)})}function Ed(){var l={a:Wf};function u(S,v){var T=S.exports;e.asm=T,Dt=e.asm.ea,oc(Dt.buffer),ac=e.asm.ha,Bd(e.asm.fa),xd("wasm-instantiate")}Ad("wasm-instantiate");function f(S){u(S.instance)}function m(S){return Dd().then(function(v){return WebAssembly.instantiate(v,l)}).then(function(v){return v}).then(S,function(v){ie("failed to asynchronously prepare wasm: "+v),Oe(v)})}function y(){return!gt&&typeof WebAssembly.instantiateStreaming=="function"&&!dc(be)&&typeof fetch=="function"?fetch(be,{credentials:"same-origin"}).then(function(S){var v=WebAssembly.instantiateStreaming(S,l);return v.then(f,function(T){return ie("wasm streaming compile failed: "+T),ie("falling back to ArrayBuffer instantiation"),m(f)})}):m(f)}if(e.instantiateWasm)try{var B=e.instantiateWasm(l,u);return B}catch(S){return ie("Module.instantiateWasm callback failed with error: "+S),!1}return y().catch(s),{}}function Ui(l){for(;l.length>0;){var u=l.shift();if(typeof u=="function"){u(e);continue}var f=u.func;typeof f=="number"?u.arg===void 0?hc(f)():hc(f)(u.arg):f(u.arg===void 0?null:u.arg)}}var Ni=[];function hc(l){var u=Ni[l];return u||(l>=Ni.length&&(Ni.length=l+1),Ni[l]=u=ac.get(l)),u}function Od(l){if(l instanceof $i||l=="unwind")return Br;d(1,l)}function Md(l,u,f,m){Oe("Assertion failed: "+or(l)+", at: "+[u?or(u):"unknown filename",f,m?or(m):"unknown function"])}var Nt={mappings:{},buffers:[null,[],[]],printChar:function(l,u){var f=Nt.buffers[l];u===0||u===10?((l===1?Ri:ie)(ec(f,0)),f.length=0):f.push(u)},varargs:void 0,get:function(){Nt.varargs+=4;var l=F[Nt.varargs-4>>2];return l},getStr:function(l){var u=or(l);return u},get64:function(l,u){return l}};function Rd(l,u,f,m,y){}function Ud(l,u){return l=Nt.getStr(l),Nt.doAccess(l,u)}function Nd(){ie("missing function: $SOCKFS"),Oe(-1)}function pc(){ie("missing function: $FS"),Oe(-1)}function qn(l){var u=Nd.getSocket(l);if(!u)throw new pc.ErrnoError(8);return u}function kd(l){return F[gc()>>2]=l,l}function yo(l){return(l&255)+"."+(l>>8&255)+"."+(l>>16&255)+"."+(l>>24&255)}function mc(l){var u="",f=0,m=0,y=0,B=0,S=0,v=0,T=[l[0]&65535,l[0]>>16,l[1]&65535,l[1]>>16,l[2]&65535,l[2]>>16,l[3]&65535,l[3]>>16],ot=!0,nt="";for(v=0;v<5;v++)if(T[v]!==0){ot=!1;break}if(ot){if(nt=yo(T[6]|T[7]<<16),T[5]===-1)return u="::ffff:",u+=nt,u;if(T[5]===0)return u="::",nt==="0.0.0.0"&&(nt=""),nt==="0.0.0.1"&&(nt="1"),u+=nt,u}for(f=0;f<8;f++)T[f]===0&&(f-y>1&&(S=0),y=f,S++),S>m&&(m=S,B=f-m+1);for(f=0;f<8;f++){if(m>1&&T[f]===0&&f>=B&&f<B+m){f===B&&(u+=":",B===0&&(u+=":"));continue}u+=Number(So(T[f]&65535)).toString(16),u+=f<7?":":""}return u}function yc(l,u){var f=Kn[l>>1],m=So(sc[l+2>>1]),y;switch(f){case 2:if(u!==16)return{errno:28};y=F[l+4>>2],y=yo(y);break;case 10:if(u!==28)return{errno:28};y=[F[l+8>>2],F[l+12>>2],F[l+16>>2],F[l+20>>2]],y=mc(y);break;default:return{errno:5}}return{family:f,addr:y,port:m}}function ki(l){for(var u=l.split("."),f=0;f<4;f++){var m=Number(u[f]);if(isNaN(m))return null;u[f]=m}return(u[0]|u[1]<<8|u[2]<<16|u[3]<<24)>>>0}function Li(l){return parseInt(l)}function _o(l){var u,f,m,y,B=/^((?=.*::)(?!.*::.+::)(::)?([\dA-F]{1,4}:(:|\b)|){5}|([\dA-F]{1,4}:){6})((([\dA-F]{1,4}((?!\3)::|:\b|$))|(?!\2\3)){2}|(((2[0-4]|1\d|[1-9])?\d|25[0-5])\.?\b){4})$/i,S=[];if(!B.test(l))return null;if(l==="::")return[0,0,0,0,0,0,0,0];for(l.startsWith("::")?l=l.replace("::","Z:"):l=l.replace("::",":Z:"),l.indexOf(".")>0?(l=l.replace(new RegExp("[.]","g"),":"),u=l.split(":"),u[u.length-4]=Li(u[u.length-4])+Li(u[u.length-3])*256,u[u.length-3]=Li(u[u.length-2])+Li(u[u.length-1])*256,u=u.slice(0,u.length-2)):u=l.split(":"),m=0,y=0,f=0;f<u.length;f++)if(typeof u[f]=="string")if(u[f]==="Z"){for(y=0;y<8-u.length+1;y++)S[f+y]=0;m=y-1}else S[f+m]=Wi(parseInt(u[f],16));else S[f+m]=u[f];return[S[1]<<16|S[0],S[3]<<16|S[2],S[5]<<16|S[4],S[7]<<16|S[6]]}var ge={address_map:{id:1,addrs:{},names:{}},lookup_name:function(l){var u=ki(l);if(u!==null||(u=_o(l),u!==null))return l;var f;if(ge.address_map.addrs[l])f=ge.address_map.addrs[l];else{var m=ge.address_map.id++;De(m<65535,"exceeded max address mappings of 65535"),f="172.29."+(m&255)+"."+(m&65280),ge.address_map.names[f]=l,ge.address_map.addrs[l]=f}return f},lookup_addr:function(l){return ge.address_map.names[l]?ge.address_map.names[l]:null}};function _c(l,u,f){if(f&&l===0)return null;var m=yc(l,u);if(m.errno)throw new pc.ErrnoError(m.errno);return m.addr=ge.lookup_addr(m.addr)||m.addr,m}function Ld(l,u,f){var m=qn(l),y=_c(u,f);return m.sock_ops.bind(m,y.addr,y.port),0}function Cd(l,u,f){var m=qn(l),y=_c(u,f);return m.sock_ops.connect(m,y.addr,y.port),0}function Pd(l,u,f){return Nt.varargs=f,0}function Vd(l,u){}function Hd(l,u,f,m){}function zd(l,u,f){}function jd(l,u,f){}function bc(l,u){Fr.fill(0,l,l+u)}function bo(l,u,f,m,y){switch(u){case 2:f=ki(f),bc(l,16),y&&(F[y>>2]=16),Kn[l>>1]=u,F[l+4>>2]=f,Kn[l+2>>1]=Wi(m);break;case 10:f=_o(f),bc(l,28),y&&(F[y>>2]=28),F[l>>2]=u,F[l+8>>2]=f[0],F[l+12>>2]=f[1],F[l+16>>2]=f[2],F[l+20>>2]=f[3],Kn[l+2>>1]=Wi(m);break;default:return 5}return 0}function Wd(l,u,f){var m=qn(l);if(!m.daddr)return-53;var y=bo(u,m.family,ge.lookup_name(m.daddr),m.dport,f);return 0}function Yd(l,u,f,m,y){var B=qn(l);return u===1&&f===4?(F[m>>2]=B.error,F[y>>2]=4,B.error=null,0):-50}function $d(l,u,f){return Nt.varargs=f,0}function Xd(l,u){}function Gd(l,u){return l=Nt.getStr(l),Nt.doMkdir(l,u)}function Kd(l,u,f){Nt.varargs=f}function Jd(l,u,f,m,y,B){var S=qn(l),v=S.sock_ops.recvmsg(S,f);if(!v)return 0;if(y)var T=bo(y,S.family,ge.lookup_name(v.addr),v.port,B);return Fr.set(v.buffer,u),v.buffer.byteLength}function qd(l,u){}function Zd(l){}function Qd(l,u,f,m,y,B){}function tf(l,u,f){}function ef(l,u){}function rf(l){}function nf(l,u){Oe("To use dlopen, you need to use Emscripten's linking support, see https://github.com/emscripten-core/emscripten/wiki/Linking")}function sf(l,u){Oe("To use dlopen, you need to use Emscripten's linking support, see https://github.com/emscripten-core/emscripten/wiki/Linking")}function of(){Oe("")}var go;g?go=()=>{var l=process.hrtime();return l[0]*1e3+l[1]/1e6}:go=()=>performance.now();var af=!0;function cf(l,u){var f;if(l===0)f=Date.now();else if((l===1||l===4)&&af)f=go();else return kd(28),-1;return F[u>>2]=f/1e3|0,F[u+4>>2]=f%1e3*1e3*1e3|0,0}function lf(l,u){return globalThis.DUCKDB_RUNTIME.createDirectory(e,l,u)}function uf(l,u){return globalThis.DUCKDB_RUNTIME.checkDirectory(e,l,u)}function df(l,u){return globalThis.DUCKDB_RUNTIME.listDirectoryEntries(e,l,u)}function ff(l,u){return globalThis.DUCKDB_RUNTIME.removeDirectory(e,l,u)}function hf(l){return globalThis.DUCKDB_RUNTIME.closeFile(e,l)}function pf(l,u){return globalThis.DUCKDB_RUNTIME.checkFile(e,l,u)}function mf(l){return globalThis.DUCKDB_RUNTIME.getLastFileModificationTime(e,l)}function yf(l,u,f,m){return globalThis.DUCKDB_RUNTIME.moveFile(e,l,u,f,m)}function _f(l,u){return globalThis.DUCKDB_RUNTIME.openFile(e,l,u)}function bf(l,u,f,m){return globalThis.DUCKDB_RUNTIME.readFile(e,l,u,f,m)}function gf(l,u){return globalThis.DUCKDB_RUNTIME.truncateFile(e,l,u)}function wf(l,u,f,m){return globalThis.DUCKDB_RUNTIME.writeFile(e,l,u,f,m)}function vf(l,u){return globalThis.DUCKDB_RUNTIME.glob(e,l,u)}function Sf(l){return globalThis.DUCKDB_RUNTIME.testPlatformFeature(e,l)}function If(l,u,f,m,y,B){return globalThis.DUCKDB_RUNTIME.callScalarUDF(e,l,u,f,m,y,B)}function Bf(){return 2147483648}function Ff(l,u,f){Fr.copyWithin(l,u,u+f)}function Af(l){try{return Dt.grow(l-ic.byteLength+65535>>>16),oc(Dt.buffer),1}catch(u){}}function xf(l){var u=Fr.length;l=l>>>0;var f=2147483648;if(l>f)return!1;for(var m=1;m<=4;m*=2){var y=u*(1+.2/m);y=Math.min(y,l+100663296);var B=Math.min(f,ud(Math.max(l,y),65536)),S=Af(B);if(S)return!0}return!1}var wo={};function Tf(){return c||"./this.program"}function Zn(){if(!Zn.strings){var l=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",u={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:l,_:Tf()};for(var f in wo)wo[f]===void 0?delete u[f]:u[f]=wo[f];var m=[];for(var f in u)m.push(f+"="+u[f]);Zn.strings=m}return Zn.strings}function Df(l,u){var f=0;return Zn().forEach(function(m,y){var B=u+f;F[l+y*4>>2]=B,ld(m,B),f+=m.length+1}),0}function Ef(l,u){var f=Zn();F[l>>2]=f.length;var m=0;return f.forEach(function(y){m+=y.length+1}),F[u>>2]=m,0}function Of(l){return 0}function Mf(l,u,f,m,y,B){var S=Nt.getStreamFromFD(l),v=Nt.doReadv(S,u,f,m);return F[B>>2]=v,0}function Rf(l,u,f,m,y,B){var S=Nt.getStreamFromFD(l),v=Nt.doWritev(S,u,f,m);return F[B>>2]=v,0}function Uf(l,u,f,m){var y=Nt.getStreamFromFD(l),B=Nt.doReadv(y,u,f);return F[m>>2]=B,0}function Nf(l,u,f,m,y){}function kf(l){var u=Nt.getStreamFromFD(l);return u.stream_ops&&u.stream_ops.fsync?-u.stream_ops.fsync(u):0}function Lf(l,u,f,m){for(var y=0,B=0;B<f;B++){var S=F[u>>2],v=F[u+4>>2];u+=8;for(var T=0;T<v;T++)Nt.printChar(l,Fr[S+T]);y+=v}return F[m>>2]=y,0}function Cf(l,u,f,m){var y=0,B=0,S=0,v=0,T=0,ot=0,nt;function we(ut,ve,It,Me,$e,Qn){var b,D,et,it;return D=ut===10?28:16,$e=ut===10?mc($e):yo($e),b=Bo(D),it=bo(b,ut,$e,Qn),De(!it),et=Bo(32),F[et+4>>2]=ut,F[et+8>>2]=ve,F[et+12>>2]=It,F[et+24>>2]=Me,F[et+20>>2]=b,ut===10?F[et+16>>2]=28:F[et+16>>2]=16,F[et+28>>2]=0,et}if(f&&(S=F[f>>2],v=F[f+4>>2],T=F[f+8>>2],ot=F[f+12>>2]),T&&!ot&&(ot=T===2?17:6),!T&&ot&&(T=ot===17?2:1),ot===0&&(ot=6),T===0&&(T=1),!l&&!u)return-2;if(S&-1088||f!==0&&F[f>>2]&2&&!l)return-1;if(S&32)return-2;if(T!==0&&T!==1&&T!==2)return-7;if(v!==0&&v!==2&&v!==10)return-6;if(u&&(u=or(u),B=parseInt(u,10),isNaN(B)))return S&1024?-2:-8;if(!l)return v===0&&(v=2),(S&1)===0&&(v===2?y=ji(2130706433):y=[0,0,0,1]),nt=we(v,T,ot,null,y,B),F[m>>2]=nt,0;if(l=or(l),y=ki(l),y!==null)if(v===0||v===2)v=2;else if(v===10&&S&8)y=[0,0,ji(65535),y],v=10;else return-2;else if(y=_o(l),y!==null)if(v===0||v===10)v=10;else return-2;return y!=null?(nt=we(v,T,ot,l,y,B),F[m>>2]=nt,0):S&4?-2:(l=ge.lookup_name(l),y=ki(l),v===0?v=2:v===10&&(y=[0,0,ji(65535),y]),nt=we(v,T,ot,null,y,B),F[m>>2]=nt,0)}function Pf(){if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function"){var l=new Uint8Array(1);return function(){return crypto.getRandomValues(l),l[0]}}else if(g)try{var u=zh("crypto");return function(){return u.randomBytes(1)[0]}}catch(f){}return function(){Oe("randomDevice")}}function Ci(l,u){Ci.randomDevice||(Ci.randomDevice=Pf());for(var f=0;f<u;f++)Gn[l+f>>0]=Ci.randomDevice();return 0}function Vf(l,u,f,m,y,B,S){var v=yc(l,u);if(v.errno)return-6;var T=v.port,ot=v.addr,nt=!1;if(f&&m){var we;if(S&1||!(we=ge.lookup_addr(ot))){if(S&8)return-2}else ot=we;var ut=ho(ot,f,m);ut+1>=m&&(nt=!0)}if(y&&B){T=""+T;var ut=ho(T,y,B);ut+1>=B&&(nt=!0)}return nt?-12:0}function Pi(l){return l%4===0&&(l%100!==0||l%400===0)}function vo(l,u){for(var f=0,m=0;m<=u;f+=l[m++]);return f}var Vi=[31,29,31,30,31,30,31,31,30,31,30,31],Hi=[31,28,31,30,31,30,31,31,30,31,30,31];function zi(l,u){for(var f=new Date(l.getTime());u>0;){var m=Pi(f.getFullYear()),y=f.getMonth(),B=(m?Vi:Hi)[y];if(u>B-f.getDate())u-=B-f.getDate()+1,f.setDate(1),y<11?f.setMonth(y+1):(f.setMonth(0),f.setFullYear(f.getFullYear()+1));else return f.setDate(f.getDate()+u),f}return f}function Hf(l,u,f,m){var y=F[m+40>>2],B={tm_sec:F[m>>2],tm_min:F[m+4>>2],tm_hour:F[m+8>>2],tm_mday:F[m+12>>2],tm_mon:F[m+16>>2],tm_year:F[m+20>>2],tm_wday:F[m+24>>2],tm_yday:F[m+28>>2],tm_isdst:F[m+32>>2],tm_gmtoff:F[m+36>>2],tm_zone:y?or(y):""},S=or(f),v={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var T in v)S=S.replace(new RegExp(T,"g"),v[T]);var ot=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],nt=["January","February","March","April","May","June","July","August","September","October","November","December"];function we(b,D,et){for(var it=typeof b=="number"?b.toString():b||"";it.length<D;)it=et[0]+it;return it}function ut(b,D){return we(b,D,"0")}function ve(b,D){function et(Xe){return Xe<0?-1:Xe>0?1:0}var it;return(it=et(b.getFullYear()-D.getFullYear()))===0&&(it=et(b.getMonth()-D.getMonth()))===0&&(it=et(b.getDate()-D.getDate())),it}function It(b){switch(b.getDay()){case 0:return new Date(b.getFullYear()-1,11,29);case 1:return b;case 2:return new Date(b.getFullYear(),0,3);case 3:return new Date(b.getFullYear(),0,2);case 4:return new Date(b.getFullYear(),0,1);case 5:return new Date(b.getFullYear()-1,11,31);case 6:return new Date(b.getFullYear()-1,11,30)}}function Me(b){var D=zi(new Date(b.tm_year+1900,0,1),b.tm_yday),et=new Date(D.getFullYear(),0,4),it=new Date(D.getFullYear()+1,0,4),Xe=It(et),Ar=It(it);return ve(Xe,D)<=0?ve(Ar,D)<=0?D.getFullYear()+1:D.getFullYear():D.getFullYear()-1}var $e={"%a":function(b){return ot[b.tm_wday].substring(0,3)},"%A":function(b){return ot[b.tm_wday]},"%b":function(b){return nt[b.tm_mon].substring(0,3)},"%B":function(b){return nt[b.tm_mon]},"%C":function(b){var D=b.tm_year+1900;return ut(D/100|0,2)},"%d":function(b){return ut(b.tm_mday,2)},"%e":function(b){return we(b.tm_mday,2," ")},"%g":function(b){return Me(b).toString().substring(2)},"%G":function(b){return Me(b)},"%H":function(b){return ut(b.tm_hour,2)},"%I":function(b){var D=b.tm_hour;return D==0?D=12:D>12&&(D-=12),ut(D,2)},"%j":function(b){return ut(b.tm_mday+vo(Pi(b.tm_year+1900)?Vi:Hi,b.tm_mon-1),3)},"%m":function(b){return ut(b.tm_mon+1,2)},"%M":function(b){return ut(b.tm_min,2)},"%n":function(){return`
`},"%p":function(b){return b.tm_hour>=0&&b.tm_hour<12?"AM":"PM"},"%S":function(b){return ut(b.tm_sec,2)},"%t":function(){return"	"},"%u":function(b){return b.tm_wday||7},"%U":function(b){var D=new Date(b.tm_year+1900,0,1),et=D.getDay()===0?D:zi(D,7-D.getDay()),it=new Date(b.tm_year+1900,b.tm_mon,b.tm_mday);if(ve(et,it)<0){var Xe=vo(Pi(it.getFullYear())?Vi:Hi,it.getMonth()-1)-31,Ar=31-et.getDate(),rn=Ar+Xe+it.getDate();return ut(Math.ceil(rn/7),2)}return ve(et,D)===0?"01":"00"},"%V":function(b){var D=new Date(b.tm_year+1900,0,4),et=new Date(b.tm_year+1901,0,4),it=It(D),Xe=It(et),Ar=zi(new Date(b.tm_year+1900,0,1),b.tm_yday);if(ve(Ar,it)<0)return"53";if(ve(Xe,Ar)<=0)return"01";var rn;return it.getFullYear()<b.tm_year+1900?rn=b.tm_yday+32-it.getDate():rn=b.tm_yday+1-it.getDate(),ut(Math.ceil(rn/7),2)},"%w":function(b){return b.tm_wday},"%W":function(b){var D=new Date(b.tm_year,0,1),et=D.getDay()===1?D:zi(D,D.getDay()===0?1:7-D.getDay()+1),it=new Date(b.tm_year+1900,b.tm_mon,b.tm_mday);if(ve(et,it)<0){var Xe=vo(Pi(it.getFullYear())?Vi:Hi,it.getMonth()-1)-31,Ar=31-et.getDate(),rn=Ar+Xe+it.getDate();return ut(Math.ceil(rn/7),2)}return ve(et,D)===0?"01":"00"},"%y":function(b){return(b.tm_year+1900).toString().substring(2)},"%Y":function(b){return b.tm_year+1900},"%z":function(b){var D=b.tm_gmtoff,et=D>=0;return D=Math.abs(D)/60,D=D/60*100+D%60,(et?"+":"-")+String("0000"+D).slice(-4)},"%Z":function(b){return b.tm_zone},"%%":function(){return"%"}};for(var T in $e)S.includes(T)&&(S=S.replace(new RegExp(T,"g"),$e[T](B)));var Qn=jf(S,!1);return Qn.length>u?0:(nc(Qn,l),Qn.length-1)}function zf(l,u,f,m){return Hf(l,u,f,m)}function jf(l,u,f){var m=f>0?f:cd(l)+1,y=new Array(m),B=rc(l,y,0,y.length);return u&&(y.length=B),y}var Wf={a:Md,R:Rd,L:Ud,T:Ld,S:Cd,b:Pd,$:Vd,Z:Hd,W:zd,X:jd,N:Wd,Q:Yd,ba:$d,Y:Xd,aa:Gd,q:Kd,O:Jd,J:qd,o:Zd,P:Qd,k:tf,_:ef,p:rf,m:nf,U:sf,d:of,n:cf,D:lf,E:uf,B:df,C:ff,h:hf,z:pf,G:mf,A:yf,H:_f,f:bf,F:gf,i:wf,y:vf,g:Sf,I:If,r:Bf,ca:Ff,da:xf,t:Df,u:Ef,c:Of,w:Mf,v:Rf,j:Uf,x:Nf,K:kf,e:Lf,l:Cf,V:Ci,M:Vf,s:zf},Ny=Ed(),Yf=e.___wasm_call_ctors=function(){return(Yf=e.___wasm_call_ctors=e.asm.fa).apply(null,arguments)},$f=e._main=function(){return($f=e._main=e.asm.ga).apply(null,arguments)},Xf=e._duckdb_web_fs_glob_add_path=function(){return(Xf=e._duckdb_web_fs_glob_add_path=e.asm.ia).apply(null,arguments)},Gf=e._duckdb_web_clear_response=function(){return(Gf=e._duckdb_web_clear_response=e.asm.ja).apply(null,arguments)},Kf=e._duckdb_web_fail_with=function(){return(Kf=e._duckdb_web_fail_with=e.asm.ka).apply(null,arguments)},Jf=e._duckdb_web_reset=function(){return(Jf=e._duckdb_web_reset=e.asm.la).apply(null,arguments)},qf=e._duckdb_web_connect=function(){return(qf=e._duckdb_web_connect=e.asm.ma).apply(null,arguments)},Zf=e._duckdb_web_disconnect=function(){return(Zf=e._duckdb_web_disconnect=e.asm.na).apply(null,arguments)},Qf=e._duckdb_web_flush_files=function(){return(Qf=e._duckdb_web_flush_files=e.asm.oa).apply(null,arguments)},th=e._duckdb_web_flush_file=function(){return(th=e._duckdb_web_flush_file=e.asm.pa).apply(null,arguments)},eh=e._duckdb_web_open=function(){return(eh=e._duckdb_web_open=e.asm.qa).apply(null,arguments)},rh=e._duckdb_web_get_global_file_info=function(){return(rh=e._duckdb_web_get_global_file_info=e.asm.ra).apply(null,arguments)},nh=e._duckdb_web_collect_file_stats=function(){return(nh=e._duckdb_web_collect_file_stats=e.asm.sa).apply(null,arguments)},ih=e._duckdb_web_export_file_stats=function(){return(ih=e._duckdb_web_export_file_stats=e.asm.ta).apply(null,arguments)},sh=e._duckdb_web_fs_drop_file=function(){return(sh=e._duckdb_web_fs_drop_file=e.asm.ua).apply(null,arguments)},oh=e._duckdb_web_fs_drop_files=function(){return(oh=e._duckdb_web_fs_drop_files=e.asm.va).apply(null,arguments)},ah=e._duckdb_web_fs_glob_file_infos=function(){return(ah=e._duckdb_web_fs_glob_file_infos=e.asm.wa).apply(null,arguments)},ch=e._duckdb_web_fs_get_file_info_by_id=function(){return(ch=e._duckdb_web_fs_get_file_info_by_id=e.asm.xa).apply(null,arguments)},lh=e._duckdb_web_fs_get_file_info_by_name=function(){return(lh=e._duckdb_web_fs_get_file_info_by_name=e.asm.ya).apply(null,arguments)},uh=e._duckdb_web_fs_set_file_descriptor=function(){return(uh=e._duckdb_web_fs_set_file_descriptor=e.asm.za).apply(null,arguments)},dh=e._duckdb_web_fs_register_file_url=function(){return(dh=e._duckdb_web_fs_register_file_url=e.asm.Aa).apply(null,arguments)},fh=e._duckdb_web_fs_register_file_buffer=function(){return(fh=e._duckdb_web_fs_register_file_buffer=e.asm.Ba).apply(null,arguments)},hh=e._duckdb_web_copy_file_to_buffer=function(){return(hh=e._duckdb_web_copy_file_to_buffer=e.asm.Ca).apply(null,arguments)},ph=e._duckdb_web_copy_file_to_path=function(){return(ph=e._duckdb_web_copy_file_to_path=e.asm.Da).apply(null,arguments)},mh=e._duckdb_web_get_version=function(){return(mh=e._duckdb_web_get_version=e.asm.Ea).apply(null,arguments)},yh=e._duckdb_web_get_feature_flags=function(){return(yh=e._duckdb_web_get_feature_flags=e.asm.Fa).apply(null,arguments)},_h=e._duckdb_web_tokenize=function(){return(_h=e._duckdb_web_tokenize=e.asm.Ga).apply(null,arguments)},bh=e._duckdb_web_udf_scalar_create=function(){return(bh=e._duckdb_web_udf_scalar_create=e.asm.Ha).apply(null,arguments)},gh=e._duckdb_web_prepared_create=function(){return(gh=e._duckdb_web_prepared_create=e.asm.Ia).apply(null,arguments)},wh=e._duckdb_web_prepared_close=function(){return(wh=e._duckdb_web_prepared_close=e.asm.Ja).apply(null,arguments)},vh=e._duckdb_web_prepared_run=function(){return(vh=e._duckdb_web_prepared_run=e.asm.Ka).apply(null,arguments)},Sh=e._duckdb_web_prepared_send=function(){return(Sh=e._duckdb_web_prepared_send=e.asm.La).apply(null,arguments)},Ih=e._duckdb_web_query_run=function(){return(Ih=e._duckdb_web_query_run=e.asm.Ma).apply(null,arguments)},Bh=e._duckdb_web_query_send=function(){return(Bh=e._duckdb_web_query_send=e.asm.Na).apply(null,arguments)},Fh=e._duckdb_web_query_fetch_results=function(){return(Fh=e._duckdb_web_query_fetch_results=e.asm.Oa).apply(null,arguments)},Ah=e._duckdb_web_get_tablenames=function(){return(Ah=e._duckdb_web_get_tablenames=e.asm.Pa).apply(null,arguments)},xh=e._duckdb_web_insert_arrow_from_ipc_stream=function(){return(xh=e._duckdb_web_insert_arrow_from_ipc_stream=e.asm.Qa).apply(null,arguments)},Th=e._duckdb_web_insert_csv_from_path=function(){return(Th=e._duckdb_web_insert_csv_from_path=e.asm.Ra).apply(null,arguments)},Dh=e._duckdb_web_insert_json_from_path=function(){return(Dh=e._duckdb_web_insert_json_from_path=e.asm.Sa).apply(null,arguments)},gc=e.___errno_location=function(){return(gc=e.___errno_location=e.asm.Ta).apply(null,arguments)},ji=e._htonl=function(){return(ji=e._htonl=e.asm.Ua).apply(null,arguments)},Wi=e._htons=function(){return(Wi=e._htons=e.asm.Va).apply(null,arguments)},So=e._ntohs=function(){return(So=e._ntohs=e.asm.Wa).apply(null,arguments)},wc=e.stackSave=function(){return(wc=e.stackSave=e.asm.Xa).apply(null,arguments)},vc=e.stackRestore=function(){return(vc=e.stackRestore=e.asm.Ya).apply(null,arguments)},Io=e.stackAlloc=function(){return(Io=e.stackAlloc=e.asm.Za).apply(null,arguments)},Bo=e._malloc=function(){return(Bo=e._malloc=e.asm._a).apply(null,arguments)},Eh=e._free=function(){return(Eh=e._free=e.asm.$a).apply(null,arguments)};e.ccall=Ee;var Yi;function $i(l){this.name="ExitStatus",this.message="Program terminated with exit("+l+")",this.status=l}var Oh=!1;Jn=function l(){Yi||Fo(),Yi||(Jn=l)};function Mh(l){var u=e._main,f=0,m=0;try{var y=u(f,m);return Rh(y,!0),y}catch(B){return Od(B)}finally{Oh=!0}}function Fo(l){if(l=l||a,en>0||(bd(),en>0))return;function u(){Yi||(Yi=!0,e.calledRun=!0,!Ye&&(gd(),wd(),i(e),e.onRuntimeInitialized&&e.onRuntimeInitialized(),Sc&&Mh(l),Sd()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),u()},1)):u()}e.run=Fo;function Rh(l,u){Br=l,po()||vd(),Uh(l)}function Uh(l){Br=l,po()||(e.onExit&&e.onExit(l),Ye=!0),d(l,new $i(l))}if(e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();var Sc=!0;return e.noInitialRun&&(Sc=!1),Fo(),t.ready}})(),Ju=By;var Ga=class{constructor(t,e){this._bindings=t,this._conn=e}close(){this._bindings.disconnect(this._conn)}useUnsafe(t){return t(this._bindings,this._conn)}query(t){let e=this._bindings.runQuery(this._conn,t),n=Tt.from(e);return console.assert(n.isSync()),console.assert(n.isFile()),new Bt(n)}send(t){let e=this._bindings.sendQuery(this._conn,t),n=new Ka(this._bindings,this._conn,e),i=Tt.from(n);return console.assert(i.isSync()),console.assert(i.isStream()),i}getTableNames(t){return this._bindings.getTableNames(this._conn,t)}prepare(t){let e=this._bindings.createPrepared(this._conn,t);return new qu(this._bindings,this._conn,e)}createScalarFunction(t,e,n){this._bindings.createScalarFunction(this._conn,t,e,n)}insertArrowTable(t,e){let n=new Sr;n.writeAll(t);let i=n.toUint8Array(!0);this.insertArrowFromIPCStream(i,e)}insertArrowFromIPCStream(t,e){this._bindings.insertArrowFromIPCStream(this._conn,t,e)}insertCSVFromPath(t,e){this._bindings.insertCSVFromPath(this._conn,t,e)}insertJSONFromPath(t,e){this._bindings.insertJSONFromPath(this._conn,t,e)}},Ka=class{constructor(t,e,n){this.bindings=t;this.conn=e;this.header=n;this._first=!0,this._depleted=!1}next(){if(this._first)return this._first=!1,{done:!1,value:this.header};if(this._depleted)return{done:!0,value:null};let t=this.bindings.fetchQueryResults(this.conn);return this._depleted=t.length==0,{done:this._depleted,value:t}}[Symbol.iterator](){return this}},qu=class{constructor(t,e,n){this.bindings=t,this.connectionId=e,this.statementId=n}close(){this.bindings.closePrepared(this.connectionId,this.statementId)}query(...t){let e=this.bindings.runPrepared(this.connectionId,this.statementId,t),n=Tt.from(e);return console.assert(n.isSync()),console.assert(n.isFile()),new Bt(n)}send(...t){let e=this.bindings.sendPrepared(this.connectionId,this.statementId,t),n=new Ka(this.bindings,this.connectionId,e),i=Tt.from(n);return console.assert(i.isSync()),console.assert(i.isStream()),i}};var ed=new TextEncoder,Zu=new TextDecoder("utf-8");function uo(r,t,e){let n=ed.encode(e),i=r._malloc(n.byteLength),s=r.HEAPU8.subarray(i,i+n.byteLength);s.set(n),r.HEAPF64[(t>>3)+0]=1,r.HEAPF64[(t>>3)+1]=i,r.HEAPF64[(t>>3)+2]=s.byteLength}function Ja(r){switch(r){case"UINT8":case"INT8":return 1;case"INT32":case"FLOAT":return 4;case"INT64":case"UINT64":case"DOUBLE":case"VARCHAR":return 8;default:return 0}}function Qu(r,t,e,n){let i=r.HEAPU8.subarray(t,t+n*Ja(e));switch(e){case"UINT8":return new Uint8Array(i.buffer,i.byteOffset,n);case"INT8":return new Int8Array(i.buffer,i.byteOffset,n);case"INT32":return new Int32Array(i.buffer,i.byteOffset,n);case"FLOAT":return new Float32Array(i.buffer,i.byteOffset,n);case"DOUBLE":return new Float64Array(i.buffer,i.byteOffset,n);case"VARCHAR":return new Float64Array(i.buffer,i.byteOffset,n);default:return new Array(0)}}function td(r,t,e){let n=r.HEAPU8.subarray(t,t+e);return new Uint8Array(n.buffer,n.byteOffset,e)}function fo(r,t,e){let n=r.HEAPU8.subarray(t,t+e*8);return new Float64Array(n.buffer,n.byteOffset,e)}function rd(r,t,e,n,i,s,o,a){try{let c=r._udfFunctions.get(n);if(!c){uo(t,e,"Unknown UDF with id: "+n);return}let d=Zu.decode(t.HEAPU8.subarray(i,i+s)),p=JSON.parse(d),_=fo(t,o,a/8),g=[],w=[];for(let gt=0;gt<p.args.length;++gt){let Qt=p.args[gt],Dt=Qu(t,_[Qt.dataBuffer],Qt.physicalType,p.rows),Ye=td(t,_[Qt.validityBuffer],p.rows);if(Dt.length==0||Ye.length==0){uo(t,e,"Can't create physical arrays for argument "+Qt.physicalType);return}switch(g.push(Ye),Qt.physicalType){case"VARCHAR":{let Br=fo(t,_[Qt.lengthBuffer],p.rows),De=[];for(let Ut=0;Ut<p.rows;++Ut){if(!Ye[Ut]){De.push(null);continue}let Ee=t.HEAPU8.subarray(Dt[Ut],Dt[Ut]+Br[Ut]),Xn=Zu.decode(Ee);De.push(Xn)}w.push(De);break}default:w.push(Dt)}}let q=p.rows*Ja(p.ret.physicalType),G=t._malloc(q),yt=Qu(t,G,p.ret.physicalType,p.rows),lt=t._malloc(p.rows),Zt=td(t,lt,p.rows);if(yt.length==0||Zt.length==0){uo(t,e,"Can't create physical arrays for result");return}let We=yt;p.ret.physicalType=="VARCHAR"&&(We=new Array(p.rows));let tn=[];for(let gt=0;gt<p.args.length;++gt)tn.push(null);for(let gt=0;gt<p.rows;++gt){for(let Dt=0;Dt<p.args.length;++Dt)tn[Dt]=g[Dt][gt]?w[Dt][gt]:null;let Qt=c.func(...tn);We[gt]=Qt,Zt[gt]=Qt==null?0:1}let Ir=0;switch(p.ret.physicalType){case"VARCHAR":{let gt=new Array(0);Ir=t._malloc(p.rows*Ja("DOUBLE"));let Qt=fo(t,Ir,p.rows),Dt=0;for(let Ut=0;Ut<p.rows;++Ut){let Ee=ed.encode(We[Ut]||"");gt.push(Ee),Qt[Ut]=Ee.length,Dt+=Ee.length}let Ye=t._malloc(Dt),Br=t.HEAPU8.subarray(Ye,Ye+Dt),De=0;for(let Ut=0;Ut<p.rows;++Ut){yt[Ut]=De;let Ee=gt[Ut];Br.subarray(De,De+Ee.length).set(Ee),De+=Ee.length}}}let $n=3*8,Ri=t._malloc($n),ie=fo(t,Ri,3);ie[0]=G,ie[1]=lt,ie[2]=Ir,t.HEAPF64[(e>>3)+0]=0,t.HEAPF64[(e>>3)+1]=Ri,t.HEAPF64[(e>>3)+2]=0}catch(c){uo(t,e,c.toString())}}function Ay(){let r=new TextDecoder;return t=>(typeof SharedArrayBuffer<"u"&&t.buffer instanceof SharedArrayBuffer&&(t=new Uint8Array(t)),r.decode(t))}var xy=Ay();function sr(r,t){r.ccall("duckdb_web_fail_with",null,["string"],[t])}function Yn(r,t,e){let n=r.HEAPU8.subarray(t,t+e),i=new Uint8Array(new ArrayBuffer(n.byteLength));return i.set(n),i}function $(r,t,e){return xy(r.HEAPU8.subarray(t,t+e))}function rt(r,t,e,n){let i=r.stackSave(),s=r.stackAlloc(3*8);e.unshift("number"),n.unshift(s),r.ccall(t,null,e,n);let o=r.HEAPF64[(s>>3)+0],a=r.HEAPF64[(s>>3)+1],c=r.HEAPF64[(s>>3)+2];return r.stackRestore(i),[o,a,c]}function mt(r){r.ccall("duckdb_web_clear_response",null,[],[])}var qa=class{constructor(t){let e=new Float64Array(t.buffer,t.byteOffset,t.byteLength/8),n=new Uint8Array(new ArrayBuffer(t.byteLength));n.set(t.subarray(7*8)),this.totalFileReadsCold=e[0],this.totalFileReadsAhead=e[1],this.totalFileReadsCached=e[2],this.totalFileWrites=e[3],this.totalPageAccesses=e[4],this.totalPageLoads=e[5],this.blockSize=e[6],this.blockStats=n}getBlockStats(t,e){return e=e||{file_reads_cold:0,file_reads_ahead:0,file_reads_cached:0,file_writes:0,page_accesses:0,page_loads:0},e.file_writes=this.blockStats[t*3+0]&15,e.file_reads_cold=this.blockStats[t*3+0]>>4,e.file_reads_ahead=this.blockStats[t*3+1]&15,e.file_reads_cached=this.blockStats[t*3+1]>>4,e.page_accesses=this.blockStats[t*3+1]&15,e.page_loads=this.blockStats[t*3+1]>>4,e}};var Ty=new TextEncoder;var Za=class{constructor(t,e){this._instance=null;this._initPromise=null;this._initPromiseResolver=()=>{};this.onInstantiationProgress=[];this._logger=t,this._runtime=e,this._nextUDFId=1}get logger(){return this._logger}get mod(){return this._instance}get pthread(){return this.mod.PThread||null}async instantiate(t=e=>{}){return this._instance!=null?this:(this._initPromise!=null&&(this.onInstantiationProgress.push(t),await this._initPromise),this._initPromise=new Promise(e=>{this._initPromiseResolver=e}),this.onInstantiationProgress=[t],this._instance=await this.instantiateImpl({print:console.log.bind(console),printErr:console.log.bind(console),onRuntimeInitialized:this._initPromiseResolver}),await this._initPromise,this._initPromise=null,this.onInstantiationProgress=this.onInstantiationProgress.filter(e=>e!=t),this)}open(t){let[e,n,i]=rt(this.mod,"duckdb_web_open",["string"],[JSON.stringify(t)]);if(e!==0)throw new Error($(this.mod,n,i));mt(this.mod)}reset(){let[t,e,n]=rt(this.mod,"duckdb_web_reset",[],[]);if(t!==0)throw new Error($(this.mod,e,n));mt(this.mod)}getVersion(){let[t,e,n]=rt(this.mod,"duckdb_web_get_version",[],[]);if(t!==0)throw new Error($(this.mod,e,n));let i=$(this.mod,e,n);return mt(this.mod),i}getFeatureFlags(){return this.mod.ccall("duckdb_web_get_feature_flags","number",[],[])}tokenize(t){let[e,n,i]=rt(this.mod,"duckdb_web_tokenize",["string"],[t]);if(e!==0)throw new Error($(this.mod,n,i));let s=$(this.mod,n,i);return mt(this.mod),JSON.parse(s)}connect(){let t=this.mod.ccall("duckdb_web_connect","number",[],[]);return new Ga(this,t)}disconnect(t){if(this.mod.ccall("duckdb_web_disconnect",null,["number"],[t]),this.pthread)for(let e of[...this.pthread.runningWorkers,...this.pthread.unusedWorkers])e.postMessage({cmd:"dropUDFFunctions",connectionId:t})}runQuery(t,e){let[n,i,s]=rt(this.mod,"duckdb_web_query_run",["number","string"],[t,e]);if(n!==0)throw new Error($(this.mod,i,s));let o=Yn(this.mod,i,s);return mt(this.mod),o}sendQuery(t,e){let[n,i,s]=rt(this.mod,"duckdb_web_query_send",["number","string"],[t,e]);if(n!==0)throw new Error($(this.mod,i,s));let o=Yn(this.mod,i,s);return mt(this.mod),o}fetchQueryResults(t){let[e,n,i]=rt(this.mod,"duckdb_web_query_fetch_results",["number"],[t]);if(e!==0)throw new Error($(this.mod,n,i));let s=Yn(this.mod,n,i);return mt(this.mod),s}getTableNames(t,e){let[n,i,s]=rt(this.mod,"duckdb_web_get_tablenames",["number","string"],[t,e]);if(n!==0)throw new Error($(this.mod,i,s));let o=$(this.mod,i,s);return mt(this.mod),JSON.parse(o)}createScalarFunction(t,e,n,i){let s={functionId:this._nextUDFId,name:e,returnType:Wn(n)},o={functionId:s.functionId,connectionId:t,name:e,returnType:n,func:i};this._nextUDFId+=1;let[a,c,d]=rt(this.mod,"duckdb_web_udf_scalar_create",["number","string"],[t,JSON.stringify(s)]);if(a!==0)throw new Error($(this.mod,c,d));if(mt(this.mod),globalThis.DUCKDB_RUNTIME._udfFunctions=(globalThis.DUCKDB_RUNTIME._udfFunctions||new Map).set(o.functionId,o),this.pthread)for(let p of[...this.pthread.runningWorkers,...this.pthread.unusedWorkers])p.postMessage({cmd:"registerUDFFunction",udf:o})}createPrepared(t,e){let[n,i,s]=rt(this.mod,"duckdb_web_prepared_create",["number","string"],[t,e]);if(n!==0)throw new Error($(this.mod,i,s));return mt(this.mod),i}closePrepared(t,e){let[n,i,s]=rt(this.mod,"duckdb_web_prepared_close",["number","number"],[t,e]);if(n!==0)throw new Error($(this.mod,i,s));mt(this.mod)}runPrepared(t,e,n){let[i,s,o]=rt(this.mod,"duckdb_web_prepared_run",["number","number","string"],[t,e,JSON.stringify(n)]);if(i!==0)throw new Error($(this.mod,s,o));let a=Yn(this.mod,s,o);return mt(this.mod),a}sendPrepared(t,e,n){let[i,s,o]=rt(this.mod,"duckdb_web_prepared_send",["number","number","string"],[t,e,JSON.stringify(n)]);if(i!==0)throw new Error($(this.mod,s,o));let a=Yn(this.mod,s,o);return mt(this.mod),a}insertArrowFromIPCStream(t,e,n){if(e.length==0)return;let i=this.mod._malloc(e.length);this.mod.HEAPU8.subarray(i,i+e.length).set(e);let o=n?JSON.stringify(n):"",[a,c,d]=rt(this.mod,"duckdb_web_insert_arrow_from_ipc_stream",["number","number","number","string"],[t,i,e.length,o]);if(a!==0)throw new Error($(this.mod,c,d))}insertCSVFromPath(t,e,n){if(n.columns!==void 0){n.columnsFlat=[];for(let d in n.columns)n.columnsFlat.push(lo(d,n.columns[d]))}let i=xr({},n);i.columns=i.columnsFlat,delete i.columnsFlat;let s=JSON.stringify(i),[o,a,c]=rt(this.mod,"duckdb_web_insert_csv_from_path",["number","string","string"],[t,e,s]);if(o!==0)throw new Error($(this.mod,a,c))}insertJSONFromPath(t,e,n){if(n.columns!==void 0){n.columnsFlat=[];for(let d in n.columns)n.columnsFlat.push(lo(d,n.columns[d]))}let i=xr({},n);i.columns=i.columnsFlat,delete i.columnsFlat;let s=JSON.stringify(i),[o,a,c]=rt(this.mod,"duckdb_web_insert_json_from_path",["number","string","string"],[t,e,s]);if(o!==0)throw new Error($(this.mod,a,c))}globFiles(t){let[e,n,i]=rt(this.mod,"duckdb_web_fs_glob_file_infos",["string"],[t]);if(e!==0)throw new Error($(this.mod,n,i));let s=$(this.mod,n,i);mt(this.mod);let o=JSON.parse(s);return o==null?[]:o}registerFileURL(t,e){e===void 0&&(e=t);let[n,i,s]=rt(this.mod,"duckdb_web_fs_register_file_url",["string","string","number"],[t,e,-1]);if(n!==0)throw new Error($(this.mod,i,s));mt(this.mod)}registerFileText(t,e){let n=Ty.encode(e);this.registerFileBuffer(t,n)}registerFileBuffer(t,e){let n=this.mod._malloc(e.length);this.mod.HEAPU8.subarray(n,n+e.length).set(e);let[s,o,a]=rt(this.mod,"duckdb_web_fs_register_file_buffer",["string","number","number"],[t,n,e.length]);if(s!==0)throw new Error($(this.mod,o,a));mt(this.mod)}registerFileHandle(t,e){let[n,i,s]=rt(this.mod,"duckdb_web_fs_register_file_url",["string","string","number"],[t,t,-1]);if(n!==0)throw new Error($(this.mod,i,s));if(mt(this.mod),globalThis.DUCKDB_RUNTIME._files=(globalThis.DUCKDB_RUNTIME._files||new Map).set(t,e),this.pthread){for(let o of this.pthread.runningWorkers)o.postMessage({cmd:"registerFileHandle",fileName:t,fileHandle:e});for(let o of this.pthread.unusedWorkers)o.postMessage({cmd:"dropFileHandle",fileName:t})}}dropFile(t){let[e,n,i]=rt(this.mod,"duckdb_web_fs_drop_file",["string"],[t]);if(e!==0)throw new Error($(this.mod,n,i));mt(this.mod)}dropFiles(){let[t,e,n]=rt(this.mod,"duckdb_web_fs_drop_files",[],[]);if(t!==0)throw new Error($(this.mod,e,n));mt(this.mod)}flushFiles(){this.mod.ccall("duckdb_web_flush_files",null,[],[])}copyFileToPath(t,e){let[n,i,s]=rt(this.mod,"duckdb_web_copy_file_to_path",["string","string"],[t,e]);if(n!==0)throw new Error($(this.mod,i,s));mt(this.mod)}copyFileToBuffer(t){let[e,n,i]=rt(this.mod,"duckdb_web_copy_file_to_buffer",["string"],[t]);if(e!==0)throw new Error($(this.mod,n,i));let s=this.mod.HEAPU8.subarray(n,n+i),o=new Uint8Array(s.length);return o.set(s),mt(this.mod),o}collectFileStatistics(t,e){let[n,i,s]=rt(this.mod,"duckdb_web_collect_file_stats",["string","boolean"],[t,e]);if(n!==0)throw new Error($(this.mod,i,s))}exportFileStatistics(t){let[e,n,i]=rt(this.mod,"duckdb_web_export_file_stats",["string"],[t]);if(e!==0)throw new Error($(this.mod,n,i));return new qa(this.mod.HEAPU8.subarray(n,n+i))}};var Qa=class extends Za{constructor(t,e,n,i){super(t,e);this.mainModuleURL=n,this.pthreadWorkerURL=i}locateFile(t,e){if(t.endsWith(".wasm"))return this.mainModuleURL;if(t.endsWith(".worker.js")){if(!this.pthreadWorkerURL)throw new Error("Missing DuckDB worker URL!");return this.pthreadWorkerURL}throw new Error(`WASM instantiation requested unexpected file: prefix=${e} path=${t}`)}instantiateWasm(t,e){globalThis.DUCKDB_RUNTIME=this._runtime;let n=this.onInstantiationProgress;if(typeof TransformStream=="function"&&ReadableStream.prototype.pipeThrough&&WebAssembly.instantiateStreaming){let s=(async()=>{var q;let o=new Request(this.mainModuleURL),a=await fetch(o),c=a.headers.get("content-length"),d=c&&parseInt(c,10)||0,p=new Date,_={startedAt:p,updatedAt:p,bytesTotal:d||0,bytesLoaded:0},g={transform(G,yt){_.bytesLoaded+=G.byteLength;let lt=new Date;if(lt.getTime()-_.updatedAt.getTime()<20){_.updatedAt=lt,yt.enqueue(G);return}for(let Zt of n)Zt(_);yt.enqueue(G)}},w=new TransformStream(g);return new Response((q=a.body)==null?void 0:q.pipeThrough(w),a)})();WebAssembly.instantiateStreaming(s,t).then(o=>{e(o.instance,o.module)})}else{let i=new XMLHttpRequest,s=this.mainModuleURL,o=new Date,a={startedAt:o,updatedAt:o,bytesTotal:0,bytesLoaded:0};i.open("GET",s),i.responseType="arraybuffer",i.onerror=c=>{throw this.logger.log({timestamp:new Date,level:4,origin:3,topic:5,event:2,value:"Failed to load WASM: "+c}),new Error(c.toString())},i.onprogress=c=>{a.bytesTotal=c.total,a.bytesLoaded=c.loaded;let d=new Date;if(d.getTime()-a.updatedAt.getTime()<20){a.updatedAt=d;return}for(let p of n)p(a)},i.onload=()=>{WebAssembly.instantiate(i.response,t).then(c=>{e(c.instance,c.module)}).catch(c=>{throw this.logger.log({timestamp:new Date,level:4,origin:3,topic:5,event:2,value:"Failed to instantiate WASM: "+c}),new Error(c)})},i.send()}return[]}};var tc=class extends Qa{constructor(t,e,n,i=null){super(t,e,n,i)}instantiateImpl(t){return Ju(ei(xr({},t),{instantiateWasm:this.instantiateWasm.bind(this),locateFile:this.locateFile.bind(this)}))}};var qr=Tc(nd()),id=function(r,t,e){var n;if((n=r==null?void 0:r.endpoint)!=null&&n.startsWith("http")){let i=`${r==null?void 0:r.endpoint}`,s=i.indexOf("://")+3;return i.substring(s)}else return r!=null&&r.endpoint?`${e}.${r==null?void 0:r.endpoint}`:`${e}.s3.amazonaws.com`};function Dy(r,t,e){var i,s,o,a;let n=sd(t);return{url:n.path,query:"",host:id(r,t,n.bucket),region:(i=r==null?void 0:r.region)!=null?i:"",service:"s3",method:e,accessKeyId:(s=r==null?void 0:r.accessKeyId)!=null?s:"",secretAccessKey:(o=r==null?void 0:r.secretAccessKey)!=null?o:"",sessionToken:(a=r==null?void 0:r.sessionToken)!=null?a:"",dateNow:new Date().toISOString().replace(/-/g,"").split("T")[0],datetimeNow:new Date().toISOString().replace(/-/g,"").replace(/:/g,"").split(".")[0]+"Z"}}function Ey(r,t=!1){let e="0123456789ABCDEF",n="";for(let i=0;i<r.length;i++){let s=r[i];s>="A"&&s<="Z"||s>="a"&&s<="z"||s>="0"&&s<="9"||s=="_"||s=="-"||s=="~"||s=="."?n+=s:s=="/"?t?n+="%2F":n+=s:(n+="%",n+=e[s.charCodeAt(0)>>4],n+=e[s.charCodeAt(0)&15])}return n}function Oy(r,t=null){var q;let e=(q=t==null?void 0:t.contentHash)!=null?q:"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",n=new Map;n.set("x-amz-date",r.datetimeNow),n.set("x-amz-content-sha256",e),r.sessionToken&&n.set("x-amz-security-token",r.sessionToken);let i="";t!=null&&t.contentType&&(i+="content-type;"),i+="host;x-amz-content-sha256;x-amz-date",r.sessionToken&&(i+=";x-amz-security-token");let s=r.method+`
`+Ey(r.url)+`
`+r.query;t!=null&&t.contentType&&(s+=`
content-type:`+(t==null?void 0:t.contentType)),s+=`
host:`+r.host+`
x-amz-content-sha256:`+e+`
x-amz-date:`+r.datetimeNow,r.sessionToken&&r.sessionToken.length>0&&(s+=`
x-amz-security-token:`+r.sessionToken),s+=`

`+i+`
`+e;let o=(0,qr.sha256)(s),a=`AWS4-HMAC-SHA256
`+r.datetimeNow+`
`+r.dateNow+"/"+r.region+"/"+r.service+`/aws4_request
`+o,c="AWS4"+r.secretAccessKey,d=qr.sha256.hmac.arrayBuffer(c,r.dateNow),p=qr.sha256.hmac.arrayBuffer(d,r.region),_=qr.sha256.hmac.arrayBuffer(p,r.service),g=qr.sha256.hmac.arrayBuffer(_,"aws4_request"),w=qr.sha256.hmac(g,a);return n.set("Authorization","AWS4-HMAC-SHA256 Credential="+r.accessKeyId+"/"+r.dateNow+"/"+r.region+"/"+r.service+"/aws4_request, SignedHeaders="+i+", Signature="+w),n}var My=function(r,t,e,n=null,i=null){let s=Dy(r,t,e),o={contentType:n,contentHash:i?qr.sha256.hex(i):null};return Oy(s,o)};function Zr(r,t,e,n,i=null,s=null){((t==null?void 0:t.accessKeyId)||(t==null?void 0:t.sessionToken))&&(My(t,e,n,i,s).forEach((a,c)=>{r.setRequestHeader(c,a)}),i&&r.setRequestHeader("content-type",i))}function sd(r){if(r.indexOf("s3://")!=0)throw new Error("URL needs to start with s3://");let t=r.indexOf("/",5);if(t==-1)throw new Error("URL needs to contain a '/' after the host");let e=r.substring(5,t);if(!e)throw new Error("URL needs to contain a bucket name");let n=r.substring(t);if(!n)throw new Error("URL needs to contain key");return{bucket:e,path:n}}function Qr(r,t){var n;let e=sd(t);return(n=r==null?void 0:r.endpoint)!=null&&n.startsWith("http")?`${r==null?void 0:r.endpoint}/${e.bucket}`+e.path:"https://"+id(r,t,e.bucket)+e.path}var St={_files:new Map,_fileInfoCache:new Map,_udfFunctions:new Map,_globalFileInfo:null,getFileInfo(r,t){try{let e=St._fileInfoCache.get(t),[n,i,s]=rt(r,"duckdb_web_fs_get_file_info_by_id",["number","number"],[t,(e==null?void 0:e.cacheEpoch)||0]);if(n!==0)return null;if(s===0)return e;let o=$(r,i,s);mt(r);let a=JSON.parse(o);if(a==null)return null;let c=ei(xr({},a),{blob:null});return St._fileInfoCache.set(t,c),c}catch(e){return null}},getGlobalFileInfo(r){var t;try{let[e,n,i]=rt(r,"duckdb_web_get_global_file_info",["number"],[((t=St._globalFileInfo)==null?void 0:t.cacheEpoch)||0]);if(e!==0)return null;if(i===0)return St._globalFileInfo;let s=$(r,n,i);mt(r);let o=JSON.parse(s);return o==null?null:(St._globalFileInfo=ei(xr({},o),{blob:null}),St._globalFileInfo)}catch(e){return null}},testPlatformFeature:(r,t)=>{switch(t){case 1:return typeof BigInt64Array<"u";default:return console.warn(`test for unknown feature: ${t}`),!1}},openFile:(r,t,e)=>{var n;try{St._fileInfoCache.delete(t);let i=St.getFileInfo(r,t);switch(i==null?void 0:i.dataProtocol){case 3:case 4:{if(e&1&&e&2)throw new Error(`Opening file ${i.fileName} failed: cannot open file with both read and write flags set`);if(e&32)throw new Error(`Opening file ${i.fileName} failed: appending to HTTP/S3 files is not supported`);if(e&2){let o=new XMLHttpRequest;if(i.dataProtocol==4?(o.open("HEAD",Qr(i.s3Config,i.dataUrl),!1),Zr(o,i.s3Config,i.dataUrl,"HEAD")):o.open("HEAD",i.dataUrl,!1),o.send(null),o.status!=200&&o.status!=404)throw new Error(`Opening file ${i.fileName} failed: Unexpected return status from server (${o.status})`);if(o.status==404&&!(e&8||e&16))throw new Error(`Opening file ${i.fileName} failed: Cannot write to non-existent file without FILE_FLAGS_FILE_CREATE or FILE_FLAGS_FILE_CREATE_NEW flag.`);let a=r._malloc(1),c=new Uint8Array;r.HEAPU8.set(c,a);let d=r._malloc(2*8);return r.HEAPF64[(d>>3)+0]=1,r.HEAPF64[(d>>3)+1]=a,d}else if(e!=1)throw new Error(`Opening file ${i.fileName} failed: unsupported file flags: ${e}`);let s=null;try{let o=new XMLHttpRequest;i.dataProtocol==4?(o.open("HEAD",Qr(i.s3Config,i.dataUrl),!1),Zr(o,i.s3Config,i.dataUrl,"HEAD")):o.open("HEAD",i.dataUrl,!1),o.setRequestHeader("Range","bytes=0-"),o.send(null);let a=o.getResponseHeader("Content-Length");if(o.status==206&&a!==null){let c=r._malloc(16);return r.HEAPF64[(c>>3)+0]=+a,r.HEAPF64[(c>>3)+1]=0,c}}catch(o){s=o,console.warn(`HEAD request with range header failed: ${o}`)}if(i.allowFullHttpReads){console.warn(`falling back to full HTTP read for: ${i.dataUrl}`);let o=new XMLHttpRequest;if(i.dataProtocol==4?(o.open("GET",Qr(i.s3Config,i.dataUrl),!1),Zr(o,i.s3Config,i.dataUrl,"GET")):o.open("GET",i.dataUrl,!1),o.responseType="arraybuffer",o.send(null),o.status==200){let a=r._malloc(o.response.byteLength),c=new Uint8Array(o.response,0,o.response.byteLength);r.HEAPU8.set(c,a);let d=r._malloc(2*8);return r.HEAPF64[(d>>3)+0]=o.response.byteLength,r.HEAPF64[(d>>3)+1]=a,d}}if(s!=null)throw new Error(`Reading file ${i.fileName} failed with error: ${s}`);return 0}case 1:{let s=(n=St._files)==null?void 0:n.get(i.fileName);if(s){let c=r._malloc(16);return r.HEAPF64[(c>>3)+0]=s.size,r.HEAPF64[(c>>3)+1]=0,c}console.warn(`Buffering missing file: ${i.fileName}`);let o=r._malloc(2*8),a=r._malloc(1);return r.HEAPF64[(o>>3)+0]=1,r.HEAPF64[(o>>3)+1]=a,o}}}catch(i){console.error(i.toString()),sr(r,i.toString())}return 0},glob:(r,t,e)=>{try{let n=$(r,t,e);if(n.startsWith("http")||n.startsWith("s3://")){let i=new XMLHttpRequest;if(n.startsWith("s3://")){let s=St.getGlobalFileInfo(r);i.open("HEAD",Qr(s==null?void 0:s.s3Config,n),!1),Zr(i,s==null?void 0:s.s3Config,n,"HEAD")}else i.open("HEAD",n,!1);if(i.send(null),i.status!=200&&i.status!==206){sr(r,`HEAD request failed: ${n}`);return}r.ccall("duckdb_web_fs_glob_add_path",null,["string"],[n])}}catch(n){return sr(r,n.toString()),0}},checkFile:(r,t,e)=>{try{let n=$(r,t,e);if(n.startsWith("http")||n.startsWith("s3://")){let i=new XMLHttpRequest;if(n.startsWith("s3://")){let o=St.getGlobalFileInfo(r);i.open("HEAD",Qr(o==null?void 0:o.s3Config,n),!1),Zr(i,o==null?void 0:o.s3Config,n,"HEAD")}else i.open("HEAD",n,!1);i.setRequestHeader("Range","bytes=0-"),i.send(null);let s=!1;if(i.status==206)s=!0;else if(i.status==200)s=i.getResponseHeader("Accept-Ranges")==="bytes";else return!1;return!!s}}catch(n){return!1}return!1},syncFile:(r,t)=>{},closeFile:(r,t)=>{let e=St.getFileInfo(r,t);switch(St._fileInfoCache.delete(t),e==null?void 0:e.dataProtocol){case 3:case 4:break;case 1:return}},truncateFile:(r,t,e)=>{let n=St.getFileInfo(r,t);switch(n==null?void 0:n.dataProtocol){case 3:sr(r,"Cannot truncate a http file");return;case 4:sr(r,"Cannot truncate an s3 file");return;case 1:sr(r,"truncateFile not implemented");return}return 0},readFile(r,t,e,n,i){var s;try{let o=St.getFileInfo(r,t);switch(o==null?void 0:o.dataProtocol){case 3:case 4:{if(!o.dataUrl)throw new Error(`Missing data URL for file ${t}`);try{let a=new XMLHttpRequest;if(o.dataProtocol==4?(a.open("GET",Qr(o==null?void 0:o.s3Config,o.dataUrl),!1),Zr(a,o==null?void 0:o.s3Config,o.dataUrl,"GET")):a.open("GET",o.dataUrl,!1),a.responseType="arraybuffer",a.setRequestHeader("Range",`bytes=${i}-${i+n-1}`),a.send(null),a.status==206||a.status==200&&n==a.response.byteLength&&i==0){let c=new Uint8Array(a.response,0,Math.min(a.response.byteLength,n));return r.HEAPU8.set(c,e),c.byteLength}else throw a.status==200?new Error(`Range request for ${o.dataUrl} did not return a partial response: ${a.status} "${a.statusText}"`):new Error(`Range request for ${o.dataUrl} did returned non-success status: ${a.status} "${a.statusText}"`)}catch(a){throw new Error(`Range request for ${o.dataUrl} failed with error: ${a}"`)}}case 1:{let a=(s=St._files)==null?void 0:s.get(o.fileName);if(!a)throw new Error(`No handle available for file: ${o.fileName}`);let c=a.slice(i,i+n),d=new Uint8Array(new FileReaderSync().readAsArrayBuffer(c));return r.HEAPU8.set(d,e),d.byteLength}}return 0}catch(o){return sr(r,o.toString()),0}},writeFile:(r,t,e,n,i)=>{let s=St.getFileInfo(r,t);switch(s==null?void 0:s.dataProtocol){case 3:return sr(r,"Cannot write to HTTP file"),0;case 4:{let o=r.HEAPU8.subarray(e,e+n),a=new XMLHttpRequest;return a.open("PUT",Qr(s==null?void 0:s.s3Config,s.dataUrl),!1),Zr(a,s==null?void 0:s.s3Config,s.dataUrl,"PUT","",o),a.send(o),n}case 1:return sr(r,"writefile not implemented"),0}return 0},getLastFileModificationTime:(r,t)=>{var n;let e=St.getFileInfo(r,t);switch(e==null?void 0:e.dataProtocol){case 1:{if(!((n=St._files)==null?void 0:n.get(e.fileName)))throw Error(`No handle available for file: ${e.fileName}`);return 0}case 3:case 4:return new Date().getTime()}return 0},checkDirectory:(r,t,e)=>{let n=$(r,t,e);return console.log(`checkDirectory: ${n}`),!1},createDirectory:(r,t,e)=>{let n=$(r,t,e);console.log(`createDirectory: ${n}`)},removeDirectory:(r,t,e)=>{let n=$(r,t,e);console.log(`removeDirectory: ${n}`)},listDirectoryEntries:(r,t,e)=>{let n=$(r,t,e);return console.log(`listDirectoryEntries: ${n}`),!1},moveFile:(r,t,e,n,i)=>{},removeFile:(r,t,e)=>{},callScalarUDF:(r,t,e,n,i,s,o)=>{rd(St,r,t,e,n,i,s,o)}};var od=class extends $a{postMessage(t,e){globalThis.postMessage(t,e)}async instantiate(t,e,n){return await new tc(this,St,t,e).instantiate(n)}};function ad(){let r=new od;globalThis.onmessage=async t=>{await r.onMessage(t.data)}}ad();return jh(Ry);})();
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
/**
 * [js-sha256]{@link https://github.com/emn178/js-sha256}
 *
 * @version 0.9.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */
//# sourceMappingURL=duckdb-browser-eh.worker.js.map
